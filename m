Return-Path: <openrisc-bounces@lists.librecores.org>
X-Original-To: lists+openrisc@lfdr.de
Delivered-To: lists+openrisc@lfdr.de
Received: from mail.librecores.org (lists.librecores.org [88.198.125.70])
	by mail.lfdr.de (Postfix) with ESMTP id E8BCC1E504E
	for <lists+openrisc@lfdr.de>; Wed, 27 May 2020 23:19:43 +0200 (CEST)
Received: from [172.31.1.100] (localhost.localdomain [127.0.0.1])
	by mail.librecores.org (Postfix) with ESMTP id 9BFFB20B0D;
	Wed, 27 May 2020 23:19:43 +0200 (CEST)
Received: from mail.kernel.org (mail.kernel.org [198.145.29.99])
 by mail.librecores.org (Postfix) with ESMTPS id 494ED205D4
 for <openrisc@lists.librecores.org>; Sat, 16 May 2020 19:20:40 +0200 (CEST)
Received: from kernel.org (unknown [77.124.237.152])
 (using TLSv1.2 with cipher ECDHE-RSA-AES256-GCM-SHA384 (256/256 bits))
 (No client certificate requested)
 by mail.kernel.org (Postfix) with ESMTPSA id B1B2C2065C;
 Sat, 16 May 2020 17:20:27 +0000 (UTC)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/simple; d=kernel.org;
 s=default; t=1589649636;
 bh=IeA0raojPlenut/DBeELqvxBTfUPBQNLD0csXWioRdc=;
 h=Date:From:To:Cc:Subject:References:In-Reply-To:From;
 b=mz+/82TnbME6MlnCBfzsUOaa/kaMz5TR1zUyfpDbt8BKxlL3IqD0HD1zOKZH2cA9f
 WC3ywud25HOyCHsaBpFeqJQpncrNn5YrWhGvhqxyf4aHKZuOoUwKjXyGxPRtjhW4k+
 inpQi8O88x+nVu6LFQ/DYfDFiCHUwS4EqVIbMplE=
Date: Sat, 16 May 2020 20:20:15 +0300
From: Mike Rapoport <rppt@kernel.org>
To: Andrew Morton <akpm@linux-foundation.org>
Message-ID: <20200516172015.GA1118872@kernel.org>
References: <20200414153455.21744-1-rppt@kernel.org>
 <20200414153455.21744-4-rppt@kernel.org>
 <20200515114012.49f45aa01efb7d8b918bc0f5@linux-foundation.org>
MIME-Version: 1.0
Content-Disposition: inline
In-Reply-To: <20200515114012.49f45aa01efb7d8b918bc0f5@linux-foundation.org>
X-Mailman-Approved-At: Wed, 27 May 2020 23:18:59 +0200
Subject: Re: [OpenRISC] [PATCH v4 03/14] arm64: add support for folded p4d
 page tables
X-BeenThere: openrisc@lists.librecores.org
X-Mailman-Version: 2.1.26
Precedence: list
List-Id: Discussion around the OpenRISC processor
 <openrisc.lists.librecores.org>
List-Unsubscribe: <https://lists.librecores.org/options/openrisc>,
 <mailto:openrisc-request@lists.librecores.org?subject=unsubscribe>
List-Archive: <http://lists.librecores.org/pipermail/openrisc/>
List-Post: <mailto:openrisc@lists.librecores.org>
List-Help: <mailto:openrisc-request@lists.librecores.org?subject=help>
List-Subscribe: <https://lists.librecores.org/listinfo/openrisc>,
 <mailto:openrisc-request@lists.librecores.org?subject=subscribe>
Cc: Rich Felker <dalias@libc.org>, linux-ia64@vger.kernel.org,
 Geert Uytterhoeven <geert+renesas@glider.be>, linux-sh@vger.kernel.org,
 Benjamin Herrenschmidt <benh@kernel.crashing.org>, linux-mm@kvack.org,
 Paul Mackerras <paulus@samba.org>, linux-hexagon@vger.kernel.org,
 Will Deacon <will@kernel.org>, kvmarm@lists.cs.columbia.edu,
 Jonas Bonn <jonas@southpole.se>, linux-arch@vger.kernel.org,
 Brian Cain <bcain@codeaurora.org>, Marc Zyngier <maz@kernel.org>,
 Russell King <linux@armlinux.org.uk>, Ley Foon Tan <ley.foon.tan@intel.com>,
 Mike Rapoport <rppt@linux.ibm.com>, Catalin Marinas <catalin.marinas@arm.com>,
 Julien Thierry <julien.thierry.kdev@gmail.com>,
 uclinux-h8-devel@lists.sourceforge.jp, Fenghua Yu <fenghua.yu@intel.com>,
 Arnd Bergmann <arnd@arndb.de>, Suzuki K Poulose <suzuki.poulose@arm.com>,
 kvm-ppc@vger.kernel.org, openrisc@lists.librecores.org,
 Guan Xuetao <gxt@pku.edu.cn>, linux-arm-kernel@lists.infradead.org,
 Christophe Leroy <christophe.leroy@c-s.fr>, Tony Luck <tony.luck@intel.com>,
 Yoshinori Sato <ysato@users.sourceforge.jp>, linux-kernel@vger.kernel.org,
 James Morse <james.morse@arm.com>, Michael Ellerman <mpe@ellerman.id.au>,
 nios2-dev@lists.rocketboards.org, linuxppc-dev@lists.ozlabs.org
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: openrisc-bounces@lists.librecores.org
Sender: "OpenRISC" <openrisc-bounces@lists.librecores.org>

T24gRnJpLCBNYXkgMTUsIDIwMjAgYXQgMTE6NDA6MTJBTSAtMDcwMCwgQW5kcmV3IE1vcnRvbiB3
cm90ZToKPiBPbiBUdWUsIDE0IEFwciAyMDIwIDE4OjM0OjQ0ICswMzAwIE1pa2UgUmFwb3BvcnQg
PHJwcHRAa2VybmVsLm9yZz4gd3JvdGU6Cj4gCj4gPiBJbXBsZW1lbnQgcHJpbWl0aXZlcyBuZWNl
c3NhcnkgZm9yIHRoZSA0dGggbGV2ZWwgZm9sZGluZywgYWRkIHdhbGtzIG9mIHA0ZAo+ID4gbGV2
ZWwgd2hlcmUgYXBwcm9wcmlhdGUsIHJlcGxhY2UgNWxldmVsLWZpeHVwLmggd2l0aCBwZ3RhYmxl
LW5vcDRkLmggYW5kCj4gPiByZW1vdmUgX19BUkNIX1VTRV81TEVWRUxfSEFDSy4KPiAKPiBUaGlz
IG5lZWRlZCBzb21lIHJld29yayBkdWUgdG8gYXJtIGNoYW5nZXMgaW4gbGludXgtbmV4dC4gIFBs
ZWFzZSBjaGVjawo+IG15IGhhbmRpd29yayBhbmQgdGVzdCBpdCBvbmNlIEkndmUgbWVyZ2VkIHRo
aXMgaW50byBsaW51eC1uZXh0PwoKTG9va3Mgb2sgdG8gbWUuIEl0IHBhc3NlZCBkZWZjb25maWcg
YW5kIGEgY291cGxlIG9mIHJhbmRjb25maWcgYnVpbGRzCmFuZCBxZW11LXN5c3RlbS1hYXJjaDY0
IGJvb3RzIGZpbmQgd2l0aCB0aGlzLgoKPiBSZWplY3RzIHdlcmUKPiAKPiAtLS0gYXJjaC9hcm02
NC9pbmNsdWRlL2FzbS9wZ3RhYmxlLmh+YXJtNjQtYWRkLXN1cHBvcnQtZm9yLWZvbGRlZC1wNGQt
cGFnZS10YWJsZXMKPiArKysgYXJjaC9hcm02NC9pbmNsdWRlL2FzbS9wZ3RhYmxlLmgKPiBAQCAt
NTk2LDQ5ICs2MDQsNTAgQEAgc3RhdGljIGlubGluZSBwaHlzX2FkZHJfdCBwdWRfcGFnZV9wYWRk
cgo+ICAKPiAgI2RlZmluZSBwdWRfRVJST1IocHVkKQkJX19wdWRfZXJyb3IoX19GSUxFX18sIF9f
TElORV9fLCBwdWRfdmFsKHB1ZCkpCj4gIAo+IC0jZGVmaW5lIHBnZF9ub25lKHBnZCkJCSghcGdk
X3ZhbChwZ2QpKQo+IC0jZGVmaW5lIHBnZF9iYWQocGdkKQkJKCEocGdkX3ZhbChwZ2QpICYgMikp
Cj4gLSNkZWZpbmUgcGdkX3ByZXNlbnQocGdkKQkocGdkX3ZhbChwZ2QpKQo+ICsjZGVmaW5lIHA0
ZF9ub25lKHA0ZCkJCSghcDRkX3ZhbChwNGQpKQo+ICsjZGVmaW5lIHA0ZF9iYWQocDRkKQkJKCEo
cDRkX3ZhbChwNGQpICYgMikpCj4gKyNkZWZpbmUgcDRkX3ByZXNlbnQocDRkKQkocDRkX3ZhbChw
NGQpKQo+ICAKPiAtc3RhdGljIGlubGluZSB2b2lkIHNldF9wZ2QocGdkX3QgKnBnZHAsIHBnZF90
IHBnZCkKPiArc3RhdGljIGlubGluZSB2b2lkIHNldF9wNGQocDRkX3QgKnA0ZHAsIHA0ZF90IHA0
ZCkKPiAgewo+IC0JaWYgKGluX3N3YXBwZXJfcGdkaXIocGdkcCkpIHsKPiAtCQlzZXRfc3dhcHBl
cl9wZ2QocGdkcCwgcGdkKTsKPiArCWlmIChpbl9zd2FwcGVyX3BnZGlyKHA0ZHApKSB7Cj4gKwkJ
c2V0X3N3YXBwZXJfcGdkKChwZ2RfdCAqKXA0ZHAsIF9fcGdkKHA0ZF92YWwocDRkKSkpOwo+ICAJ
CXJldHVybjsKPiAgCX0KPiAgCj4gLQlXUklURV9PTkNFKCpwZ2RwLCBwZ2QpOwo+ICsJV1JJVEVf
T05DRSgqcDRkcCwgcDRkKTsKPiAgCWRzYihpc2hzdCk7Cj4gIAlpc2IoKTsKPiAgfQo+ICAKPiAt
c3RhdGljIGlubGluZSB2b2lkIHBnZF9jbGVhcihwZ2RfdCAqcGdkcCkKPiArc3RhdGljIGlubGlu
ZSB2b2lkIHA0ZF9jbGVhcihwNGRfdCAqcDRkcCkKPiAgewo+IC0Jc2V0X3BnZChwZ2RwLCBfX3Bn
ZCgwKSk7Cj4gKwlzZXRfcDRkKHA0ZHAsIF9fcDRkKDApKTsKPiAgfQo+ICAKPiAtc3RhdGljIGlu
bGluZSBwaHlzX2FkZHJfdCBwZ2RfcGFnZV9wYWRkcihwZ2RfdCBwZ2QpCj4gK3N0YXRpYyBpbmxp
bmUgcGh5c19hZGRyX3QgcDRkX3BhZ2VfcGFkZHIocDRkX3QgcDRkKQo+ICB7Cj4gLQlyZXR1cm4g
X19wZ2RfdG9fcGh5cyhwZ2QpOwo+ICsJcmV0dXJuIF9fcDRkX3RvX3BoeXMocDRkKTsKPiAgfQo+
ICAKPiAgLyogRmluZCBhbiBlbnRyeSBpbiB0aGUgZnJzdC1sZXZlbCBwYWdlIHRhYmxlLiAqLwo+
ICAjZGVmaW5lIHB1ZF9pbmRleChhZGRyKQkJKCgoYWRkcikgPj4gUFVEX1NISUZUKSAmIChQVFJT
X1BFUl9QVUQgLSAxKSkKPiAgCj4gLSNkZWZpbmUgcHVkX29mZnNldF9waHlzKGRpciwgYWRkcikJ
KHBnZF9wYWdlX3BhZGRyKFJFQURfT05DRSgqKGRpcikpKSArIHB1ZF9pbmRleChhZGRyKSAqIHNp
emVvZihwdWRfdCkpCj4gKyNkZWZpbmUgcHVkX29mZnNldF9waHlzKGRpciwgYWRkcikJKHA0ZF9w
YWdlX3BhZGRyKFJFQURfT05DRSgqKGRpcikpKSArIHB1ZF9pbmRleChhZGRyKSAqIHNpemVvZihw
dWRfdCkpCj4gICNkZWZpbmUgcHVkX29mZnNldChkaXIsIGFkZHIpCQkoKHB1ZF90ICopX192YShw
dWRfb2Zmc2V0X3BoeXMoKGRpciksIChhZGRyKSkpKQo+ICAKPiAgI2RlZmluZSBwdWRfc2V0X2Zp
eG1hcChhZGRyKQkJKChwdWRfdCAqKXNldF9maXhtYXBfb2Zmc2V0KEZJWF9QVUQsIGFkZHIpKQo+
IC0jZGVmaW5lIHB1ZF9zZXRfZml4bWFwX29mZnNldChwZ2QsIGFkZHIpCXB1ZF9zZXRfZml4bWFw
KHB1ZF9vZmZzZXRfcGh5cyhwZ2QsIGFkZHIpKQo+ICsjZGVmaW5lIHB1ZF9zZXRfZml4bWFwX29m
ZnNldChwNGQsIGFkZHIpCXB1ZF9zZXRfZml4bWFwKHB1ZF9vZmZzZXRfcGh5cyhwNGQsIGFkZHIp
KQo+ICAjZGVmaW5lIHB1ZF9jbGVhcl9maXhtYXAoKQkJY2xlYXJfZml4bWFwKEZJWF9QVUQpCj4g
IAo+IC0jZGVmaW5lIHBnZF9wYWdlKHBnZCkJCXBmbl90b19wYWdlKF9fcGh5c190b19wZm4oX19w
Z2RfdG9fcGh5cyhwZ2QpKSkKPiArI2RlZmluZSBwNGRfcGFnZShwNGQpCQlwZm5fdG9fcGFnZShf
X3BoeXNfdG9fcGZuKF9fcDRkX3RvX3BoeXMocDRkKSkpCj4gIAo+ICAvKiB1c2UgT05MWSBmb3Ig
c3RhdGljYWxseSBhbGxvY2F0ZWQgdHJhbnNsYXRpb24gdGFibGVzICovCj4gICNkZWZpbmUgcHVk
X29mZnNldF9raW1nKGRpcixhZGRyKQkoKHB1ZF90ICopX19waHlzX3RvX2tpbWcocHVkX29mZnNl
dF9waHlzKChkaXIpLCAoYWRkcikpKSkKPiAgCj4gICNlbHNlCj4gIAo+ICsjZGVmaW5lIHA0ZF9w
YWdlX3BhZGRyKHA0ZCkJKHsgQlVJTERfQlVHKCk7IDA7fSkKPiAgI2RlZmluZSBwZ2RfcGFnZV9w
YWRkcihwZ2QpCSh7IEJVSUxEX0JVRygpOyAwO30pCj4gIAo+ICAvKiBNYXRjaCBwdWRfb2Zmc2V0
IGZvbGRpbmcgaW4gPGFzbS9nZW5lcmljL3BndGFibGUtbm9wdWQuaD4gKi8KPiAKPiAKPiAKPiBh
bmQKPiAKPiAtLS0gYXJjaC9hcm02NC9rdm0vbW11LmN+YXJtNjQtYWRkLXN1cHBvcnQtZm9yLWZv
bGRlZC1wNGQtcGFnZS10YWJsZXMKPiArKysgYXJjaC9hcm02NC9rdm0vbW11LmMKPiBAQCAtNDY5
LDcgKzUxNyw3IEBAIHN0YXRpYyB2b2lkIHN0YWdlMl9mbHVzaF9tZW1zbG90KHN0cnVjdAo+ICAJ
ZG8gewo+ICAJCW5leHQgPSBzdGFnZTJfcGdkX2FkZHJfZW5kKGt2bSwgYWRkciwgZW5kKTsKPiAg
CQlpZiAoIXN0YWdlMl9wZ2Rfbm9uZShrdm0sICpwZ2QpKQo+IC0JCQlzdGFnZTJfZmx1c2hfcHVk
cyhrdm0sIHBnZCwgYWRkciwgbmV4dCk7Cj4gKwkJCXN0YWdlMl9mbHVzaF9wNGRzKGt2bSwgcGdk
LCBhZGRyLCBuZXh0KTsKPiAgCX0gd2hpbGUgKHBnZCsrLCBhZGRyID0gbmV4dCwgYWRkciAhPSBl
bmQpOwo+ICB9Cj4gIAo+IAo+IAo+IFJlc3VsdDoKPiAKPiBGcm9tOiBNaWtlIFJhcG9wb3J0IDxy
cHB0QGxpbnV4LmlibS5jb20+Cj4gU3ViamVjdDogYXJtNjQ6IGFkZCBzdXBwb3J0IGZvciBmb2xk
ZWQgcDRkIHBhZ2UgdGFibGVzCj4gCj4gSW1wbGVtZW50IHByaW1pdGl2ZXMgbmVjZXNzYXJ5IGZv
ciB0aGUgNHRoIGxldmVsIGZvbGRpbmcsIGFkZCB3YWxrcyBvZiBwNGQKPiBsZXZlbCB3aGVyZSBh
cHByb3ByaWF0ZSwgcmVwbGFjZSA1bGV2ZWwtZml4dXAuaCB3aXRoIHBndGFibGUtbm9wNGQuaCBh
bmQKPiByZW1vdmUgX19BUkNIX1VTRV81TEVWRUxfSEFDSy4KPiAKPiBMaW5rOiBodHRwOi8vbGtt
bC5rZXJuZWwub3JnL3IvMjAyMDA0MTQxNTM0NTUuMjE3NDQtNC1ycHB0QGtlcm5lbC5vcmcKPiBT
aWduZWQtb2ZmLWJ5OiBNaWtlIFJhcG9wb3J0IDxycHB0QGxpbnV4LmlibS5jb20+Cj4gQ2M6IEFy
bmQgQmVyZ21hbm4gPGFybmRAYXJuZGIuZGU+Cj4gQ2M6IEJlbmphbWluIEhlcnJlbnNjaG1pZHQg
PGJlbmhAa2VybmVsLmNyYXNoaW5nLm9yZz4KPiBDYzogQnJpYW4gQ2FpbiA8YmNhaW5AY29kZWF1
cm9yYS5vcmc+Cj4gQ2M6IENhdGFsaW4gTWFyaW5hcyA8Y2F0YWxpbi5tYXJpbmFzQGFybS5jb20+
Cj4gQ2M6IENocmlzdG9waGUgTGVyb3kgPGNocmlzdG9waGUubGVyb3lAYy1zLmZyPgo+IENjOiBG
ZW5naHVhIFl1IDxmZW5naHVhLnl1QGludGVsLmNvbT4KPiBDYzogR2VlcnQgVXl0dGVyaG9ldmVu
IDxnZWVydCtyZW5lc2FzQGdsaWRlci5iZT4KPiBDYzogR3VhbiBYdWV0YW8gPGd4dEBwa3UuZWR1
LmNuPgo+IENjOiBKYW1lcyBNb3JzZSA8amFtZXMubW9yc2VAYXJtLmNvbT4KPiBDYzogSm9uYXMg
Qm9ubiA8am9uYXNAc291dGhwb2xlLnNlPgo+IENjOiBKdWxpZW4gVGhpZXJyeSA8anVsaWVuLnRo
aWVycnkua2RldkBnbWFpbC5jb20+Cj4gQ2M6IExleSBGb29uIFRhbiA8bGV5LmZvb24udGFuQGlu
dGVsLmNvbT4KPiBDYzogTWFyYyBaeW5naWVyIDxtYXpAa2VybmVsLm9yZz4KPiBDYzogTWljaGFl
bCBFbGxlcm1hbiA8bXBlQGVsbGVybWFuLmlkLmF1Pgo+IENjOiBQYXVsIE1hY2tlcnJhcyA8cGF1
bHVzQHNhbWJhLm9yZz4KPiBDYzogUmljaCBGZWxrZXIgPGRhbGlhc0BsaWJjLm9yZz4KPiBDYzog
UnVzc2VsbCBLaW5nIDxsaW51eEBhcm1saW51eC5vcmcudWs+Cj4gQ2M6IFN0YWZmb3JkIEhvcm5l
IDxzaG9ybmVAZ21haWwuY29tPgo+IENjOiBTdGVmYW4gS3Jpc3RpYW5zc29uIDxzdGVmYW4ua3Jp
c3RpYW5zc29uQHNhdW5hbGFodGkuZmk+Cj4gQ2M6IFN1enVraSBLIFBvdWxvc2UgPHN1enVraS5w
b3Vsb3NlQGFybS5jb20+Cj4gQ2M6IFRvbnkgTHVjayA8dG9ueS5sdWNrQGludGVsLmNvbT4KPiBD
YzogV2lsbCBEZWFjb24gPHdpbGxAa2VybmVsLm9yZz4KPiBDYzogWW9zaGlub3JpIFNhdG8gPHlz
YXRvQHVzZXJzLnNvdXJjZWZvcmdlLmpwPgo+IFNpZ25lZC1vZmYtYnk6IEFuZHJldyBNb3J0b24g
PGFrcG1AbGludXgtZm91bmRhdGlvbi5vcmc+Cj4gLS0tCj4gCj4gIGFyY2gvYXJtNjQvaW5jbHVk
ZS9hc20va3ZtX21tdS5oICAgICAgICB8ICAgMTAgLQo+ICBhcmNoL2FybTY0L2luY2x1ZGUvYXNt
L3BnYWxsb2MuaCAgICAgICAgfCAgIDEwIC0KPiAgYXJjaC9hcm02NC9pbmNsdWRlL2FzbS9wZ3Rh
YmxlLXR5cGVzLmggIHwgICAgNSAKPiAgYXJjaC9hcm02NC9pbmNsdWRlL2FzbS9wZ3RhYmxlLmgg
ICAgICAgIHwgICAzNyArKy0KPiAgYXJjaC9hcm02NC9pbmNsdWRlL2FzbS9zdGFnZTJfcGd0YWJs
ZS5oIHwgICA0OCArKystLQo+ICBhcmNoL2FybTY0L2tlcm5lbC9oaWJlcm5hdGUuYyAgICAgICAg
ICAgfCAgIDQ0ICsrKy0KPiAgYXJjaC9hcm02NC9rdm0vbW11LmMgICAgICAgICAgICAgICAgICAg
IHwgIDIwOSArKysrKysrKysrKysrKysrKystLS0tCj4gIGFyY2gvYXJtNjQvbW0vZmF1bHQuYyAg
ICAgICAgICAgICAgICAgICB8ICAgIDkgCj4gIGFyY2gvYXJtNjQvbW0vaHVnZXRsYnBhZ2UuYyAg
ICAgICAgICAgICB8ICAgMTUgKwo+ICBhcmNoL2FybTY0L21tL2thc2FuX2luaXQuYyAgICAgICAg
ICAgICAgfCAgIDI2ICsrCj4gIGFyY2gvYXJtNjQvbW0vbW11LmMgICAgICAgICAgICAgICAgICAg
ICB8ICAgNTIgKysrLS0KPiAgYXJjaC9hcm02NC9tbS9wYWdlYXR0ci5jICAgICAgICAgICAgICAg
IHwgICAgNyAKPiAgMTIgZmlsZXMgY2hhbmdlZCwgMzY4IGluc2VydGlvbnMoKyksIDEwNCBkZWxl
dGlvbnMoLSkKPiAKPiAtLS0gYS9hcmNoL2FybTY0L2luY2x1ZGUvYXNtL2t2bV9tbXUuaH5hcm02
NC1hZGQtc3VwcG9ydC1mb3ItZm9sZGVkLXA0ZC1wYWdlLXRhYmxlcwo+ICsrKyBhL2FyY2gvYXJt
NjQvaW5jbHVkZS9hc20va3ZtX21tdS5oCj4gQEAgLTE3Miw4ICsxNzIsOCBAQCB2b2lkIGt2bV9j
bGVhcl9oeXBfaWRtYXAodm9pZCk7Cj4gIAlfX3BtZChfX3BoeXNfdG9fcG1kX3ZhbChfX3BhKHB0
ZXApKSB8IFBNRF9UWVBFX1RBQkxFKQo+ICAjZGVmaW5lIGt2bV9ta19wdWQocG1kcCkJCQkJCVwK
PiAgCV9fcHVkKF9fcGh5c190b19wdWRfdmFsKF9fcGEocG1kcCkpIHwgUE1EX1RZUEVfVEFCTEUp
Cj4gLSNkZWZpbmUga3ZtX21rX3BnZChwdWRwKQkJCQkJXAo+IC0JX19wZ2QoX19waHlzX3RvX3Bn
ZF92YWwoX19wYShwdWRwKSkgfCBQVURfVFlQRV9UQUJMRSkKPiArI2RlZmluZSBrdm1fbWtfcDRk
KHBtZHApCQkJCQlcCj4gKwlfX3A0ZChfX3BoeXNfdG9fcDRkX3ZhbChfX3BhKHBtZHApKSB8IFBV
RF9UWVBFX1RBQkxFKQo+ICAKPiAgI2RlZmluZSBrdm1fc2V0X3B1ZChwdWRwLCBwdWQpCQlzZXRf
cHVkKHB1ZHAsIHB1ZCkKPiAgCj4gQEAgLTI5OSw2ICsyOTksMTIgQEAgc3RhdGljIGlubGluZSBi
b29sIGt2bV9zMnB1ZF95b3VuZyhwdWRfdAo+ICAjZGVmaW5lIGh5cF9wdWRfdGFibGVfZW1wdHko
cHVkcCkga3ZtX3BhZ2VfZW1wdHkocHVkcCkKPiAgI2VuZGlmCj4gIAo+ICsjaWZkZWYgX19QQUdF
VEFCTEVfUDREX0ZPTERFRAo+ICsjZGVmaW5lIGh5cF9wNGRfdGFibGVfZW1wdHkocDRkcCkgKDAp
Cj4gKyNlbHNlCj4gKyNkZWZpbmUgaHlwX3A0ZF90YWJsZV9lbXB0eShwNGRwKSBrdm1fcGFnZV9l
bXB0eShwNGRwKQo+ICsjZW5kaWYKPiArCj4gIHN0cnVjdCBrdm07Cj4gIAo+ICAjZGVmaW5lIGt2
bV9mbHVzaF9kY2FjaGVfdG9fcG9jKGEsbCkJX19mbHVzaF9kY2FjaGVfYXJlYSgoYSksIChsKSkK
PiAtLS0gYS9hcmNoL2FybTY0L2luY2x1ZGUvYXNtL3BnYWxsb2MuaH5hcm02NC1hZGQtc3VwcG9y
dC1mb3ItZm9sZGVkLXA0ZC1wYWdlLXRhYmxlcwo+ICsrKyBhL2FyY2gvYXJtNjQvaW5jbHVkZS9h
c20vcGdhbGxvYy5oCj4gQEAgLTczLDE3ICs3MywxNyBAQCBzdGF0aWMgaW5saW5lIHZvaWQgcHVk
X2ZyZWUoc3RydWN0IG1tX3N0Cj4gIAlmcmVlX3BhZ2UoKHVuc2lnbmVkIGxvbmcpcHVkcCk7Cj4g
IH0KPiAgCj4gLXN0YXRpYyBpbmxpbmUgdm9pZCBfX3BnZF9wb3B1bGF0ZShwZ2RfdCAqcGdkcCwg
cGh5c19hZGRyX3QgcHVkcCwgcGdkdmFsX3QgcHJvdCkKPiArc3RhdGljIGlubGluZSB2b2lkIF9f
cDRkX3BvcHVsYXRlKHA0ZF90ICpwNGRwLCBwaHlzX2FkZHJfdCBwdWRwLCBwNGR2YWxfdCBwcm90
KQo+ICB7Cj4gLQlzZXRfcGdkKHBnZHAsIF9fcGdkKF9fcGh5c190b19wZ2RfdmFsKHB1ZHApIHwg
cHJvdCkpOwo+ICsJc2V0X3A0ZChwNGRwLCBfX3A0ZChfX3BoeXNfdG9fcDRkX3ZhbChwdWRwKSB8
IHByb3QpKTsKPiAgfQo+ICAKPiAtc3RhdGljIGlubGluZSB2b2lkIHBnZF9wb3B1bGF0ZShzdHJ1
Y3QgbW1fc3RydWN0ICptbSwgcGdkX3QgKnBnZHAsIHB1ZF90ICpwdWRwKQo+ICtzdGF0aWMgaW5s
aW5lIHZvaWQgcDRkX3BvcHVsYXRlKHN0cnVjdCBtbV9zdHJ1Y3QgKm1tLCBwNGRfdCAqcDRkcCwg
cHVkX3QgKnB1ZHApCj4gIHsKPiAtCV9fcGdkX3BvcHVsYXRlKHBnZHAsIF9fcGEocHVkcCksIFBV
RF9UWVBFX1RBQkxFKTsKPiArCV9fcDRkX3BvcHVsYXRlKHA0ZHAsIF9fcGEocHVkcCksIFBVRF9U
WVBFX1RBQkxFKTsKPiAgfQo+ICAjZWxzZQo+IC1zdGF0aWMgaW5saW5lIHZvaWQgX19wZ2RfcG9w
dWxhdGUocGdkX3QgKnBnZHAsIHBoeXNfYWRkcl90IHB1ZHAsIHBnZHZhbF90IHByb3QpCj4gK3N0
YXRpYyBpbmxpbmUgdm9pZCBfX3A0ZF9wb3B1bGF0ZShwNGRfdCAqcDRkcCwgcGh5c19hZGRyX3Qg
cHVkcCwgcDRkdmFsX3QgcHJvdCkKPiAgewo+ICAJQlVJTERfQlVHKCk7Cj4gIH0KPiAtLS0gYS9h
cmNoL2FybTY0L2luY2x1ZGUvYXNtL3BndGFibGUuaH5hcm02NC1hZGQtc3VwcG9ydC1mb3ItZm9s
ZGVkLXA0ZC1wYWdlLXRhYmxlcwo+ICsrKyBhL2FyY2gvYXJtNjQvaW5jbHVkZS9hc20vcGd0YWJs
ZS5oCj4gQEAgLTI5OCw2ICsyOTgsMTEgQEAgc3RhdGljIGlubGluZSBwdGVfdCBwZ2RfcHRlKHBn
ZF90IHBnZCkKPiAgCXJldHVybiBfX3B0ZShwZ2RfdmFsKHBnZCkpOwo+ICB9Cj4gIAo+ICtzdGF0
aWMgaW5saW5lIHB0ZV90IHA0ZF9wdGUocDRkX3QgcDRkKQo+ICt7Cj4gKwlyZXR1cm4gX19wdGUo
cDRkX3ZhbChwNGQpKTsKPiArfQo+ICsKPiAgc3RhdGljIGlubGluZSBwdGVfdCBwdWRfcHRlKHB1
ZF90IHB1ZCkKPiAgewo+ICAJcmV0dXJuIF9fcHRlKHB1ZF92YWwocHVkKSk7Cj4gQEAgLTQwMSw2
ICs0MDYsOSBAQCBzdGF0aWMgaW5saW5lIHBtZF90IHBtZF9ta2Rldm1hcChwbWRfdCBwCj4gIAo+
ICAjZGVmaW5lIHNldF9wbWRfYXQobW0sIGFkZHIsIHBtZHAsIHBtZCkJc2V0X3B0ZV9hdChtbSwg
YWRkciwgKHB0ZV90ICopcG1kcCwgcG1kX3B0ZShwbWQpKQo+ICAKPiArI2RlZmluZSBfX3A0ZF90
b19waHlzKHA0ZCkJX19wdGVfdG9fcGh5cyhwNGRfcHRlKHA0ZCkpCj4gKyNkZWZpbmUgX19waHlz
X3RvX3A0ZF92YWwocGh5cykJX19waHlzX3RvX3B0ZV92YWwocGh5cykKPiArCj4gICNkZWZpbmUg
X19wZ2RfdG9fcGh5cyhwZ2QpCV9fcHRlX3RvX3BoeXMocGdkX3B0ZShwZ2QpKQo+ICAjZGVmaW5l
IF9fcGh5c190b19wZ2RfdmFsKHBoeXMpCV9fcGh5c190b19wdGVfdmFsKHBoeXMpCj4gIAo+IEBA
IC01OTIsNDkgKzYwMCw1MCBAQCBzdGF0aWMgaW5saW5lIHBoeXNfYWRkcl90IHB1ZF9wYWdlX3Bh
ZGRyCj4gIAo+ICAjZGVmaW5lIHB1ZF9FUlJPUihwdWQpCQlfX3B1ZF9lcnJvcihfX0ZJTEVfXywg
X19MSU5FX18sIHB1ZF92YWwocHVkKSkKPiAgCj4gLSNkZWZpbmUgcGdkX25vbmUocGdkKQkJKCFw
Z2RfdmFsKHBnZCkpCj4gLSNkZWZpbmUgcGdkX2JhZChwZ2QpCQkoIShwZ2RfdmFsKHBnZCkgJiAy
KSkKPiAtI2RlZmluZSBwZ2RfcHJlc2VudChwZ2QpCShwZ2RfdmFsKHBnZCkpCj4gKyNkZWZpbmUg
cDRkX25vbmUocDRkKQkJKCFwNGRfdmFsKHA0ZCkpCj4gKyNkZWZpbmUgcDRkX2JhZChwNGQpCQko
IShwNGRfdmFsKHA0ZCkgJiAyKSkKPiArI2RlZmluZSBwNGRfcHJlc2VudChwNGQpCShwNGRfdmFs
KHA0ZCkpCj4gIAo+IC1zdGF0aWMgaW5saW5lIHZvaWQgc2V0X3BnZChwZ2RfdCAqcGdkcCwgcGdk
X3QgcGdkKQo+ICtzdGF0aWMgaW5saW5lIHZvaWQgc2V0X3A0ZChwNGRfdCAqcDRkcCwgcDRkX3Qg
cDRkKQo+ICB7Cj4gLQlpZiAoaW5fc3dhcHBlcl9wZ2RpcihwZ2RwKSkgewo+IC0JCXNldF9zd2Fw
cGVyX3BnZChwZ2RwLCBwZ2QpOwo+ICsJaWYgKGluX3N3YXBwZXJfcGdkaXIocDRkcCkpIHsKPiAr
CQlzZXRfc3dhcHBlcl9wZ2QoKHBnZF90ICopcDRkcCwgX19wZ2QocDRkX3ZhbChwNGQpKSk7Cj4g
IAkJcmV0dXJuOwo+ICAJfQo+ICAKPiAtCVdSSVRFX09OQ0UoKnBnZHAsIHBnZCk7Cj4gKwlXUklU
RV9PTkNFKCpwNGRwLCBwNGQpOwo+ICAJZHNiKGlzaHN0KTsKPiAgCWlzYigpOwo+ICB9Cj4gIAo+
IC1zdGF0aWMgaW5saW5lIHZvaWQgcGdkX2NsZWFyKHBnZF90ICpwZ2RwKQo+ICtzdGF0aWMgaW5s
aW5lIHZvaWQgcDRkX2NsZWFyKHA0ZF90ICpwNGRwKQo+ICB7Cj4gLQlzZXRfcGdkKHBnZHAsIF9f
cGdkKDApKTsKPiArCXNldF9wNGQocDRkcCwgX19wNGQoMCkpOwo+ICB9Cj4gIAo+IC1zdGF0aWMg
aW5saW5lIHBoeXNfYWRkcl90IHBnZF9wYWdlX3BhZGRyKHBnZF90IHBnZCkKPiArc3RhdGljIGlu
bGluZSBwaHlzX2FkZHJfdCBwNGRfcGFnZV9wYWRkcihwNGRfdCBwNGQpCj4gIHsKPiAtCXJldHVy
biBfX3BnZF90b19waHlzKHBnZCk7Cj4gKwlyZXR1cm4gX19wNGRfdG9fcGh5cyhwNGQpOwo+ICB9
Cj4gIAo+ICAvKiBGaW5kIGFuIGVudHJ5IGluIHRoZSBmcnN0LWxldmVsIHBhZ2UgdGFibGUuICov
Cj4gICNkZWZpbmUgcHVkX2luZGV4KGFkZHIpCQkoKChhZGRyKSA+PiBQVURfU0hJRlQpICYgKFBU
UlNfUEVSX1BVRCAtIDEpKQo+ICAKPiAtI2RlZmluZSBwdWRfb2Zmc2V0X3BoeXMoZGlyLCBhZGRy
KQkocGdkX3BhZ2VfcGFkZHIoUkVBRF9PTkNFKCooZGlyKSkpICsgcHVkX2luZGV4KGFkZHIpICog
c2l6ZW9mKHB1ZF90KSkKPiArI2RlZmluZSBwdWRfb2Zmc2V0X3BoeXMoZGlyLCBhZGRyKQkocDRk
X3BhZ2VfcGFkZHIoUkVBRF9PTkNFKCooZGlyKSkpICsgcHVkX2luZGV4KGFkZHIpICogc2l6ZW9m
KHB1ZF90KSkKPiAgI2RlZmluZSBwdWRfb2Zmc2V0KGRpciwgYWRkcikJCSgocHVkX3QgKilfX3Zh
KHB1ZF9vZmZzZXRfcGh5cygoZGlyKSwgKGFkZHIpKSkpCj4gIAo+ICAjZGVmaW5lIHB1ZF9zZXRf
Zml4bWFwKGFkZHIpCQkoKHB1ZF90ICopc2V0X2ZpeG1hcF9vZmZzZXQoRklYX1BVRCwgYWRkcikp
Cj4gLSNkZWZpbmUgcHVkX3NldF9maXhtYXBfb2Zmc2V0KHBnZCwgYWRkcikJcHVkX3NldF9maXht
YXAocHVkX29mZnNldF9waHlzKHBnZCwgYWRkcikpCj4gKyNkZWZpbmUgcHVkX3NldF9maXhtYXBf
b2Zmc2V0KHA0ZCwgYWRkcikJcHVkX3NldF9maXhtYXAocHVkX29mZnNldF9waHlzKHA0ZCwgYWRk
cikpCj4gICNkZWZpbmUgcHVkX2NsZWFyX2ZpeG1hcCgpCQljbGVhcl9maXhtYXAoRklYX1BVRCkK
PiAgCj4gLSNkZWZpbmUgcGdkX3BhZ2UocGdkKQkJCXBoeXNfdG9fcGFnZShfX3BnZF90b19waHlz
KHBnZCkpCj4gKyNkZWZpbmUgcDRkX3BhZ2UocDRkKQkJcGZuX3RvX3BhZ2UoX19waHlzX3RvX3Bm
bihfX3A0ZF90b19waHlzKHA0ZCkpKQo+ICAKPiAgLyogdXNlIE9OTFkgZm9yIHN0YXRpY2FsbHkg
YWxsb2NhdGVkIHRyYW5zbGF0aW9uIHRhYmxlcyAqLwo+ICAjZGVmaW5lIHB1ZF9vZmZzZXRfa2lt
ZyhkaXIsYWRkcikJKChwdWRfdCAqKV9fcGh5c190b19raW1nKHB1ZF9vZmZzZXRfcGh5cygoZGly
KSwgKGFkZHIpKSkpCj4gIAo+ICAjZWxzZQo+ICAKPiArI2RlZmluZSBwNGRfcGFnZV9wYWRkcihw
NGQpCSh7IEJVSUxEX0JVRygpOyAwO30pCj4gICNkZWZpbmUgcGdkX3BhZ2VfcGFkZHIocGdkKQko
eyBCVUlMRF9CVUcoKTsgMDt9KQo+ICAKPiAgLyogTWF0Y2ggcHVkX29mZnNldCBmb2xkaW5nIGlu
IDxhc20vZ2VuZXJpYy9wZ3RhYmxlLW5vcHVkLmg+ICovCj4gLS0tIGEvYXJjaC9hcm02NC9pbmNs
dWRlL2FzbS9wZ3RhYmxlLXR5cGVzLmh+YXJtNjQtYWRkLXN1cHBvcnQtZm9yLWZvbGRlZC1wNGQt
cGFnZS10YWJsZXMKPiArKysgYS9hcmNoL2FybTY0L2luY2x1ZGUvYXNtL3BndGFibGUtdHlwZXMu
aAo+IEBAIC0xNCw2ICsxNCw3IEBACj4gIHR5cGVkZWYgdTY0IHB0ZXZhbF90Owo+ICB0eXBlZGVm
IHU2NCBwbWR2YWxfdDsKPiAgdHlwZWRlZiB1NjQgcHVkdmFsX3Q7Cj4gK3R5cGVkZWYgdTY0IHA0
ZHZhbF90Owo+ICB0eXBlZGVmIHU2NCBwZ2R2YWxfdDsKPiAgCj4gIC8qCj4gQEAgLTQ0LDEzICs0
NSwxMSBAQCB0eXBlZGVmIHN0cnVjdCB7IHB0ZXZhbF90IHBncHJvdDsgfSBwZ3ByCj4gICNkZWZp
bmUgX19wZ3Byb3QoeCkJKChwZ3Byb3RfdCkgeyAoeCkgfSApCj4gIAo+ICAjaWYgQ09ORklHX1BH
VEFCTEVfTEVWRUxTID09IDIKPiAtI2RlZmluZSBfX0FSQ0hfVVNFXzVMRVZFTF9IQUNLCj4gICNp
bmNsdWRlIDxhc20tZ2VuZXJpYy9wZ3RhYmxlLW5vcG1kLmg+Cj4gICNlbGlmIENPTkZJR19QR1RB
QkxFX0xFVkVMUyA9PSAzCj4gLSNkZWZpbmUgX19BUkNIX1VTRV81TEVWRUxfSEFDSwo+ICAjaW5j
bHVkZSA8YXNtLWdlbmVyaWMvcGd0YWJsZS1ub3B1ZC5oPgo+ICAjZWxpZiBDT05GSUdfUEdUQUJM
RV9MRVZFTFMgPT0gNAo+IC0jaW5jbHVkZSA8YXNtLWdlbmVyaWMvNWxldmVsLWZpeHVwLmg+Cj4g
KyNpbmNsdWRlIDxhc20tZ2VuZXJpYy9wZ3RhYmxlLW5vcDRkLmg+Cj4gICNlbmRpZgo+ICAKPiAg
I2VuZGlmCS8qIF9fQVNNX1BHVEFCTEVfVFlQRVNfSCAqLwo+IC0tLSBhL2FyY2gvYXJtNjQvaW5j
bHVkZS9hc20vc3RhZ2UyX3BndGFibGUuaH5hcm02NC1hZGQtc3VwcG9ydC1mb3ItZm9sZGVkLXA0
ZC1wYWdlLXRhYmxlcwo+ICsrKyBhL2FyY2gvYXJtNjQvaW5jbHVkZS9hc20vc3RhZ2UyX3BndGFi
bGUuaAo+IEBAIC02OCw0MSArNjgsNjcgQEAgc3RhdGljIGlubGluZSBib29sIGt2bV9zdGFnZTJf
aGFzX3B1ZChzdAo+ICAjZGVmaW5lIFMyX1BVRF9TSVpFCQkJKDFVTCA8PCBTMl9QVURfU0hJRlQp
Cj4gICNkZWZpbmUgUzJfUFVEX01BU0sJCQkofihTMl9QVURfU0laRSAtIDEpKQo+ICAKPiAtc3Rh
dGljIGlubGluZSBib29sIHN0YWdlMl9wZ2Rfbm9uZShzdHJ1Y3Qga3ZtICprdm0sIHBnZF90IHBn
ZCkKPiArI2RlZmluZSBzdGFnZTJfcGdkX25vbmUoa3ZtLCBwZ2QpCQlwZ2Rfbm9uZShwZ2QpCj4g
KyNkZWZpbmUgc3RhZ2UyX3BnZF9jbGVhcihrdm0sIHBnZCkJCXBnZF9jbGVhcihwZ2QpCj4gKyNk
ZWZpbmUgc3RhZ2UyX3BnZF9wcmVzZW50KGt2bSwgcGdkKQkJcGdkX3ByZXNlbnQocGdkKQo+ICsj
ZGVmaW5lIHN0YWdlMl9wZ2RfcG9wdWxhdGUoa3ZtLCBwZ2QsIHA0ZCkJcGdkX3BvcHVsYXRlKE5V
TEwsIHBnZCwgcDRkKQo+ICsKPiArc3RhdGljIGlubGluZSBwNGRfdCAqc3RhZ2UyX3A0ZF9vZmZz
ZXQoc3RydWN0IGt2bSAqa3ZtLAo+ICsJCQkJICAgICAgIHBnZF90ICpwZ2QsIHVuc2lnbmVkIGxv
bmcgYWRkcmVzcykKPiArewo+ICsJcmV0dXJuIHA0ZF9vZmZzZXQocGdkLCBhZGRyZXNzKTsKPiAr
fQo+ICsKPiArc3RhdGljIGlubGluZSB2b2lkIHN0YWdlMl9wNGRfZnJlZShzdHJ1Y3Qga3ZtICpr
dm0sIHA0ZF90ICpwNGQpCj4gK3sKPiArfQo+ICsKPiArc3RhdGljIGlubGluZSBib29sIHN0YWdl
Ml9wNGRfdGFibGVfZW1wdHkoc3RydWN0IGt2bSAqa3ZtLCBwNGRfdCAqcDRkcCkKPiArewo+ICsJ
cmV0dXJuIGZhbHNlOwo+ICt9Cj4gKwo+ICtzdGF0aWMgaW5saW5lIHBoeXNfYWRkcl90IHN0YWdl
Ml9wNGRfYWRkcl9lbmQoc3RydWN0IGt2bSAqa3ZtLAo+ICsJCQkJCSAgICAgIHBoeXNfYWRkcl90
IGFkZHIsIHBoeXNfYWRkcl90IGVuZCkKPiArewo+ICsJcmV0dXJuIGVuZDsKPiArfQo+ICsKPiAr
c3RhdGljIGlubGluZSBib29sIHN0YWdlMl9wNGRfbm9uZShzdHJ1Y3Qga3ZtICprdm0sIHA0ZF90
IHA0ZCkKPiAgewo+ICAJaWYgKGt2bV9zdGFnZTJfaGFzX3B1ZChrdm0pKQo+IC0JCXJldHVybiBw
Z2Rfbm9uZShwZ2QpOwo+ICsJCXJldHVybiBwNGRfbm9uZShwNGQpOwo+ICAJZWxzZQo+ICAJCXJl
dHVybiAwOwo+ICB9Cj4gIAo+IC1zdGF0aWMgaW5saW5lIHZvaWQgc3RhZ2UyX3BnZF9jbGVhcihz
dHJ1Y3Qga3ZtICprdm0sIHBnZF90ICpwZ2RwKQo+ICtzdGF0aWMgaW5saW5lIHZvaWQgc3RhZ2Uy
X3A0ZF9jbGVhcihzdHJ1Y3Qga3ZtICprdm0sIHA0ZF90ICpwNGRwKQo+ICB7Cj4gIAlpZiAoa3Zt
X3N0YWdlMl9oYXNfcHVkKGt2bSkpCj4gLQkJcGdkX2NsZWFyKHBnZHApOwo+ICsJCXA0ZF9jbGVh
cihwNGRwKTsKPiAgfQo+ICAKPiAtc3RhdGljIGlubGluZSBib29sIHN0YWdlMl9wZ2RfcHJlc2Vu
dChzdHJ1Y3Qga3ZtICprdm0sIHBnZF90IHBnZCkKPiArc3RhdGljIGlubGluZSBib29sIHN0YWdl
Ml9wNGRfcHJlc2VudChzdHJ1Y3Qga3ZtICprdm0sIHA0ZF90IHA0ZCkKPiAgewo+ICAJaWYgKGt2
bV9zdGFnZTJfaGFzX3B1ZChrdm0pKQo+IC0JCXJldHVybiBwZ2RfcHJlc2VudChwZ2QpOwo+ICsJ
CXJldHVybiBwNGRfcHJlc2VudChwNGQpOwo+ICAJZWxzZQo+ICAJCXJldHVybiAxOwo+ICB9Cj4g
IAo+IC1zdGF0aWMgaW5saW5lIHZvaWQgc3RhZ2UyX3BnZF9wb3B1bGF0ZShzdHJ1Y3Qga3ZtICpr
dm0sIHBnZF90ICpwZ2QsIHB1ZF90ICpwdWQpCj4gK3N0YXRpYyBpbmxpbmUgdm9pZCBzdGFnZTJf
cDRkX3BvcHVsYXRlKHN0cnVjdCBrdm0gKmt2bSwgcDRkX3QgKnA0ZCwgcHVkX3QgKnB1ZCkKPiAg
ewo+ICAJaWYgKGt2bV9zdGFnZTJfaGFzX3B1ZChrdm0pKQo+IC0JCXBnZF9wb3B1bGF0ZShOVUxM
LCBwZ2QsIHB1ZCk7Cj4gKwkJcDRkX3BvcHVsYXRlKE5VTEwsIHA0ZCwgcHVkKTsKPiAgfQo+ICAK
PiAgc3RhdGljIGlubGluZSBwdWRfdCAqc3RhZ2UyX3B1ZF9vZmZzZXQoc3RydWN0IGt2bSAqa3Zt
LAo+IC0JCQkJICAgICAgIHBnZF90ICpwZ2QsIHVuc2lnbmVkIGxvbmcgYWRkcmVzcykKPiArCQkJ
CSAgICAgICBwNGRfdCAqcDRkLCB1bnNpZ25lZCBsb25nIGFkZHJlc3MpCj4gIHsKPiAgCWlmIChr
dm1fc3RhZ2UyX2hhc19wdWQoa3ZtKSkKPiAtCQlyZXR1cm4gcHVkX29mZnNldChwZ2QsIGFkZHJl
c3MpOwo+ICsJCXJldHVybiBwdWRfb2Zmc2V0KHA0ZCwgYWRkcmVzcyk7Cj4gIAllbHNlCj4gLQkJ
cmV0dXJuIChwdWRfdCAqKXBnZDsKPiArCQlyZXR1cm4gKHB1ZF90ICopcDRkOwo+ICB9Cj4gIAo+
ICBzdGF0aWMgaW5saW5lIHZvaWQgc3RhZ2UyX3B1ZF9mcmVlKHN0cnVjdCBrdm0gKmt2bSwgcHVk
X3QgKnB1ZCkKPiAtLS0gYS9hcmNoL2FybTY0L2tlcm5lbC9oaWJlcm5hdGUuY35hcm02NC1hZGQt
c3VwcG9ydC1mb3ItZm9sZGVkLXA0ZC1wYWdlLXRhYmxlcwo+ICsrKyBhL2FyY2gvYXJtNjQva2Vy
bmVsL2hpYmVybmF0ZS5jCj4gQEAgLTE4NCw2ICsxODQsNyBAQCBzdGF0aWMgaW50IHRyYW5zX3Bn
ZF9tYXBfcGFnZShwZ2RfdCAqdHJhCj4gIAkJICAgICAgIHBncHJvdF90IHBncHJvdCkKPiAgewo+
ICAJcGdkX3QgKnBnZHA7Cj4gKwlwNGRfdCAqcDRkcDsKPiAgCXB1ZF90ICpwdWRwOwo+ICAJcG1k
X3QgKnBtZHA7Cj4gIAlwdGVfdCAqcHRlcDsKPiBAQCAtMTk2LDcgKzE5NywxNSBAQCBzdGF0aWMg
aW50IHRyYW5zX3BnZF9tYXBfcGFnZShwZ2RfdCAqdHJhCj4gIAkJcGdkX3BvcHVsYXRlKCZpbml0
X21tLCBwZ2RwLCBwdWRwKTsKPiAgCX0KPiAgCj4gLQlwdWRwID0gcHVkX29mZnNldChwZ2RwLCBk
c3RfYWRkcik7Cj4gKwlwNGRwID0gcDRkX29mZnNldChwZ2RwLCBkc3RfYWRkcik7Cj4gKwlpZiAo
cDRkX25vbmUoUkVBRF9PTkNFKCpwNGRwKSkpIHsKPiArCQlwdWRwID0gKHZvaWQgKilnZXRfc2Fm
ZV9wYWdlKEdGUF9BVE9NSUMpOwo+ICsJCWlmICghcHVkcCkKPiArCQkJcmV0dXJuIC1FTk9NRU07
Cj4gKwkJcDRkX3BvcHVsYXRlKCZpbml0X21tLCBwNGRwLCBwdWRwKTsKPiArCX0KPiArCj4gKwlw
dWRwID0gcHVkX29mZnNldChwNGRwLCBkc3RfYWRkcik7Cj4gIAlpZiAocHVkX25vbmUoUkVBRF9P
TkNFKCpwdWRwKSkpIHsKPiAgCQlwbWRwID0gKHZvaWQgKilnZXRfc2FmZV9wYWdlKEdGUF9BVE9N
SUMpOwo+ICAJCWlmICghcG1kcCkKPiBAQCAtNDE5LDcgKzQyOCw3IEBAIHN0YXRpYyBpbnQgY29w
eV9wbWQocHVkX3QgKmRzdF9wdWRwLCBwdWQKPiAgCXJldHVybiAwOwo+ICB9Cj4gIAo+IC1zdGF0
aWMgaW50IGNvcHlfcHVkKHBnZF90ICpkc3RfcGdkcCwgcGdkX3QgKnNyY19wZ2RwLCB1bnNpZ25l
ZCBsb25nIHN0YXJ0LAo+ICtzdGF0aWMgaW50IGNvcHlfcHVkKHA0ZF90ICpkc3RfcDRkcCwgcDRk
X3QgKnNyY19wNGRwLCB1bnNpZ25lZCBsb25nIHN0YXJ0LAo+ICAJCSAgICB1bnNpZ25lZCBsb25n
IGVuZCkKPiAgewo+ICAJcHVkX3QgKmRzdF9wdWRwOwo+IEBAIC00MjcsMTUgKzQzNiwxNSBAQCBz
dGF0aWMgaW50IGNvcHlfcHVkKHBnZF90ICpkc3RfcGdkcCwgcGdkCj4gIAl1bnNpZ25lZCBsb25n
IG5leHQ7Cj4gIAl1bnNpZ25lZCBsb25nIGFkZHIgPSBzdGFydDsKPiAgCj4gLQlpZiAocGdkX25v
bmUoUkVBRF9PTkNFKCpkc3RfcGdkcCkpKSB7Cj4gKwlpZiAocDRkX25vbmUoUkVBRF9PTkNFKCpk
c3RfcDRkcCkpKSB7Cj4gIAkJZHN0X3B1ZHAgPSAocHVkX3QgKilnZXRfc2FmZV9wYWdlKEdGUF9B
VE9NSUMpOwo+ICAJCWlmICghZHN0X3B1ZHApCj4gIAkJCXJldHVybiAtRU5PTUVNOwo+IC0JCXBn
ZF9wb3B1bGF0ZSgmaW5pdF9tbSwgZHN0X3BnZHAsIGRzdF9wdWRwKTsKPiArCQlwNGRfcG9wdWxh
dGUoJmluaXRfbW0sIGRzdF9wNGRwLCBkc3RfcHVkcCk7Cj4gIAl9Cj4gLQlkc3RfcHVkcCA9IHB1
ZF9vZmZzZXQoZHN0X3BnZHAsIHN0YXJ0KTsKPiArCWRzdF9wdWRwID0gcHVkX29mZnNldChkc3Rf
cDRkcCwgc3RhcnQpOwo+ICAKPiAtCXNyY19wdWRwID0gcHVkX29mZnNldChzcmNfcGdkcCwgc3Rh
cnQpOwo+ICsJc3JjX3B1ZHAgPSBwdWRfb2Zmc2V0KHNyY19wNGRwLCBzdGFydCk7Cj4gIAlkbyB7
Cj4gIAkJcHVkX3QgcHVkID0gUkVBRF9PTkNFKCpzcmNfcHVkcCk7Cj4gIAo+IEBAIC00NTQsNiAr
NDYzLDI3IEBAIHN0YXRpYyBpbnQgY29weV9wdWQocGdkX3QgKmRzdF9wZ2RwLCBwZ2QKPiAgCXJl
dHVybiAwOwo+ICB9Cj4gIAo+ICtzdGF0aWMgaW50IGNvcHlfcDRkKHBnZF90ICpkc3RfcGdkcCwg
cGdkX3QgKnNyY19wZ2RwLCB1bnNpZ25lZCBsb25nIHN0YXJ0LAo+ICsJCSAgICB1bnNpZ25lZCBs
b25nIGVuZCkKPiArewo+ICsJcDRkX3QgKmRzdF9wNGRwOwo+ICsJcDRkX3QgKnNyY19wNGRwOwo+
ICsJdW5zaWduZWQgbG9uZyBuZXh0Owo+ICsJdW5zaWduZWQgbG9uZyBhZGRyID0gc3RhcnQ7Cj4g
Kwo+ICsJZHN0X3A0ZHAgPSBwNGRfb2Zmc2V0KGRzdF9wZ2RwLCBzdGFydCk7Cj4gKwlzcmNfcDRk
cCA9IHA0ZF9vZmZzZXQoc3JjX3BnZHAsIHN0YXJ0KTsKPiArCWRvIHsKPiArCQluZXh0ID0gcDRk
X2FkZHJfZW5kKGFkZHIsIGVuZCk7Cj4gKwkJaWYgKHA0ZF9ub25lKFJFQURfT05DRSgqc3JjX3A0
ZHApKSkKPiArCQkJY29udGludWU7Cj4gKwkJaWYgKGNvcHlfcHVkKGRzdF9wNGRwLCBzcmNfcDRk
cCwgYWRkciwgbmV4dCkpCj4gKwkJCXJldHVybiAtRU5PTUVNOwo+ICsJfSB3aGlsZSAoZHN0X3A0
ZHArKywgc3JjX3A0ZHArKywgYWRkciA9IG5leHQsIGFkZHIgIT0gZW5kKTsKPiArCj4gKwlyZXR1
cm4gMDsKPiArfQo+ICsKPiAgc3RhdGljIGludCBjb3B5X3BhZ2VfdGFibGVzKHBnZF90ICpkc3Rf
cGdkcCwgdW5zaWduZWQgbG9uZyBzdGFydCwKPiAgCQkJICAgIHVuc2lnbmVkIGxvbmcgZW5kKQo+
ICB7Cj4gQEAgLTQ2Niw3ICs0OTYsNyBAQCBzdGF0aWMgaW50IGNvcHlfcGFnZV90YWJsZXMocGdk
X3QgKmRzdF9wCj4gIAkJbmV4dCA9IHBnZF9hZGRyX2VuZChhZGRyLCBlbmQpOwo+ICAJCWlmIChw
Z2Rfbm9uZShSRUFEX09OQ0UoKnNyY19wZ2RwKSkpCj4gIAkJCWNvbnRpbnVlOwo+IC0JCWlmIChj
b3B5X3B1ZChkc3RfcGdkcCwgc3JjX3BnZHAsIGFkZHIsIG5leHQpKQo+ICsJCWlmIChjb3B5X3A0
ZChkc3RfcGdkcCwgc3JjX3BnZHAsIGFkZHIsIG5leHQpKQo+ICAJCQlyZXR1cm4gLUVOT01FTTsK
PiAgCX0gd2hpbGUgKGRzdF9wZ2RwKyssIHNyY19wZ2RwKyssIGFkZHIgPSBuZXh0LCBhZGRyICE9
IGVuZCk7Cj4gIAo+IC0tLSBhL2FyY2gvYXJtNjQva3ZtL21tdS5jfmFybTY0LWFkZC1zdXBwb3J0
LWZvci1mb2xkZWQtcDRkLXBhZ2UtdGFibGVzCj4gKysrIGEvYXJjaC9hcm02NC9rdm0vbW11LmMK
PiBAQCAtMTU4LDEzICsxNTgsMjIgQEAgc3RhdGljIHZvaWQgKm1tdV9tZW1vcnlfY2FjaGVfYWxs
b2Moc3RydQo+ICAKPiAgc3RhdGljIHZvaWQgY2xlYXJfc3RhZ2UyX3BnZF9lbnRyeShzdHJ1Y3Qg
a3ZtICprdm0sIHBnZF90ICpwZ2QsIHBoeXNfYWRkcl90IGFkZHIpCj4gIHsKPiAtCXB1ZF90ICpw
dWRfdGFibGUgX19tYXliZV91bnVzZWQgPSBzdGFnZTJfcHVkX29mZnNldChrdm0sIHBnZCwgMFVM
KTsKPiArCXA0ZF90ICpwNGRfdGFibGUgX19tYXliZV91bnVzZWQgPSBzdGFnZTJfcDRkX29mZnNl
dChrdm0sIHBnZCwgMFVMKTsKPiAgCXN0YWdlMl9wZ2RfY2xlYXIoa3ZtLCBwZ2QpOwo+ICAJa3Zt
X3RsYl9mbHVzaF92bWlkX2lwYShrdm0sIGFkZHIpOwo+IC0Jc3RhZ2UyX3B1ZF9mcmVlKGt2bSwg
cHVkX3RhYmxlKTsKPiArCXN0YWdlMl9wNGRfZnJlZShrdm0sIHA0ZF90YWJsZSk7Cj4gIAlwdXRf
cGFnZSh2aXJ0X3RvX3BhZ2UocGdkKSk7Cj4gIH0KPiAgCj4gK3N0YXRpYyB2b2lkIGNsZWFyX3N0
YWdlMl9wNGRfZW50cnkoc3RydWN0IGt2bSAqa3ZtLCBwNGRfdCAqcDRkLCBwaHlzX2FkZHJfdCBh
ZGRyKQo+ICt7Cj4gKwlwdWRfdCAqcHVkX3RhYmxlIF9fbWF5YmVfdW51c2VkID0gc3RhZ2UyX3B1
ZF9vZmZzZXQoa3ZtLCBwNGQsIDApOwo+ICsJc3RhZ2UyX3A0ZF9jbGVhcihrdm0sIHA0ZCk7Cj4g
Kwlrdm1fdGxiX2ZsdXNoX3ZtaWRfaXBhKGt2bSwgYWRkcik7Cj4gKwlzdGFnZTJfcHVkX2ZyZWUo
a3ZtLCBwdWRfdGFibGUpOwo+ICsJcHV0X3BhZ2UodmlydF90b19wYWdlKHA0ZCkpOwo+ICt9Cj4g
Kwo+ICBzdGF0aWMgdm9pZCBjbGVhcl9zdGFnZTJfcHVkX2VudHJ5KHN0cnVjdCBrdm0gKmt2bSwg
cHVkX3QgKnB1ZCwgcGh5c19hZGRyX3QgYWRkcikKPiAgewo+ICAJcG1kX3QgKnBtZF90YWJsZSBf
X21heWJlX3VudXNlZCA9IHN0YWdlMl9wbWRfb2Zmc2V0KGt2bSwgcHVkLCAwKTsKPiBAQCAtMjA4
LDEyICsyMTcsMjAgQEAgc3RhdGljIGlubGluZSB2b2lkIGt2bV9wdWRfcG9wdWxhdGUocHVkXwo+
ICAJZHNiKGlzaHN0KTsKPiAgfQo+ICAKPiAtc3RhdGljIGlubGluZSB2b2lkIGt2bV9wZ2RfcG9w
dWxhdGUocGdkX3QgKnBnZHAsIHB1ZF90ICpwdWRwKQo+ICtzdGF0aWMgaW5saW5lIHZvaWQga3Zt
X3A0ZF9wb3B1bGF0ZShwNGRfdCAqcDRkcCwgcHVkX3QgKnB1ZHApCj4gIHsKPiAtCVdSSVRFX09O
Q0UoKnBnZHAsIGt2bV9ta19wZ2QocHVkcCkpOwo+ICsJV1JJVEVfT05DRSgqcDRkcCwga3ZtX21r
X3A0ZChwdWRwKSk7Cj4gIAlkc2IoaXNoc3QpOwo+ICB9Cj4gIAo+ICtzdGF0aWMgaW5saW5lIHZv
aWQga3ZtX3BnZF9wb3B1bGF0ZShwZ2RfdCAqcGdkcCwgcDRkX3QgKnA0ZHApCj4gK3sKPiArI2lm
bmRlZiBfX1BBR0VUQUJMRV9QNERfRk9MREVECj4gKwlXUklURV9PTkNFKCpwZ2RwLCBrdm1fbWtf
cGdkKHA0ZHApKTsKPiArCWRzYihpc2hzdCk7Cj4gKyNlbmRpZgo+ICt9Cj4gKwo+ICAvKgo+ICAg
KiBVbm1hcHBpbmcgdnMgZGNhY2hlIG1hbmFnZW1lbnQ6Cj4gICAqCj4gQEAgLTI5MywxMyArMzEw
LDEzIEBAIHN0YXRpYyB2b2lkIHVubWFwX3N0YWdlMl9wbWRzKHN0cnVjdCBrdm0KPiAgCQljbGVh
cl9zdGFnZTJfcHVkX2VudHJ5KGt2bSwgcHVkLCBzdGFydF9hZGRyKTsKPiAgfQo+ICAKPiAtc3Rh
dGljIHZvaWQgdW5tYXBfc3RhZ2UyX3B1ZHMoc3RydWN0IGt2bSAqa3ZtLCBwZ2RfdCAqcGdkLAo+
ICtzdGF0aWMgdm9pZCB1bm1hcF9zdGFnZTJfcHVkcyhzdHJ1Y3Qga3ZtICprdm0sIHA0ZF90ICpw
NGQsCj4gIAkJICAgICAgIHBoeXNfYWRkcl90IGFkZHIsIHBoeXNfYWRkcl90IGVuZCkKPiAgewo+
ICAJcGh5c19hZGRyX3QgbmV4dCwgc3RhcnRfYWRkciA9IGFkZHI7Cj4gIAlwdWRfdCAqcHVkLCAq
c3RhcnRfcHVkOwo+ICAKPiAtCXN0YXJ0X3B1ZCA9IHB1ZCA9IHN0YWdlMl9wdWRfb2Zmc2V0KGt2
bSwgcGdkLCBhZGRyKTsKPiArCXN0YXJ0X3B1ZCA9IHB1ZCA9IHN0YWdlMl9wdWRfb2Zmc2V0KGt2
bSwgcDRkLCBhZGRyKTsKPiAgCWRvIHsKPiAgCQluZXh0ID0gc3RhZ2UyX3B1ZF9hZGRyX2VuZChr
dm0sIGFkZHIsIGVuZCk7Cj4gIAkJaWYgKCFzdGFnZTJfcHVkX25vbmUoa3ZtLCAqcHVkKSkgewo+
IEBAIC0zMTcsNiArMzM0LDIzIEBAIHN0YXRpYyB2b2lkIHVubWFwX3N0YWdlMl9wdWRzKHN0cnVj
dCBrdm0KPiAgCX0gd2hpbGUgKHB1ZCsrLCBhZGRyID0gbmV4dCwgYWRkciAhPSBlbmQpOwo+ICAK
PiAgCWlmIChzdGFnZTJfcHVkX3RhYmxlX2VtcHR5KGt2bSwgc3RhcnRfcHVkKSkKPiArCQljbGVh
cl9zdGFnZTJfcDRkX2VudHJ5KGt2bSwgcDRkLCBzdGFydF9hZGRyKTsKPiArfQo+ICsKPiArc3Rh
dGljIHZvaWQgdW5tYXBfc3RhZ2UyX3A0ZHMoc3RydWN0IGt2bSAqa3ZtLCBwZ2RfdCAqcGdkLAo+
ICsJCSAgICAgICBwaHlzX2FkZHJfdCBhZGRyLCBwaHlzX2FkZHJfdCBlbmQpCj4gK3sKPiArCXBo
eXNfYWRkcl90IG5leHQsIHN0YXJ0X2FkZHIgPSBhZGRyOwo+ICsJcDRkX3QgKnA0ZCwgKnN0YXJ0
X3A0ZDsKPiArCj4gKwlzdGFydF9wNGQgPSBwNGQgPSBzdGFnZTJfcDRkX29mZnNldChrdm0sIHBn
ZCwgYWRkcik7Cj4gKwlkbyB7Cj4gKwkJbmV4dCA9IHN0YWdlMl9wNGRfYWRkcl9lbmQoa3ZtLCBh
ZGRyLCBlbmQpOwo+ICsJCWlmICghc3RhZ2UyX3A0ZF9ub25lKGt2bSwgKnA0ZCkpCj4gKwkJCXVu
bWFwX3N0YWdlMl9wdWRzKGt2bSwgcDRkLCBhZGRyLCBuZXh0KTsKPiArCX0gd2hpbGUgKHA0ZCsr
LCBhZGRyID0gbmV4dCwgYWRkciAhPSBlbmQpOwo+ICsKPiArCWlmIChzdGFnZTJfcDRkX3RhYmxl
X2VtcHR5KGt2bSwgc3RhcnRfcDRkKSkKPiAgCQljbGVhcl9zdGFnZTJfcGdkX2VudHJ5KGt2bSwg
cGdkLCBzdGFydF9hZGRyKTsKPiAgfQo+ICAKPiBAQCAtMzUxLDcgKzM4NSw3IEBAIHN0YXRpYyB2
b2lkIHVubWFwX3N0YWdlMl9yYW5nZShzdHJ1Y3Qga3YKPiAgCQkJYnJlYWs7Cj4gIAkJbmV4dCA9
IHN0YWdlMl9wZ2RfYWRkcl9lbmQoa3ZtLCBhZGRyLCBlbmQpOwo+ICAJCWlmICghc3RhZ2UyX3Bn
ZF9ub25lKGt2bSwgKnBnZCkpCj4gLQkJCXVubWFwX3N0YWdlMl9wdWRzKGt2bSwgcGdkLCBhZGRy
LCBuZXh0KTsKPiArCQkJdW5tYXBfc3RhZ2UyX3A0ZHMoa3ZtLCBwZ2QsIGFkZHIsIG5leHQpOwo+
ICAJCS8qCj4gIAkJICogSWYgdGhlIHJhbmdlIGlzIHRvbyBsYXJnZSwgcmVsZWFzZSB0aGUga3Zt
LT5tbXVfbG9jawo+ICAJCSAqIHRvIHByZXZlbnQgc3RhcnZhdGlvbiBhbmQgbG9ja3VwIGRldGVj
dG9yIHdhcm5pbmdzLgo+IEBAIC0zOTEsMTMgKzQyNSwxMyBAQCBzdGF0aWMgdm9pZCBzdGFnZTJf
Zmx1c2hfcG1kcyhzdHJ1Y3Qga3ZtCj4gIAl9IHdoaWxlIChwbWQrKywgYWRkciA9IG5leHQsIGFk
ZHIgIT0gZW5kKTsKPiAgfQo+ICAKPiAtc3RhdGljIHZvaWQgc3RhZ2UyX2ZsdXNoX3B1ZHMoc3Ry
dWN0IGt2bSAqa3ZtLCBwZ2RfdCAqcGdkLAo+ICtzdGF0aWMgdm9pZCBzdGFnZTJfZmx1c2hfcHVk
cyhzdHJ1Y3Qga3ZtICprdm0sIHA0ZF90ICpwNGQsCj4gIAkJCSAgICAgIHBoeXNfYWRkcl90IGFk
ZHIsIHBoeXNfYWRkcl90IGVuZCkKPiAgewo+ICAJcHVkX3QgKnB1ZDsKPiAgCXBoeXNfYWRkcl90
IG5leHQ7Cj4gIAo+IC0JcHVkID0gc3RhZ2UyX3B1ZF9vZmZzZXQoa3ZtLCBwZ2QsIGFkZHIpOwo+
ICsJcHVkID0gc3RhZ2UyX3B1ZF9vZmZzZXQoa3ZtLCBwNGQsIGFkZHIpOwo+ICAJZG8gewo+ICAJ
CW5leHQgPSBzdGFnZTJfcHVkX2FkZHJfZW5kKGt2bSwgYWRkciwgZW5kKTsKPiAgCQlpZiAoIXN0
YWdlMl9wdWRfbm9uZShrdm0sICpwdWQpKSB7Cj4gQEAgLTQwOSw2ICs0NDMsMjAgQEAgc3RhdGlj
IHZvaWQgc3RhZ2UyX2ZsdXNoX3B1ZHMoc3RydWN0IGt2bQo+ICAJfSB3aGlsZSAocHVkKyssIGFk
ZHIgPSBuZXh0LCBhZGRyICE9IGVuZCk7Cj4gIH0KPiAgCj4gK3N0YXRpYyB2b2lkIHN0YWdlMl9m
bHVzaF9wNGRzKHN0cnVjdCBrdm0gKmt2bSwgcGdkX3QgKnBnZCwKPiArCQkJICAgICAgcGh5c19h
ZGRyX3QgYWRkciwgcGh5c19hZGRyX3QgZW5kKQo+ICt7Cj4gKwlwNGRfdCAqcDRkOwo+ICsJcGh5
c19hZGRyX3QgbmV4dDsKPiArCj4gKwlwNGQgPSBzdGFnZTJfcDRkX29mZnNldChrdm0sIHBnZCwg
YWRkcik7Cj4gKwlkbyB7Cj4gKwkJbmV4dCA9IHN0YWdlMl9wNGRfYWRkcl9lbmQoa3ZtLCBhZGRy
LCBlbmQpOwo+ICsJCWlmICghc3RhZ2UyX3A0ZF9ub25lKGt2bSwgKnA0ZCkpCj4gKwkJCXN0YWdl
Ml9mbHVzaF9wdWRzKGt2bSwgcDRkLCBhZGRyLCBuZXh0KTsKPiArCX0gd2hpbGUgKHA0ZCsrLCBh
ZGRyID0gbmV4dCwgYWRkciAhPSBlbmQpOwo+ICt9Cj4gKwo+ICBzdGF0aWMgdm9pZCBzdGFnZTJf
Zmx1c2hfbWVtc2xvdChzdHJ1Y3Qga3ZtICprdm0sCj4gIAkJCQkgc3RydWN0IGt2bV9tZW1vcnlf
c2xvdCAqbWVtc2xvdCkKPiAgewo+IEBAIC00MjEsNyArNDY5LDcgQEAgc3RhdGljIHZvaWQgc3Rh
Z2UyX2ZsdXNoX21lbXNsb3Qoc3RydWN0Cj4gIAlkbyB7Cj4gIAkJbmV4dCA9IHN0YWdlMl9wZ2Rf
YWRkcl9lbmQoa3ZtLCBhZGRyLCBlbmQpOwo+ICAJCWlmICghc3RhZ2UyX3BnZF9ub25lKGt2bSwg
KnBnZCkpCj4gLQkJCXN0YWdlMl9mbHVzaF9wdWRzKGt2bSwgcGdkLCBhZGRyLCBuZXh0KTsKPiAr
CQkJc3RhZ2UyX2ZsdXNoX3A0ZHMoa3ZtLCBwZ2QsIGFkZHIsIG5leHQpOwo+ICAKPiAgCQlpZiAo
bmV4dCAhPSBlbmQpCj4gIAkJCWNvbmRfcmVzY2hlZF9sb2NrKCZrdm0tPm1tdV9sb2NrKTsKPiBA
QCAtNDU0LDEyICs1MDIsMjEgQEAgc3RhdGljIHZvaWQgc3RhZ2UyX2ZsdXNoX3ZtKHN0cnVjdCBr
dm0gKgo+ICAKPiAgc3RhdGljIHZvaWQgY2xlYXJfaHlwX3BnZF9lbnRyeShwZ2RfdCAqcGdkKQo+
ICB7Cj4gLQlwdWRfdCAqcHVkX3RhYmxlIF9fbWF5YmVfdW51c2VkID0gcHVkX29mZnNldChwZ2Qs
IDBVTCk7Cj4gKwlwNGRfdCAqcDRkX3RhYmxlIF9fbWF5YmVfdW51c2VkID0gcDRkX29mZnNldChw
Z2QsIDBVTCk7Cj4gIAlwZ2RfY2xlYXIocGdkKTsKPiAtCXB1ZF9mcmVlKE5VTEwsIHB1ZF90YWJs
ZSk7Cj4gKwlwNGRfZnJlZShOVUxMLCBwNGRfdGFibGUpOwo+ICAJcHV0X3BhZ2UodmlydF90b19w
YWdlKHBnZCkpOwo+ICB9Cj4gIAo+ICtzdGF0aWMgdm9pZCBjbGVhcl9oeXBfcDRkX2VudHJ5KHA0
ZF90ICpwNGQpCj4gK3sKPiArCXB1ZF90ICpwdWRfdGFibGUgX19tYXliZV91bnVzZWQgPSBwdWRf
b2Zmc2V0KHA0ZCwgMCk7Cj4gKwlWTV9CVUdfT04ocDRkX2h1Z2UoKnA0ZCkpOwo+ICsJcDRkX2Ns
ZWFyKHA0ZCk7Cj4gKwlwdWRfZnJlZShOVUxMLCBwdWRfdGFibGUpOwo+ICsJcHV0X3BhZ2Uodmly
dF90b19wYWdlKHA0ZCkpOwo+ICt9Cj4gKwo+ICBzdGF0aWMgdm9pZCBjbGVhcl9oeXBfcHVkX2Vu
dHJ5KHB1ZF90ICpwdWQpCj4gIHsKPiAgCXBtZF90ICpwbWRfdGFibGUgX19tYXliZV91bnVzZWQg
PSBwbWRfb2Zmc2V0KHB1ZCwgMCk7Cj4gQEAgLTUxMSwxMiArNTY4LDEyIEBAIHN0YXRpYyB2b2lk
IHVubWFwX2h5cF9wbWRzKHB1ZF90ICpwdWQsIHAKPiAgCQljbGVhcl9oeXBfcHVkX2VudHJ5KHB1
ZCk7Cj4gIH0KPiAgCj4gLXN0YXRpYyB2b2lkIHVubWFwX2h5cF9wdWRzKHBnZF90ICpwZ2QsIHBo
eXNfYWRkcl90IGFkZHIsIHBoeXNfYWRkcl90IGVuZCkKPiArc3RhdGljIHZvaWQgdW5tYXBfaHlw
X3B1ZHMocDRkX3QgKnA0ZCwgcGh5c19hZGRyX3QgYWRkciwgcGh5c19hZGRyX3QgZW5kKQo+ICB7
Cj4gIAlwaHlzX2FkZHJfdCBuZXh0Owo+ICAJcHVkX3QgKnB1ZCwgKnN0YXJ0X3B1ZDsKPiAgCj4g
LQlzdGFydF9wdWQgPSBwdWQgPSBwdWRfb2Zmc2V0KHBnZCwgYWRkcik7Cj4gKwlzdGFydF9wdWQg
PSBwdWQgPSBwdWRfb2Zmc2V0KHA0ZCwgYWRkcik7Cj4gIAlkbyB7Cj4gIAkJbmV4dCA9IHB1ZF9h
ZGRyX2VuZChhZGRyLCBlbmQpOwo+ICAJCS8qIEh5cCBkb2Vzbid0IHVzZSBodWdlIHB1ZHMgKi8K
PiBAQCAtNTI1LDYgKzU4MiwyMyBAQCBzdGF0aWMgdm9pZCB1bm1hcF9oeXBfcHVkcyhwZ2RfdCAq
cGdkLCBwCj4gIAl9IHdoaWxlIChwdWQrKywgYWRkciA9IG5leHQsIGFkZHIgIT0gZW5kKTsKPiAg
Cj4gIAlpZiAoaHlwX3B1ZF90YWJsZV9lbXB0eShzdGFydF9wdWQpKQo+ICsJCWNsZWFyX2h5cF9w
NGRfZW50cnkocDRkKTsKPiArfQo+ICsKPiArc3RhdGljIHZvaWQgdW5tYXBfaHlwX3A0ZHMocGdk
X3QgKnBnZCwgcGh5c19hZGRyX3QgYWRkciwgcGh5c19hZGRyX3QgZW5kKQo+ICt7Cj4gKwlwaHlz
X2FkZHJfdCBuZXh0Owo+ICsJcDRkX3QgKnA0ZCwgKnN0YXJ0X3A0ZDsKPiArCj4gKwlzdGFydF9w
NGQgPSBwNGQgPSBwNGRfb2Zmc2V0KHBnZCwgYWRkcik7Cj4gKwlkbyB7Cj4gKwkJbmV4dCA9IHA0
ZF9hZGRyX2VuZChhZGRyLCBlbmQpOwo+ICsJCS8qIEh5cCBkb2Vzbid0IHVzZSBodWdlIHA0ZHMg
Ki8KPiArCQlpZiAoIXA0ZF9ub25lKCpwNGQpKQo+ICsJCQl1bm1hcF9oeXBfcHVkcyhwNGQsIGFk
ZHIsIG5leHQpOwo+ICsJfSB3aGlsZSAocDRkKyssIGFkZHIgPSBuZXh0LCBhZGRyICE9IGVuZCk7
Cj4gKwo+ICsJaWYgKGh5cF9wNGRfdGFibGVfZW1wdHkoc3RhcnRfcDRkKSkKPiAgCQljbGVhcl9o
eXBfcGdkX2VudHJ5KHBnZCk7Cj4gIH0KPiAgCj4gQEAgLTU0OCw3ICs2MjIsNyBAQCBzdGF0aWMg
dm9pZCBfX3VubWFwX2h5cF9yYW5nZShwZ2RfdCAqcGdkCj4gIAlkbyB7Cj4gIAkJbmV4dCA9IHBn
ZF9hZGRyX2VuZChhZGRyLCBlbmQpOwo+ICAJCWlmICghcGdkX25vbmUoKnBnZCkpCj4gLQkJCXVu
bWFwX2h5cF9wdWRzKHBnZCwgYWRkciwgbmV4dCk7Cj4gKwkJCXVubWFwX2h5cF9wNGRzKHBnZCwg
YWRkciwgbmV4dCk7Cj4gIAl9IHdoaWxlIChwZ2QrKywgYWRkciA9IG5leHQsIGFkZHIgIT0gZW5k
KTsKPiAgfQo+ICAKPiBAQCAtNjU4LDcgKzczMiw3IEBAIHN0YXRpYyBpbnQgY3JlYXRlX2h5cF9w
bWRfbWFwcGluZ3MocHVkX3QKPiAgCXJldHVybiAwOwo+ICB9Cj4gIAo+IC1zdGF0aWMgaW50IGNy
ZWF0ZV9oeXBfcHVkX21hcHBpbmdzKHBnZF90ICpwZ2QsIHVuc2lnbmVkIGxvbmcgc3RhcnQsCj4g
K3N0YXRpYyBpbnQgY3JlYXRlX2h5cF9wdWRfbWFwcGluZ3MocDRkX3QgKnA0ZCwgdW5zaWduZWQg
bG9uZyBzdGFydCwKPiAgCQkJCSAgIHVuc2lnbmVkIGxvbmcgZW5kLCB1bnNpZ25lZCBsb25nIHBm
biwKPiAgCQkJCSAgIHBncHJvdF90IHByb3QpCj4gIHsKPiBAQCAtNjY5LDcgKzc0Myw3IEBAIHN0
YXRpYyBpbnQgY3JlYXRlX2h5cF9wdWRfbWFwcGluZ3MocGdkX3QKPiAgCj4gIAlhZGRyID0gc3Rh
cnQ7Cj4gIAlkbyB7Cj4gLQkJcHVkID0gcHVkX29mZnNldChwZ2QsIGFkZHIpOwo+ICsJCXB1ZCA9
IHB1ZF9vZmZzZXQocDRkLCBhZGRyKTsKPiAgCj4gIAkJaWYgKHB1ZF9ub25lX29yX2NsZWFyX2Jh
ZChwdWQpKSB7Cj4gIAkJCXBtZCA9IHBtZF9hbGxvY19vbmUoTlVMTCwgYWRkcik7Cj4gQEAgLTY5
MSwxMiArNzY1LDQ1IEBAIHN0YXRpYyBpbnQgY3JlYXRlX2h5cF9wdWRfbWFwcGluZ3MocGdkX3QK
PiAgCXJldHVybiAwOwo+ICB9Cj4gIAo+ICtzdGF0aWMgaW50IGNyZWF0ZV9oeXBfcDRkX21hcHBp
bmdzKHBnZF90ICpwZ2QsIHVuc2lnbmVkIGxvbmcgc3RhcnQsCj4gKwkJCQkgICB1bnNpZ25lZCBs
b25nIGVuZCwgdW5zaWduZWQgbG9uZyBwZm4sCj4gKwkJCQkgICBwZ3Byb3RfdCBwcm90KQo+ICt7
Cj4gKwlwNGRfdCAqcDRkOwo+ICsJcHVkX3QgKnB1ZDsKPiArCXVuc2lnbmVkIGxvbmcgYWRkciwg
bmV4dDsKPiArCWludCByZXQ7Cj4gKwo+ICsJYWRkciA9IHN0YXJ0Owo+ICsJZG8gewo+ICsJCXA0
ZCA9IHA0ZF9vZmZzZXQocGdkLCBhZGRyKTsKPiArCj4gKwkJaWYgKHA0ZF9ub25lKCpwNGQpKSB7
Cj4gKwkJCXB1ZCA9IHB1ZF9hbGxvY19vbmUoTlVMTCwgYWRkcik7Cj4gKwkJCWlmICghcHVkKSB7
Cj4gKwkJCQlrdm1fZXJyKCJDYW5ub3QgYWxsb2NhdGUgSHlwIHB1ZFxuIik7Cj4gKwkJCQlyZXR1
cm4gLUVOT01FTTsKPiArCQkJfQo+ICsJCQlrdm1fcDRkX3BvcHVsYXRlKHA0ZCwgcHVkKTsKPiAr
CQkJZ2V0X3BhZ2UodmlydF90b19wYWdlKHA0ZCkpOwo+ICsJCX0KPiArCj4gKwkJbmV4dCA9IHA0
ZF9hZGRyX2VuZChhZGRyLCBlbmQpOwo+ICsJCXJldCA9IGNyZWF0ZV9oeXBfcHVkX21hcHBpbmdz
KHA0ZCwgYWRkciwgbmV4dCwgcGZuLCBwcm90KTsKPiArCQlpZiAocmV0KQo+ICsJCQlyZXR1cm4g
cmV0Owo+ICsJCXBmbiArPSAobmV4dCAtIGFkZHIpID4+IFBBR0VfU0hJRlQ7Cj4gKwl9IHdoaWxl
IChhZGRyID0gbmV4dCwgYWRkciAhPSBlbmQpOwo+ICsKPiArCXJldHVybiAwOwo+ICt9Cj4gKwo+
ICBzdGF0aWMgaW50IF9fY3JlYXRlX2h5cF9tYXBwaW5ncyhwZ2RfdCAqcGdkcCwgdW5zaWduZWQg
bG9uZyBwdHJzX3Blcl9wZ2QsCj4gIAkJCQkgdW5zaWduZWQgbG9uZyBzdGFydCwgdW5zaWduZWQg
bG9uZyBlbmQsCj4gIAkJCQkgdW5zaWduZWQgbG9uZyBwZm4sIHBncHJvdF90IHByb3QpCj4gIHsK
PiAgCXBnZF90ICpwZ2Q7Cj4gLQlwdWRfdCAqcHVkOwo+ICsJcDRkX3QgKnA0ZDsKPiAgCXVuc2ln
bmVkIGxvbmcgYWRkciwgbmV4dDsKPiAgCWludCBlcnIgPSAwOwo+ICAKPiBAQCAtNzA3LDE4ICs4
MTQsMTggQEAgc3RhdGljIGludCBfX2NyZWF0ZV9oeXBfbWFwcGluZ3MocGdkX3QgKgo+ICAJCXBn
ZCA9IHBnZHAgKyBrdm1fcGdkX2luZGV4KGFkZHIsIHB0cnNfcGVyX3BnZCk7Cj4gIAo+ICAJCWlm
IChwZ2Rfbm9uZSgqcGdkKSkgewo+IC0JCQlwdWQgPSBwdWRfYWxsb2Nfb25lKE5VTEwsIGFkZHIp
Owo+IC0JCQlpZiAoIXB1ZCkgewo+IC0JCQkJa3ZtX2VycigiQ2Fubm90IGFsbG9jYXRlIEh5cCBw
dWRcbiIpOwo+ICsJCQlwNGQgPSBwNGRfYWxsb2Nfb25lKE5VTEwsIGFkZHIpOwo+ICsJCQlpZiAo
IXA0ZCkgewo+ICsJCQkJa3ZtX2VycigiQ2Fubm90IGFsbG9jYXRlIEh5cCBwNGRcbiIpOwo+ICAJ
CQkJZXJyID0gLUVOT01FTTsKPiAgCQkJCWdvdG8gb3V0Owo+ICAJCQl9Cj4gLQkJCWt2bV9wZ2Rf
cG9wdWxhdGUocGdkLCBwdWQpOwo+ICsJCQlrdm1fcGdkX3BvcHVsYXRlKHBnZCwgcDRkKTsKPiAg
CQkJZ2V0X3BhZ2UodmlydF90b19wYWdlKHBnZCkpOwo+ICAJCX0KPiAgCj4gIAkJbmV4dCA9IHBn
ZF9hZGRyX2VuZChhZGRyLCBlbmQpOwo+IC0JCWVyciA9IGNyZWF0ZV9oeXBfcHVkX21hcHBpbmdz
KHBnZCwgYWRkciwgbmV4dCwgcGZuLCBwcm90KTsKPiArCQllcnIgPSBjcmVhdGVfaHlwX3A0ZF9t
YXBwaW5ncyhwZ2QsIGFkZHIsIG5leHQsIHBmbiwgcHJvdCk7Cj4gIAkJaWYgKGVycikKPiAgCQkJ
Z290byBvdXQ7Cj4gIAkJcGZuICs9IChuZXh0IC0gYWRkcikgPj4gUEFHRV9TSElGVDsKPiBAQCAt
MTAxNSwyMiArMTEyMiw0MCBAQCB2b2lkIGt2bV9mcmVlX3N0YWdlMl9wZ2Qoc3RydWN0IGt2bSAq
a3ZtCj4gIAkJZnJlZV9wYWdlc19leGFjdChwZ2QsIHN0YWdlMl9wZ2Rfc2l6ZShrdm0pKTsKPiAg
fQo+ICAKPiAtc3RhdGljIHB1ZF90ICpzdGFnZTJfZ2V0X3B1ZChzdHJ1Y3Qga3ZtICprdm0sIHN0
cnVjdCBrdm1fbW11X21lbW9yeV9jYWNoZSAqY2FjaGUsCj4gK3N0YXRpYyBwNGRfdCAqc3RhZ2Uy
X2dldF9wNGQoc3RydWN0IGt2bSAqa3ZtLCBzdHJ1Y3Qga3ZtX21tdV9tZW1vcnlfY2FjaGUgKmNh
Y2hlLAo+ICAJCQkgICAgIHBoeXNfYWRkcl90IGFkZHIpCj4gIHsKPiAgCXBnZF90ICpwZ2Q7Cj4g
LQlwdWRfdCAqcHVkOwo+ICsJcDRkX3QgKnA0ZDsKPiAgCj4gIAlwZ2QgPSBrdm0tPmFyY2gucGdk
ICsgc3RhZ2UyX3BnZF9pbmRleChrdm0sIGFkZHIpOwo+ICAJaWYgKHN0YWdlMl9wZ2Rfbm9uZShr
dm0sICpwZ2QpKSB7Cj4gIAkJaWYgKCFjYWNoZSkKPiAgCQkJcmV0dXJuIE5VTEw7Cj4gLQkJcHVk
ID0gbW11X21lbW9yeV9jYWNoZV9hbGxvYyhjYWNoZSk7Cj4gLQkJc3RhZ2UyX3BnZF9wb3B1bGF0
ZShrdm0sIHBnZCwgcHVkKTsKPiArCQlwNGQgPSBtbXVfbWVtb3J5X2NhY2hlX2FsbG9jKGNhY2hl
KTsKPiArCQlzdGFnZTJfcGdkX3BvcHVsYXRlKGt2bSwgcGdkLCBwNGQpOwo+ICAJCWdldF9wYWdl
KHZpcnRfdG9fcGFnZShwZ2QpKTsKPiAgCX0KPiAgCj4gLQlyZXR1cm4gc3RhZ2UyX3B1ZF9vZmZz
ZXQoa3ZtLCBwZ2QsIGFkZHIpOwo+ICsJcmV0dXJuIHN0YWdlMl9wNGRfb2Zmc2V0KGt2bSwgcGdk
LCBhZGRyKTsKPiArfQo+ICsKPiArc3RhdGljIHB1ZF90ICpzdGFnZTJfZ2V0X3B1ZChzdHJ1Y3Qg
a3ZtICprdm0sIHN0cnVjdCBrdm1fbW11X21lbW9yeV9jYWNoZSAqY2FjaGUsCj4gKwkJCSAgICAg
cGh5c19hZGRyX3QgYWRkcikKPiArewo+ICsJcDRkX3QgKnA0ZDsKPiArCXB1ZF90ICpwdWQ7Cj4g
Kwo+ICsJcDRkID0gc3RhZ2UyX2dldF9wNGQoa3ZtLCBjYWNoZSwgYWRkcik7Cj4gKwlpZiAoc3Rh
Z2UyX3A0ZF9ub25lKGt2bSwgKnA0ZCkpIHsKPiArCQlpZiAoIWNhY2hlKQo+ICsJCQlyZXR1cm4g
TlVMTDsKPiArCQlwdWQgPSBtbXVfbWVtb3J5X2NhY2hlX2FsbG9jKGNhY2hlKTsKPiArCQlzdGFn
ZTJfcDRkX3BvcHVsYXRlKGt2bSwgcDRkLCBwdWQpOwo+ICsJCWdldF9wYWdlKHZpcnRfdG9fcGFn
ZShwNGQpKTsKPiArCX0KPiArCj4gKwlyZXR1cm4gc3RhZ2UyX3B1ZF9vZmZzZXQoa3ZtLCBwNGQs
IGFkZHIpOwo+ICB9Cj4gIAo+ICBzdGF0aWMgcG1kX3QgKnN0YWdlMl9nZXRfcG1kKHN0cnVjdCBr
dm0gKmt2bSwgc3RydWN0IGt2bV9tbXVfbWVtb3J5X2NhY2hlICpjYWNoZSwKPiBAQCAtMTQyMywx
OCArMTU0OCwxOCBAQCBzdGF0aWMgdm9pZCBzdGFnZTJfd3BfcG1kcyhzdHJ1Y3Qga3ZtICprCj4g
IH0KPiAgCj4gIC8qKgo+IC0gKiBzdGFnZTJfd3BfcHVkcyAtIHdyaXRlIHByb3RlY3QgUEdEIHJh
bmdlCj4gKyAqIHN0YWdlMl93cF9wdWRzIC0gd3JpdGUgcHJvdGVjdCBQNEQgcmFuZ2UKPiAgICog
QHBnZDoJcG9pbnRlciB0byBwZ2QgZW50cnkKPiAgICogQGFkZHI6CXJhbmdlIHN0YXJ0IGFkZHJl
c3MKPiAgICogQGVuZDoJcmFuZ2UgZW5kIGFkZHJlc3MKPiAgICovCj4gLXN0YXRpYyB2b2lkICBz
dGFnZTJfd3BfcHVkcyhzdHJ1Y3Qga3ZtICprdm0sIHBnZF90ICpwZ2QsCj4gK3N0YXRpYyB2b2lk
ICBzdGFnZTJfd3BfcHVkcyhzdHJ1Y3Qga3ZtICprdm0sIHA0ZF90ICpwNGQsCj4gIAkJCSAgICBw
aHlzX2FkZHJfdCBhZGRyLCBwaHlzX2FkZHJfdCBlbmQpCj4gIHsKPiAgCXB1ZF90ICpwdWQ7Cj4g
IAlwaHlzX2FkZHJfdCBuZXh0Owo+ICAKPiAtCXB1ZCA9IHN0YWdlMl9wdWRfb2Zmc2V0KGt2bSwg
cGdkLCBhZGRyKTsKPiArCXB1ZCA9IHN0YWdlMl9wdWRfb2Zmc2V0KGt2bSwgcDRkLCBhZGRyKTsK
PiAgCWRvIHsKPiAgCQluZXh0ID0gc3RhZ2UyX3B1ZF9hZGRyX2VuZChrdm0sIGFkZHIsIGVuZCk7
Cj4gIAkJaWYgKCFzdGFnZTJfcHVkX25vbmUoa3ZtLCAqcHVkKSkgewo+IEBAIC0xNDQ5LDYgKzE1
NzQsMjYgQEAgc3RhdGljIHZvaWQgIHN0YWdlMl93cF9wdWRzKHN0cnVjdCBrdm0gKgo+ICB9Cj4g
IAo+ICAvKioKPiArICogc3RhZ2UyX3dwX3A0ZHMgLSB3cml0ZSBwcm90ZWN0IFBHRCByYW5nZQo+
ICsgKiBAcGdkOglwb2ludGVyIHRvIHBnZCBlbnRyeQo+ICsgKiBAYWRkcjoJcmFuZ2Ugc3RhcnQg
YWRkcmVzcwo+ICsgKiBAZW5kOglyYW5nZSBlbmQgYWRkcmVzcwo+ICsgKi8KPiArc3RhdGljIHZv
aWQgIHN0YWdlMl93cF9wNGRzKHN0cnVjdCBrdm0gKmt2bSwgcGdkX3QgKnBnZCwKPiArCQkJICAg
IHBoeXNfYWRkcl90IGFkZHIsIHBoeXNfYWRkcl90IGVuZCkKPiArewo+ICsJcDRkX3QgKnA0ZDsK
PiArCXBoeXNfYWRkcl90IG5leHQ7Cj4gKwo+ICsJcDRkID0gc3RhZ2UyX3A0ZF9vZmZzZXQoa3Zt
LCBwZ2QsIGFkZHIpOwo+ICsJZG8gewo+ICsJCW5leHQgPSBzdGFnZTJfcDRkX2FkZHJfZW5kKGt2
bSwgYWRkciwgZW5kKTsKPiArCQlpZiAoIXN0YWdlMl9wNGRfbm9uZShrdm0sICpwNGQpKQo+ICsJ
CQlzdGFnZTJfd3BfcHVkcyhrdm0sIHA0ZCwgYWRkciwgbmV4dCk7Cj4gKwl9IHdoaWxlIChwNGQr
KywgYWRkciA9IG5leHQsIGFkZHIgIT0gZW5kKTsKPiArfQo+ICsKPiArLyoqCj4gICAqIHN0YWdl
Ml93cF9yYW5nZSgpIC0gd3JpdGUgcHJvdGVjdCBzdGFnZTIgbWVtb3J5IHJlZ2lvbiByYW5nZQo+
ICAgKiBAa3ZtOglUaGUgS1ZNIHBvaW50ZXIKPiAgICogQGFkZHI6CVN0YXJ0IGFkZHJlc3Mgb2Yg
cmFuZ2UKPiBAQCAtMTQ3NSw3ICsxNjIwLDcgQEAgc3RhdGljIHZvaWQgc3RhZ2UyX3dwX3Jhbmdl
KHN0cnVjdCBrdm0gKgo+ICAJCQlicmVhazsKPiAgCQluZXh0ID0gc3RhZ2UyX3BnZF9hZGRyX2Vu
ZChrdm0sIGFkZHIsIGVuZCk7Cj4gIAkJaWYgKHN0YWdlMl9wZ2RfcHJlc2VudChrdm0sICpwZ2Qp
KQo+IC0JCQlzdGFnZTJfd3BfcHVkcyhrdm0sIHBnZCwgYWRkciwgbmV4dCk7Cj4gKwkJCXN0YWdl
Ml93cF9wNGRzKGt2bSwgcGdkLCBhZGRyLCBuZXh0KTsKPiAgCX0gd2hpbGUgKHBnZCsrLCBhZGRy
ID0gbmV4dCwgYWRkciAhPSBlbmQpOwo+ICB9Cj4gIAo+IC0tLSBhL2FyY2gvYXJtNjQvbW0vZmF1
bHQuY35hcm02NC1hZGQtc3VwcG9ydC1mb3ItZm9sZGVkLXA0ZC1wYWdlLXRhYmxlcwo+ICsrKyBh
L2FyY2gvYXJtNjQvbW0vZmF1bHQuYwo+IEBAIC0xNDUsNiArMTQ1LDcgQEAgc3RhdGljIHZvaWQg
c2hvd19wdGUodW5zaWduZWQgbG9uZyBhZGRyKQo+ICAJcHJfYWxlcnQoIlslMDE2bHhdIHBnZD0l
MDE2bGx4IiwgYWRkciwgcGdkX3ZhbChwZ2QpKTsKPiAgCj4gIAlkbyB7Cj4gKwkJcDRkX3QgKnA0
ZHAsIHA0ZDsKPiAgCQlwdWRfdCAqcHVkcCwgcHVkOwo+ICAJCXBtZF90ICpwbWRwLCBwbWQ7Cj4g
IAkJcHRlX3QgKnB0ZXAsIHB0ZTsKPiBAQCAtMTUyLDcgKzE1MywxMyBAQCBzdGF0aWMgdm9pZCBz
aG93X3B0ZSh1bnNpZ25lZCBsb25nIGFkZHIpCj4gIAkJaWYgKHBnZF9ub25lKHBnZCkgfHwgcGdk
X2JhZChwZ2QpKQo+ICAJCQlicmVhazsKPiAgCj4gLQkJcHVkcCA9IHB1ZF9vZmZzZXQocGdkcCwg
YWRkcik7Cj4gKwkJcDRkcCA9IHA0ZF9vZmZzZXQocGdkcCwgYWRkcik7Cj4gKwkJcDRkID0gUkVB
RF9PTkNFKCpwNGRwKTsKPiArCQlwcl9jb250KCIsIHA0ZD0lMDE2bGx4IiwgcDRkX3ZhbChwNGQp
KTsKPiArCQlpZiAocDRkX25vbmUocDRkKSB8fCBwNGRfYmFkKHA0ZCkpCj4gKwkJCWJyZWFrOwo+
ICsKPiArCQlwdWRwID0gcHVkX29mZnNldChwNGRwLCBhZGRyKTsKPiAgCQlwdWQgPSBSRUFEX09O
Q0UoKnB1ZHApOwo+ICAJCXByX2NvbnQoIiwgcHVkPSUwMTZsbHgiLCBwdWRfdmFsKHB1ZCkpOwo+
ICAJCWlmIChwdWRfbm9uZShwdWQpIHx8IHB1ZF9iYWQocHVkKSkKPiAtLS0gYS9hcmNoL2FybTY0
L21tL2h1Z2V0bGJwYWdlLmN+YXJtNjQtYWRkLXN1cHBvcnQtZm9yLWZvbGRlZC1wNGQtcGFnZS10
YWJsZXMKPiArKysgYS9hcmNoL2FybTY0L21tL2h1Z2V0bGJwYWdlLmMKPiBAQCAtNjcsMTEgKzY3
LDEzIEBAIHN0YXRpYyBpbnQgZmluZF9udW1fY29udGlnKHN0cnVjdCBtbV9zdHIKPiAgCQkJICAg
cHRlX3QgKnB0ZXAsIHNpemVfdCAqcGdzaXplKQo+ICB7Cj4gIAlwZ2RfdCAqcGdkcCA9IHBnZF9v
ZmZzZXQobW0sIGFkZHIpOwo+ICsJcDRkX3QgKnA0ZHA7Cj4gIAlwdWRfdCAqcHVkcDsKPiAgCXBt
ZF90ICpwbWRwOwo+ICAKPiAgCSpwZ3NpemUgPSBQQUdFX1NJWkU7Cj4gLQlwdWRwID0gcHVkX29m
ZnNldChwZ2RwLCBhZGRyKTsKPiArCXA0ZHAgPSBwNGRfb2Zmc2V0KHBnZHAsIGFkZHIpOwo+ICsJ
cHVkcCA9IHB1ZF9vZmZzZXQocDRkcCwgYWRkcik7Cj4gIAlwbWRwID0gcG1kX29mZnNldChwdWRw
LCBhZGRyKTsKPiAgCWlmICgocHRlX3QgKilwbWRwID09IHB0ZXApIHsKPiAgCQkqcGdzaXplID0g
UE1EX1NJWkU7Cj4gQEAgLTIxNywxMiArMjE5LDE0IEBAIHB0ZV90ICpodWdlX3B0ZV9hbGxvYyhz
dHJ1Y3QgbW1fc3RydWN0ICoKPiAgCQkgICAgICB1bnNpZ25lZCBsb25nIGFkZHIsIHVuc2lnbmVk
IGxvbmcgc3opCj4gIHsKPiAgCXBnZF90ICpwZ2RwOwo+ICsJcDRkX3QgKnA0ZHA7Cj4gIAlwdWRf
dCAqcHVkcDsKPiAgCXBtZF90ICpwbWRwOwo+ICAJcHRlX3QgKnB0ZXAgPSBOVUxMOwo+ICAKPiAg
CXBnZHAgPSBwZ2Rfb2Zmc2V0KG1tLCBhZGRyKTsKPiAtCXB1ZHAgPSBwdWRfYWxsb2MobW0sIHBn
ZHAsIGFkZHIpOwo+ICsJcDRkcCA9IHA0ZF9vZmZzZXQocGdkcCwgYWRkcik7Cj4gKwlwdWRwID0g
cHVkX2FsbG9jKG1tLCBwNGRwLCBhZGRyKTsKPiAgCWlmICghcHVkcCkKPiAgCQlyZXR1cm4gTlVM
TDsKPiAgCj4gQEAgLTI2MSw2ICsyNjUsNyBAQCBwdGVfdCAqaHVnZV9wdGVfb2Zmc2V0KHN0cnVj
dCBtbV9zdHJ1Y3QKPiAgCQkgICAgICAgdW5zaWduZWQgbG9uZyBhZGRyLCB1bnNpZ25lZCBsb25n
IHN6KQo+ICB7Cj4gIAlwZ2RfdCAqcGdkcDsKPiArCXA0ZF90ICpwNGRwOwo+ICAJcHVkX3QgKnB1
ZHAsIHB1ZDsKPiAgCXBtZF90ICpwbWRwLCBwbWQ7Cj4gIAo+IEBAIC0yNjgsNyArMjczLDExIEBA
IHB0ZV90ICpodWdlX3B0ZV9vZmZzZXQoc3RydWN0IG1tX3N0cnVjdAo+ICAJaWYgKCFwZ2RfcHJl
c2VudChSRUFEX09OQ0UoKnBnZHApKSkKPiAgCQlyZXR1cm4gTlVMTDsKPiAgCj4gLQlwdWRwID0g
cHVkX29mZnNldChwZ2RwLCBhZGRyKTsKPiArCXA0ZHAgPSBwNGRfb2Zmc2V0KHBnZHAsIGFkZHIp
Owo+ICsJaWYgKCFwNGRfcHJlc2VudChSRUFEX09OQ0UoKnA0ZHApKSkKPiArCQlyZXR1cm4gTlVM
TDsKPiArCj4gKwlwdWRwID0gcHVkX29mZnNldChwNGRwLCBhZGRyKTsKPiAgCXB1ZCA9IFJFQURf
T05DRSgqcHVkcCk7Cj4gIAlpZiAoc3ogIT0gUFVEX1NJWkUgJiYgcHVkX25vbmUocHVkKSkKPiAg
CQlyZXR1cm4gTlVMTDsKPiAtLS0gYS9hcmNoL2FybTY0L21tL2thc2FuX2luaXQuY35hcm02NC1h
ZGQtc3VwcG9ydC1mb3ItZm9sZGVkLXA0ZC1wYWdlLXRhYmxlcwo+ICsrKyBhL2FyY2gvYXJtNjQv
bW0va2FzYW5faW5pdC5jCj4gQEAgLTg0LDE3ICs4NCwxNyBAQCBzdGF0aWMgcG1kX3QgKl9faW5p
dCBrYXNhbl9wbWRfb2Zmc2V0KHB1Cj4gIAlyZXR1cm4gZWFybHkgPyBwbWRfb2Zmc2V0X2tpbWco
cHVkcCwgYWRkcikgOiBwbWRfb2Zmc2V0KHB1ZHAsIGFkZHIpOwo+ICB9Cj4gIAo+IC1zdGF0aWMg
cHVkX3QgKl9faW5pdCBrYXNhbl9wdWRfb2Zmc2V0KHBnZF90ICpwZ2RwLCB1bnNpZ25lZCBsb25n
IGFkZHIsIGludCBub2RlLAo+ICtzdGF0aWMgcHVkX3QgKl9faW5pdCBrYXNhbl9wdWRfb2Zmc2V0
KHA0ZF90ICpwNGRwLCB1bnNpZ25lZCBsb25nIGFkZHIsIGludCBub2RlLAo+ICAJCQkJICAgICAg
Ym9vbCBlYXJseSkKPiAgewo+IC0JaWYgKHBnZF9ub25lKFJFQURfT05DRSgqcGdkcCkpKSB7Cj4g
KwlpZiAocDRkX25vbmUoUkVBRF9PTkNFKCpwNGRwKSkpIHsKPiAgCQlwaHlzX2FkZHJfdCBwdWRf
cGh5cyA9IGVhcmx5ID8KPiAgCQkJCV9fcGFfc3ltYm9sKGthc2FuX2Vhcmx5X3NoYWRvd19wdWQp
Cj4gIAkJCQkJOiBrYXNhbl9hbGxvY196ZXJvZWRfcGFnZShub2RlKTsKPiAtCQlfX3BnZF9wb3B1
bGF0ZShwZ2RwLCBwdWRfcGh5cywgUE1EX1RZUEVfVEFCTEUpOwo+ICsJCV9fcDRkX3BvcHVsYXRl
KHA0ZHAsIHB1ZF9waHlzLCBQTURfVFlQRV9UQUJMRSk7Cj4gIAl9Cj4gIAo+IC0JcmV0dXJuIGVh
cmx5ID8gcHVkX29mZnNldF9raW1nKHBnZHAsIGFkZHIpIDogcHVkX29mZnNldChwZ2RwLCBhZGRy
KTsKPiArCXJldHVybiBlYXJseSA/IHB1ZF9vZmZzZXRfa2ltZyhwNGRwLCBhZGRyKSA6IHB1ZF9v
ZmZzZXQocDRkcCwgYWRkcik7Cj4gIH0KPiAgCj4gIHN0YXRpYyB2b2lkIF9faW5pdCBrYXNhbl9w
dGVfcG9wdWxhdGUocG1kX3QgKnBtZHAsIHVuc2lnbmVkIGxvbmcgYWRkciwKPiBAQCAtMTI2LDEx
ICsxMjYsMTEgQEAgc3RhdGljIHZvaWQgX19pbml0IGthc2FuX3BtZF9wb3B1bGF0ZShwdQo+ICAJ
fSB3aGlsZSAocG1kcCsrLCBhZGRyID0gbmV4dCwgYWRkciAhPSBlbmQgJiYgcG1kX25vbmUoUkVB
RF9PTkNFKCpwbWRwKSkpOwo+ICB9Cj4gIAo+IC1zdGF0aWMgdm9pZCBfX2luaXQga2FzYW5fcHVk
X3BvcHVsYXRlKHBnZF90ICpwZ2RwLCB1bnNpZ25lZCBsb25nIGFkZHIsCj4gK3N0YXRpYyB2b2lk
IF9faW5pdCBrYXNhbl9wdWRfcG9wdWxhdGUocDRkX3QgKnA0ZHAsIHVuc2lnbmVkIGxvbmcgYWRk
ciwKPiAgCQkJCSAgICAgIHVuc2lnbmVkIGxvbmcgZW5kLCBpbnQgbm9kZSwgYm9vbCBlYXJseSkK
PiAgewo+ICAJdW5zaWduZWQgbG9uZyBuZXh0Owo+IC0JcHVkX3QgKnB1ZHAgPSBrYXNhbl9wdWRf
b2Zmc2V0KHBnZHAsIGFkZHIsIG5vZGUsIGVhcmx5KTsKPiArCXB1ZF90ICpwdWRwID0ga2FzYW5f
cHVkX29mZnNldChwNGRwLCBhZGRyLCBub2RlLCBlYXJseSk7Cj4gIAo+ICAJZG8gewo+ICAJCW5l
eHQgPSBwdWRfYWRkcl9lbmQoYWRkciwgZW5kKTsKPiBAQCAtMTM4LDYgKzEzOCwxOCBAQCBzdGF0
aWMgdm9pZCBfX2luaXQga2FzYW5fcHVkX3BvcHVsYXRlKHBnCj4gIAl9IHdoaWxlIChwdWRwKyss
IGFkZHIgPSBuZXh0LCBhZGRyICE9IGVuZCAmJiBwdWRfbm9uZShSRUFEX09OQ0UoKnB1ZHApKSk7
Cj4gIH0KPiAgCj4gK3N0YXRpYyB2b2lkIF9faW5pdCBrYXNhbl9wNGRfcG9wdWxhdGUocGdkX3Qg
KnBnZHAsIHVuc2lnbmVkIGxvbmcgYWRkciwKPiArCQkJCSAgICAgIHVuc2lnbmVkIGxvbmcgZW5k
LCBpbnQgbm9kZSwgYm9vbCBlYXJseSkKPiArewo+ICsJdW5zaWduZWQgbG9uZyBuZXh0Owo+ICsJ
cDRkX3QgKnA0ZHAgPSBwNGRfb2Zmc2V0KHBnZHAsIGFkZHIpOwo+ICsKPiArCWRvIHsKPiArCQlu
ZXh0ID0gcDRkX2FkZHJfZW5kKGFkZHIsIGVuZCk7Cj4gKwkJa2FzYW5fcHVkX3BvcHVsYXRlKHA0
ZHAsIGFkZHIsIG5leHQsIG5vZGUsIGVhcmx5KTsKPiArCX0gd2hpbGUgKHA0ZHArKywgYWRkciA9
IG5leHQsIGFkZHIgIT0gZW5kKTsKPiArfQo+ICsKPiAgc3RhdGljIHZvaWQgX19pbml0IGthc2Fu
X3BnZF9wb3B1bGF0ZSh1bnNpZ25lZCBsb25nIGFkZHIsIHVuc2lnbmVkIGxvbmcgZW5kLAo+ICAJ
CQkJICAgICAgaW50IG5vZGUsIGJvb2wgZWFybHkpCj4gIHsKPiBAQCAtMTQ3LDcgKzE1OSw3IEBA
IHN0YXRpYyB2b2lkIF9faW5pdCBrYXNhbl9wZ2RfcG9wdWxhdGUodW4KPiAgCXBnZHAgPSBwZ2Rf
b2Zmc2V0X2soYWRkcik7Cj4gIAlkbyB7Cj4gIAkJbmV4dCA9IHBnZF9hZGRyX2VuZChhZGRyLCBl
bmQpOwo+IC0JCWthc2FuX3B1ZF9wb3B1bGF0ZShwZ2RwLCBhZGRyLCBuZXh0LCBub2RlLCBlYXJs
eSk7Cj4gKwkJa2FzYW5fcDRkX3BvcHVsYXRlKHBnZHAsIGFkZHIsIG5leHQsIG5vZGUsIGVhcmx5
KTsKPiAgCX0gd2hpbGUgKHBnZHArKywgYWRkciA9IG5leHQsIGFkZHIgIT0gZW5kKTsKPiAgfQo+
ICAKPiAtLS0gYS9hcmNoL2FybTY0L21tL21tdS5jfmFybTY0LWFkZC1zdXBwb3J0LWZvci1mb2xk
ZWQtcDRkLXBhZ2UtdGFibGVzCj4gKysrIGEvYXJjaC9hcm02NC9tbS9tbXUuYwo+IEBAIC0yOTAs
MTggKzI5MCwxOSBAQCBzdGF0aWMgdm9pZCBhbGxvY19pbml0X3B1ZChwZ2RfdCAqcGdkcCwKPiAg
ewo+ICAJdW5zaWduZWQgbG9uZyBuZXh0Owo+ICAJcHVkX3QgKnB1ZHA7Cj4gLQlwZ2RfdCBwZ2Qg
PSBSRUFEX09OQ0UoKnBnZHApOwo+ICsJcDRkX3QgKnA0ZHAgPSBwNGRfb2Zmc2V0KHBnZHAsIGFk
ZHIpOwo+ICsJcDRkX3QgcDRkID0gUkVBRF9PTkNFKCpwNGRwKTsKPiAgCj4gLQlpZiAocGdkX25v
bmUocGdkKSkgewo+ICsJaWYgKHA0ZF9ub25lKHA0ZCkpIHsKPiAgCQlwaHlzX2FkZHJfdCBwdWRf
cGh5czsKPiAgCQlCVUdfT04oIXBndGFibGVfYWxsb2MpOwo+ICAJCXB1ZF9waHlzID0gcGd0YWJs
ZV9hbGxvYyhQVURfU0hJRlQpOwo+IC0JCV9fcGdkX3BvcHVsYXRlKHBnZHAsIHB1ZF9waHlzLCBQ
VURfVFlQRV9UQUJMRSk7Cj4gLQkJcGdkID0gUkVBRF9PTkNFKCpwZ2RwKTsKPiArCQlfX3A0ZF9w
b3B1bGF0ZShwNGRwLCBwdWRfcGh5cywgUFVEX1RZUEVfVEFCTEUpOwo+ICsJCXA0ZCA9IFJFQURf
T05DRSgqcDRkcCk7Cj4gIAl9Cj4gLQlCVUdfT04ocGdkX2JhZChwZ2QpKTsKPiArCUJVR19PTihw
NGRfYmFkKHA0ZCkpOwo+ICAKPiAtCXB1ZHAgPSBwdWRfc2V0X2ZpeG1hcF9vZmZzZXQocGdkcCwg
YWRkcik7Cj4gKwlwdWRwID0gcHVkX3NldF9maXhtYXBfb2Zmc2V0KHA0ZHAsIGFkZHIpOwo+ICAJ
ZG8gewo+ICAJCXB1ZF90IG9sZF9wdWQgPSBSRUFEX09OQ0UoKnB1ZHApOwo+ICAKPiBAQCAtNjcy
LDYgKzY3Myw3IEBAIHN0YXRpYyB2b2lkIF9faW5pdCBtYXBfa2VybmVsKHBnZF90ICpwZ2QKPiAg
CQkJUkVBRF9PTkNFKCpwZ2Rfb2Zmc2V0X2soRklYQUREUl9TVEFSVCkpKTsKPiAgCX0gZWxzZSBp
ZiAoQ09ORklHX1BHVEFCTEVfTEVWRUxTID4gMykgewo+ICAJCXBnZF90ICpibV9wZ2RwOwo+ICsJ
CXA0ZF90ICpibV9wNGRwOwo+ICAJCXB1ZF90ICpibV9wdWRwOwo+ICAJCS8qCj4gIAkJICogVGhl
IGZpeG1hcCBzaGFyZXMgaXRzIHRvcCBsZXZlbCBwZ2QgZW50cnkgd2l0aCB0aGUga2VybmVsCj4g
QEAgLTY4MSw3ICs2ODMsOCBAQCBzdGF0aWMgdm9pZCBfX2luaXQgbWFwX2tlcm5lbChwZ2RfdCAq
cGdkCj4gIAkJICovCj4gIAkJQlVHX09OKCFJU19FTkFCTEVEKENPTkZJR19BUk02NF8xNktfUEFH
RVMpKTsKPiAgCQlibV9wZ2RwID0gcGdkX29mZnNldF9yYXcocGdkcCwgRklYQUREUl9TVEFSVCk7
Cj4gLQkJYm1fcHVkcCA9IHB1ZF9zZXRfZml4bWFwX29mZnNldChibV9wZ2RwLCBGSVhBRERSX1NU
QVJUKTsKPiArCQlibV9wNGRwID0gcDRkX29mZnNldChibV9wZ2RwLCBGSVhBRERSX1NUQVJUKTsK
PiArCQlibV9wdWRwID0gcHVkX3NldF9maXhtYXBfb2Zmc2V0KGJtX3A0ZHAsIEZJWEFERFJfU1RB
UlQpOwo+ICAJCXB1ZF9wb3B1bGF0ZSgmaW5pdF9tbSwgYm1fcHVkcCwgbG1fYWxpYXMoYm1fcG1k
KSk7Cj4gIAkJcHVkX2NsZWFyX2ZpeG1hcCgpOwo+ICAJfSBlbHNlIHsKPiBAQCAtNzE1LDYgKzcx
OCw3IEBAIHZvaWQgX19pbml0IHBhZ2luZ19pbml0KHZvaWQpCj4gIGludCBrZXJuX2FkZHJfdmFs
aWQodW5zaWduZWQgbG9uZyBhZGRyKQo+ICB7Cj4gIAlwZ2RfdCAqcGdkcDsKPiArCXA0ZF90ICpw
NGRwOwo+ICAJcHVkX3QgKnB1ZHAsIHB1ZDsKPiAgCXBtZF90ICpwbWRwLCBwbWQ7Cj4gIAlwdGVf
dCAqcHRlcCwgcHRlOwo+IEBAIC03MjYsNyArNzMwLDExIEBAIGludCBrZXJuX2FkZHJfdmFsaWQo
dW5zaWduZWQgbG9uZyBhZGRyKQo+ICAJaWYgKHBnZF9ub25lKFJFQURfT05DRSgqcGdkcCkpKQo+
ICAJCXJldHVybiAwOwo+ICAKPiAtCXB1ZHAgPSBwdWRfb2Zmc2V0KHBnZHAsIGFkZHIpOwo+ICsJ
cDRkcCA9IHA0ZF9vZmZzZXQocGdkcCwgYWRkcik7Cj4gKwlpZiAocDRkX25vbmUoUkVBRF9PTkNF
KCpwNGRwKSkpCj4gKwkJcmV0dXJuIDA7Cj4gKwo+ICsJcHVkcCA9IHB1ZF9vZmZzZXQocDRkcCwg
YWRkcik7Cj4gIAlwdWQgPSBSRUFEX09OQ0UoKnB1ZHApOwo+ICAJaWYgKHB1ZF9ub25lKHB1ZCkp
Cj4gIAkJcmV0dXJuIDA7Cj4gQEAgLTEwNjksNiArMTA3Nyw3IEBAIGludCBfX21lbWluaXQgdm1l
bW1hcF9wb3B1bGF0ZSh1bnNpZ25lZAo+ICAJdW5zaWduZWQgbG9uZyBhZGRyID0gc3RhcnQ7Cj4g
IAl1bnNpZ25lZCBsb25nIG5leHQ7Cj4gIAlwZ2RfdCAqcGdkcDsKPiArCXA0ZF90ICpwNGRwOwo+
ICAJcHVkX3QgKnB1ZHA7Cj4gIAlwbWRfdCAqcG1kcDsKPiAgCj4gQEAgLTEwNzksNyArMTA4OCwx
MSBAQCBpbnQgX19tZW1pbml0IHZtZW1tYXBfcG9wdWxhdGUodW5zaWduZWQKPiAgCQlpZiAoIXBn
ZHApCj4gIAkJCXJldHVybiAtRU5PTUVNOwo+ICAKPiAtCQlwdWRwID0gdm1lbW1hcF9wdWRfcG9w
dWxhdGUocGdkcCwgYWRkciwgbm9kZSk7Cj4gKwkJcDRkcCA9IHZtZW1tYXBfcDRkX3BvcHVsYXRl
KHBnZHAsIGFkZHIsIG5vZGUpOwo+ICsJCWlmICghcDRkcCkKPiArCQkJcmV0dXJuIC1FTk9NRU07
Cj4gKwo+ICsJCXB1ZHAgPSB2bWVtbWFwX3B1ZF9wb3B1bGF0ZShwNGRwLCBhZGRyLCBub2RlKTsK
PiAgCQlpZiAoIXB1ZHApCj4gIAkJCXJldHVybiAtRU5PTUVNOwo+ICAKPiBAQCAtMTExNCwxMSAr
MTEyNywxMiBAQCB2b2lkIHZtZW1tYXBfZnJlZSh1bnNpZ25lZCBsb25nIHN0YXJ0LCB1Cj4gIHN0
YXRpYyBpbmxpbmUgcHVkX3QgKiBmaXhtYXBfcHVkKHVuc2lnbmVkIGxvbmcgYWRkcikKPiAgewo+
ICAJcGdkX3QgKnBnZHAgPSBwZ2Rfb2Zmc2V0X2soYWRkcik7Cj4gLQlwZ2RfdCBwZ2QgPSBSRUFE
X09OQ0UoKnBnZHApOwo+ICsJcDRkX3QgKnA0ZHAgPSBwNGRfb2Zmc2V0KHBnZHAsIGFkZHIpOwo+
ICsJcDRkX3QgcDRkID0gUkVBRF9PTkNFKCpwNGRwKTsKPiAgCj4gLQlCVUdfT04ocGdkX25vbmUo
cGdkKSB8fCBwZ2RfYmFkKHBnZCkpOwo+ICsJQlVHX09OKHA0ZF9ub25lKHA0ZCkgfHwgcDRkX2Jh
ZChwNGQpKTsKPiAgCj4gLQlyZXR1cm4gcHVkX29mZnNldF9raW1nKHBnZHAsIGFkZHIpOwo+ICsJ
cmV0dXJuIHB1ZF9vZmZzZXRfa2ltZyhwNGRwLCBhZGRyKTsKPiAgfQo+ICAKPiAgc3RhdGljIGlu
bGluZSBwbWRfdCAqIGZpeG1hcF9wbWQodW5zaWduZWQgbG9uZyBhZGRyKQo+IEBAIC0xMTQ0LDI1
ICsxMTU4LDI3IEBAIHN0YXRpYyBpbmxpbmUgcHRlX3QgKiBmaXhtYXBfcHRlKHVuc2lnbmUKPiAg
ICovCj4gIHZvaWQgX19pbml0IGVhcmx5X2ZpeG1hcF9pbml0KHZvaWQpCj4gIHsKPiAtCXBnZF90
ICpwZ2RwLCBwZ2Q7Cj4gKwlwZ2RfdCAqcGdkcDsKPiArCXA0ZF90ICpwNGRwLCBwNGQ7Cj4gIAlw
dWRfdCAqcHVkcDsKPiAgCXBtZF90ICpwbWRwOwo+ICAJdW5zaWduZWQgbG9uZyBhZGRyID0gRklY
QUREUl9TVEFSVDsKPiAgCj4gIAlwZ2RwID0gcGdkX29mZnNldF9rKGFkZHIpOwo+IC0JcGdkID0g
UkVBRF9PTkNFKCpwZ2RwKTsKPiArCXA0ZHAgPSBwNGRfb2Zmc2V0KHBnZHAsIGFkZHIpOwo+ICsJ
cDRkID0gUkVBRF9PTkNFKCpwNGRwKTsKPiAgCWlmIChDT05GSUdfUEdUQUJMRV9MRVZFTFMgPiAz
ICYmCj4gLQkgICAgIShwZ2Rfbm9uZShwZ2QpIHx8IHBnZF9wYWdlX3BhZGRyKHBnZCkgPT0gX19w
YV9zeW1ib2woYm1fcHVkKSkpIHsKPiArCSAgICAhKHA0ZF9ub25lKHA0ZCkgfHwgcDRkX3BhZ2Vf
cGFkZHIocDRkKSA9PSBfX3BhX3N5bWJvbChibV9wdWQpKSkgewo+ICAJCS8qCj4gIAkJICogV2Ug
b25seSBlbmQgdXAgaGVyZSBpZiB0aGUga2VybmVsIG1hcHBpbmcgYW5kIHRoZSBmaXhtYXAKPiAg
CQkgKiBzaGFyZSB0aGUgdG9wIGxldmVsIHBnZCBlbnRyeSwgd2hpY2ggc2hvdWxkIG9ubHkgaGFw
cGVuIG9uCj4gIAkJICogMTZrLzQgbGV2ZWxzIGNvbmZpZ3VyYXRpb25zLgo+ICAJCSAqLwo+ICAJ
CUJVR19PTighSVNfRU5BQkxFRChDT05GSUdfQVJNNjRfMTZLX1BBR0VTKSk7Cj4gLQkJcHVkcCA9
IHB1ZF9vZmZzZXRfa2ltZyhwZ2RwLCBhZGRyKTsKPiArCQlwdWRwID0gcHVkX29mZnNldF9raW1n
KHA0ZHAsIGFkZHIpOwo+ICAJfSBlbHNlIHsKPiAtCQlpZiAocGdkX25vbmUocGdkKSkKPiAtCQkJ
X19wZ2RfcG9wdWxhdGUocGdkcCwgX19wYV9zeW1ib2woYm1fcHVkKSwgUFVEX1RZUEVfVEFCTEUp
Owo+ICsJCWlmIChwNGRfbm9uZShwNGQpKQo+ICsJCQlfX3A0ZF9wb3B1bGF0ZShwNGRwLCBfX3Bh
X3N5bWJvbChibV9wdWQpLCBQVURfVFlQRV9UQUJMRSk7Cj4gIAkJcHVkcCA9IGZpeG1hcF9wdWQo
YWRkcik7Cj4gIAl9Cj4gIAlpZiAocHVkX25vbmUoUkVBRF9PTkNFKCpwdWRwKSkpCj4gLS0tIGEv
YXJjaC9hcm02NC9tbS9wYWdlYXR0ci5jfmFybTY0LWFkZC1zdXBwb3J0LWZvci1mb2xkZWQtcDRk
LXBhZ2UtdGFibGVzCj4gKysrIGEvYXJjaC9hcm02NC9tbS9wYWdlYXR0ci5jCj4gQEAgLTE5OCw2
ICsxOTgsNyBAQCB2b2lkIF9fa2VybmVsX21hcF9wYWdlcyhzdHJ1Y3QgcGFnZSAqcGFnCj4gIGJv
b2wga2VybmVsX3BhZ2VfcHJlc2VudChzdHJ1Y3QgcGFnZSAqcGFnZSkKPiAgewo+ICAJcGdkX3Qg
KnBnZHA7Cj4gKwlwNGRfdCAqcDRkcDsKPiAgCXB1ZF90ICpwdWRwLCBwdWQ7Cj4gIAlwbWRfdCAq
cG1kcCwgcG1kOwo+ICAJcHRlX3QgKnB0ZXA7Cj4gQEAgLTIxMCw3ICsyMTEsMTEgQEAgYm9vbCBr
ZXJuZWxfcGFnZV9wcmVzZW50KHN0cnVjdCBwYWdlICpwYQo+ICAJaWYgKHBnZF9ub25lKFJFQURf
T05DRSgqcGdkcCkpKQo+ICAJCXJldHVybiBmYWxzZTsKPiAgCj4gLQlwdWRwID0gcHVkX29mZnNl
dChwZ2RwLCBhZGRyKTsKPiArCXA0ZHAgPSBwNGRfb2Zmc2V0KHBnZHAsIGFkZHIpOwo+ICsJaWYg
KHA0ZF9ub25lKFJFQURfT05DRSgqcDRkcCkpKQo+ICsJCXJldHVybiBmYWxzZTsKPiArCj4gKwlw
dWRwID0gcHVkX29mZnNldChwNGRwLCBhZGRyKTsKPiAgCXB1ZCA9IFJFQURfT05DRSgqcHVkcCk7
Cj4gIAlpZiAocHVkX25vbmUocHVkKSkKPiAgCQlyZXR1cm4gZmFsc2U7Cj4gXwo+IAoKLS0gClNp
bmNlcmVseSB5b3VycywKTWlrZS4KX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX18KT3BlblJJU0MgbWFpbGluZyBsaXN0Ck9wZW5SSVNDQGxpc3RzLmxpYnJlY29y
ZXMub3JnCmh0dHBzOi8vbGlzdHMubGlicmVjb3Jlcy5vcmcvbGlzdGluZm8vb3BlbnJpc2MK
