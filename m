Return-Path: <openrisc-bounces@lists.librecores.org>
X-Original-To: lists+openrisc@lfdr.de
Delivered-To: lists+openrisc@lfdr.de
Received: from mail.librecores.org (lists.librecores.org [88.198.125.70])
	by mail.lfdr.de (Postfix) with ESMTP id 62794501DFD
	for <lists+openrisc@lfdr.de>; Fri, 15 Apr 2022 00:05:27 +0200 (CEST)
Received: from [172.31.1.100] (localhost.localdomain [127.0.0.1])
	by mail.librecores.org (Postfix) with ESMTP id 4321A248CC;
	Fri, 15 Apr 2022 00:05:27 +0200 (CEST)
Received: from mail-pl1-f172.google.com (mail-pl1-f172.google.com
 [209.85.214.172])
 by mail.librecores.org (Postfix) with ESMTPS id C25BF24863
 for <openrisc@lists.librecores.org>; Fri, 15 Apr 2022 00:05:24 +0200 (CEST)
Received: by mail-pl1-f172.google.com with SMTP id s14so5805802plk.8
 for <openrisc@lists.librecores.org>; Thu, 14 Apr 2022 15:05:24 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=rivosinc-com.20210112.gappssmtp.com; s=20210112;
 h=subject:date:message-id:in-reply-to:references:mime-version
 :content-transfer-encoding:cc:from:to;
 bh=uLn9nEAVfqfhF99bZmCoDyMs8/O9emD7jJiMXxYFAyY=;
 b=aCpk+hiR1i6NQteJMGoSFJLdn5Rgm8st+ic8YTNlQHLfaUlgHtMcfuGAfhQl3K+6g4
 UmI+PZBc6djUKQNDbQ28uCRN+kmDtOXIVTEKtwMumAnydxR3HnsqPH3DA0sbMlbQAwrU
 jpy7qcIA5R2RjbhZPPRb0MbiE3lAy7OS3Iwj1cDXaC4TvcQoItO9lj4SSCoUz8N2T03c
 am9CxRoIA8kWRn5kdkC7F60d0pSGRFKNubmWK4iNXouTAsvDUaX7fSzOK0gKgvqKwaub
 Qi9xqMYtyCJ43ckr4k2sI2wGmYCS0qBvDvWN1moO+kJfRhoTr4apwv5ff6foANjKKm0d
 vijA==
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20210112;
 h=x-gm-message-state:subject:date:message-id:in-reply-to:references
 :mime-version:content-transfer-encoding:cc:from:to;
 bh=uLn9nEAVfqfhF99bZmCoDyMs8/O9emD7jJiMXxYFAyY=;
 b=5wGJvyV2bliKrfiYDDlcpQ1H6GhB/W5JcE7aobB/qhaw7Lbs1KeXXCAenbVU1FDfoN
 qb51Q+pW8waOHW9OT4DRvPPfVBVX670XqFPzJq239GVljLlvXWAk38r+2djuXfVK8h0D
 w44CoEJmAu1yuHjtBUx068b5D5iK+dZcSv3I4P8waIyvC3mZbOyjlScv+oUdlDZFFL4A
 hxoPG7Y0jYCkXCiEszK5C6U/mSzzYPj+wbltgBUr4sZFFLUIJ6KJIBVXfTplUNBPsGdH
 8LS/3cLNWWcWZJSIworGnbBovjKYm1rBTW1SO5R547Y+814EGLnmw7RQkwmw39SxNdwg
 iygA==
X-Gm-Message-State: AOAM533bDHs3I3YOzlvkOGam2741wzNDkqnaf1ZbG8lLonIQhpJVYzAo
 n+ZDFy3Qo9DY6plgjvhJB0uMFxc7j8JRbiMC
X-Google-Smtp-Source: ABdhPJzhfrbMDiR890Mvpaf1KfA0KcEG1o/qsHftMGK/3W28SItjuhSFgVLfw1qtTLZgABu0T8DOAQ==
X-Received: by 2002:a17:90a:a78f:b0:1bc:8042:9330 with SMTP id
 f15-20020a17090aa78f00b001bc80429330mr685887pjq.229.1649973923305; 
 Thu, 14 Apr 2022 15:05:23 -0700 (PDT)
Received: from localhost ([12.3.194.138]) by smtp.gmail.com with ESMTPSA id
 r8-20020a17090a0ac800b001c9e35d3a3asm2852568pje.24.2022.04.14.15.05.22
 (version=TLS1_3 cipher=TLS_AES_256_GCM_SHA384 bits=256/256);
 Thu, 14 Apr 2022 15:05:22 -0700 (PDT)
Date: Thu, 14 Apr 2022 15:02:14 -0700
Message-Id: <20220414220214.24556-8-palmer@rivosinc.com>
X-Mailer: git-send-email 2.34.1
In-Reply-To: <20220414220214.24556-1-palmer@rivosinc.com>
References: <20220414220214.24556-1-palmer@rivosinc.com>
MIME-Version: 1.0
From: Palmer Dabbelt <palmer@rivosinc.com>
To: Arnd Bergmann <arnd@arndb.de>, heiko@sntech.de, guoren@kernel.org,
 shorne@gmail.com
Subject: [OpenRISC] [PATCH v3 7/7] csky: Move to generic ticket-spinlock
X-BeenThere: openrisc@lists.librecores.org
X-Mailman-Version: 2.1.26
Precedence: list
List-Id: Discussion around the OpenRISC processor
 <openrisc.lists.librecores.org>
List-Unsubscribe: <https://lists.librecores.org/options/openrisc>,
 <mailto:openrisc-request@lists.librecores.org?subject=unsubscribe>
List-Archive: <http://lists.librecores.org/pipermail/openrisc/>
List-Post: <mailto:openrisc@lists.librecores.org>
List-Help: <mailto:openrisc-request@lists.librecores.org?subject=help>
List-Subscribe: <https://lists.librecores.org/listinfo/openrisc>,
 <mailto:openrisc-request@lists.librecores.org?subject=subscribe>
Cc: wangkefeng.wang@huawei.com, Guo Ren <guoren@linux.alibaba.com>,
 peterz@infradead.org, Palmer Dabbelt <palmer@rivosinc.com>, jszhang@kernel.org,
 linux-riscv@lists.infradead.org, Will Deacon <will@kernel.org>,
 jonas@southpole.se, linux-csky@vger.kernel.org, mingo@redhat.com,
 longman@redhat.com, linux-arch@vger.kernel.org, aou@eecs.berkeley.edu,
 Arnd Bergmann <arnd@arndb.de>, boqun.feng@gmail.com,
 openrisc@lists.librecores.org, Paul Walmsley <paul.walmsley@sifive.com>,
 Greg KH <gregkh@linuxfoundation.org>, linux-kernel@vger.kernel.org,
 Palmer Dabbelt <palmer@dabbelt.com>, sudipm.mukherjee@gmail.com,
 macro@orcam.me.uk
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: openrisc-bounces@lists.librecores.org
Sender: "OpenRISC" <openrisc-bounces@lists.librecores.org>

RnJvbTogR3VvIFJlbiA8Z3VvcmVuQGxpbnV4LmFsaWJhYmEuY29tPgoKVGhlcmUgaXMgbm8gYmVu
ZWZpdCBmcm9tIGN1c3RvbSBpbXBsZW1lbnRhdGlvbiBmb3IgdGlja2V0LXNwaW5sb2NrLApzbyBt
b3ZlIHRvIGdlbmVyaWMgdGlja2V0LXNwaW5sb2NrIGZvciBlYXN5IG1haW50ZW5hbmNlLgoKU2ln
bmVkLW9mZi1ieTogR3VvIFJlbiA8Z3VvcmVuQGxpbnV4LmFsaWJhYmEuY29tPgpTaWduZWQtb2Zm
LWJ5OiBQYWxtZXIgRGFiYmVsdCA8cGFsbWVyQHJpdm9zaW5jLmNvbT4KLS0tCiBhcmNoL2Nza3kv
aW5jbHVkZS9hc20vS2J1aWxkICAgICAgICAgICB8ICAzICsKIGFyY2gvY3NreS9pbmNsdWRlL2Fz
bS9zcGlubG9jay5oICAgICAgIHwgODkgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KIGFyY2gv
Y3NreS9pbmNsdWRlL2FzbS9zcGlubG9ja190eXBlcy5oIHwgMjcgLS0tLS0tLS0KIDMgZmlsZXMg
Y2hhbmdlZCwgMyBpbnNlcnRpb25zKCspLCAxMTYgZGVsZXRpb25zKC0pCiBkZWxldGUgbW9kZSAx
MDA2NDQgYXJjaC9jc2t5L2luY2x1ZGUvYXNtL3NwaW5sb2NrLmgKIGRlbGV0ZSBtb2RlIDEwMDY0
NCBhcmNoL2Nza3kvaW5jbHVkZS9hc20vc3BpbmxvY2tfdHlwZXMuaAoKZGlmZiAtLWdpdCBhL2Fy
Y2gvY3NreS9pbmNsdWRlL2FzbS9LYnVpbGQgYi9hcmNoL2Nza3kvaW5jbHVkZS9hc20vS2J1aWxk
CmluZGV4IDg4ODI0ODIzNWMyMy4uMTAzMjA3YTU4Zjk3IDEwMDY0NAotLS0gYS9hcmNoL2Nza3kv
aW5jbHVkZS9hc20vS2J1aWxkCisrKyBiL2FyY2gvY3NreS9pbmNsdWRlL2FzbS9LYnVpbGQKQEAg
LTMsNyArMywxMCBAQCBnZW5lcmljLXkgKz0gYXNtLW9mZnNldHMuaAogZ2VuZXJpYy15ICs9IGV4
dGFibGUuaAogZ2VuZXJpYy15ICs9IGdwaW8uaAogZ2VuZXJpYy15ICs9IGt2bV9wYXJhLmgKK2dl
bmVyaWMteSArPSBzcGlubG9jay5oCitnZW5lcmljLXkgKz0gc3BpbmxvY2tfdHlwZXMuaAogZ2Vu
ZXJpYy15ICs9IHFyd2xvY2suaAorZ2VuZXJpYy15ICs9IHFyd2xvY2tfdHlwZXMuaAogZ2VuZXJp
Yy15ICs9IHBhcnBvcnQuaAogZ2VuZXJpYy15ICs9IHVzZXIuaAogZ2VuZXJpYy15ICs9IHZtbGlu
dXgubGRzLmgKZGlmZiAtLWdpdCBhL2FyY2gvY3NreS9pbmNsdWRlL2FzbS9zcGlubG9jay5oIGIv
YXJjaC9jc2t5L2luY2x1ZGUvYXNtL3NwaW5sb2NrLmgKZGVsZXRlZCBmaWxlIG1vZGUgMTAwNjQ0
CmluZGV4IDY5ZjVhYTI0OWM1Zi4uMDAwMDAwMDAwMDAwCi0tLSBhL2FyY2gvY3NreS9pbmNsdWRl
L2FzbS9zcGlubG9jay5oCisrKyAvZGV2L251bGwKQEAgLTEsODkgKzAsMCBAQAotLyogU1BEWC1M
aWNlbnNlLUlkZW50aWZpZXI6IEdQTC0yLjAgKi8KLQotI2lmbmRlZiBfX0FTTV9DU0tZX1NQSU5M
T0NLX0gKLSNkZWZpbmUgX19BU01fQ1NLWV9TUElOTE9DS19ICi0KLSNpbmNsdWRlIDxsaW51eC9z
cGlubG9ja190eXBlcy5oPgotI2luY2x1ZGUgPGFzbS9iYXJyaWVyLmg+Ci0KLS8qCi0gKiBUaWNr
ZXQtYmFzZWQgc3Bpbi1sb2NraW5nLgotICovCi1zdGF0aWMgaW5saW5lIHZvaWQgYXJjaF9zcGlu
X2xvY2soYXJjaF9zcGlubG9ja190ICpsb2NrKQotewotCWFyY2hfc3BpbmxvY2tfdCBsb2NrdmFs
OwotCXUzMiB0aWNrZXRfbmV4dCA9IDEgPDwgVElDS0VUX05FWFQ7Ci0JdTMyICpwID0gJmxvY2st
PmxvY2s7Ci0JdTMyIHRtcDsKLQotCWFzbSB2b2xhdGlsZSAoCi0JCSIxOglsZGV4LncJCSUwLCAo
JTIpIFxuIgotCQkiCW1vdgkJJTEsICUwCSBcbiIKLQkJIglhZGQJCSUwLCAlMwkgXG4iCi0JCSIJ
c3RleC53CQklMCwgKCUyKSBcbiIKLQkJIgliZXoJCSUwLCAxYiAgIFxuIgotCQk6ICI9JnIiICh0
bXApLCAiPSZyIiAobG9ja3ZhbCkKLQkJOiAiciIocCksICJyIih0aWNrZXRfbmV4dCkKLQkJOiAi
Y2MiKTsKLQotCXdoaWxlIChsb2NrdmFsLnRpY2tldHMubmV4dCAhPSBsb2NrdmFsLnRpY2tldHMu
b3duZXIpCi0JCWxvY2t2YWwudGlja2V0cy5vd25lciA9IFJFQURfT05DRShsb2NrLT50aWNrZXRz
Lm93bmVyKTsKLQotCXNtcF9tYigpOwotfQotCi1zdGF0aWMgaW5saW5lIGludCBhcmNoX3NwaW5f
dHJ5bG9jayhhcmNoX3NwaW5sb2NrX3QgKmxvY2spCi17Ci0JdTMyIHRtcCwgY29udGVuZGVkLCBy
ZXM7Ci0JdTMyIHRpY2tldF9uZXh0ID0gMSA8PCBUSUNLRVRfTkVYVDsKLQl1MzIgKnAgPSAmbG9j
ay0+bG9jazsKLQotCWRvIHsKLQkJYXNtIHZvbGF0aWxlICgKLQkJIglsZGV4LncJCSUwLCAoJTMp
ICAgXG4iCi0JCSIJbW92aQkJJTIsIDEJICAgXG4iCi0JCSIJcm90bGkJCSUxLCAlMCwgMTYgXG4i
Ci0JCSIJY21wbmUJCSUxLCAlMCAgICAgXG4iCi0JCSIJYnQJCTFmICAgICAgICAgXG4iCi0JCSIJ
bW92aQkJJTIsIDAJICAgXG4iCi0JCSIJYWRkCQklMCwgJTAsICU0IFxuIgotCQkiCXN0ZXgudwkJ
JTAsICglMykgICBcbiIKLQkJIjE6CQkJCSAgIFxuIgotCQk6ICI9JnIiIChyZXMpLCAiPSZyIiAo
dG1wKSwgIj0mciIgKGNvbnRlbmRlZCkKLQkJOiAiciIocCksICJyIih0aWNrZXRfbmV4dCkKLQkJ
OiAiY2MiKTsKLQl9IHdoaWxlICghcmVzKTsKLQotCWlmICghY29udGVuZGVkKQotCQlzbXBfbWIo
KTsKLQotCXJldHVybiAhY29udGVuZGVkOwotfQotCi1zdGF0aWMgaW5saW5lIHZvaWQgYXJjaF9z
cGluX3VubG9jayhhcmNoX3NwaW5sb2NrX3QgKmxvY2spCi17Ci0Jc21wX21iKCk7Ci0JV1JJVEVf
T05DRShsb2NrLT50aWNrZXRzLm93bmVyLCBsb2NrLT50aWNrZXRzLm93bmVyICsgMSk7Ci19Ci0K
LXN0YXRpYyBpbmxpbmUgaW50IGFyY2hfc3Bpbl92YWx1ZV91bmxvY2tlZChhcmNoX3NwaW5sb2Nr
X3QgbG9jaykKLXsKLQlyZXR1cm4gbG9jay50aWNrZXRzLm93bmVyID09IGxvY2sudGlja2V0cy5u
ZXh0OwotfQotCi1zdGF0aWMgaW5saW5lIGludCBhcmNoX3NwaW5faXNfbG9ja2VkKGFyY2hfc3Bp
bmxvY2tfdCAqbG9jaykKLXsKLQlyZXR1cm4gIWFyY2hfc3Bpbl92YWx1ZV91bmxvY2tlZChSRUFE
X09OQ0UoKmxvY2spKTsKLX0KLQotc3RhdGljIGlubGluZSBpbnQgYXJjaF9zcGluX2lzX2NvbnRl
bmRlZChhcmNoX3NwaW5sb2NrX3QgKmxvY2spCi17Ci0Jc3RydWN0IF9fcmF3X3RpY2tldHMgdGlj
a2V0cyA9IFJFQURfT05DRShsb2NrLT50aWNrZXRzKTsKLQotCXJldHVybiAodGlja2V0cy5uZXh0
IC0gdGlja2V0cy5vd25lcikgPiAxOwotfQotI2RlZmluZSBhcmNoX3NwaW5faXNfY29udGVuZGVk
CWFyY2hfc3Bpbl9pc19jb250ZW5kZWQKLQotI2luY2x1ZGUgPGFzbS9xcndsb2NrLmg+Ci0KLSNl
bmRpZiAvKiBfX0FTTV9DU0tZX1NQSU5MT0NLX0ggKi8KZGlmZiAtLWdpdCBhL2FyY2gvY3NreS9p
bmNsdWRlL2FzbS9zcGlubG9ja190eXBlcy5oIGIvYXJjaC9jc2t5L2luY2x1ZGUvYXNtL3NwaW5s
b2NrX3R5cGVzLmgKZGVsZXRlZCBmaWxlIG1vZGUgMTAwNjQ0CmluZGV4IGRiODdhMTJjMzgyNy4u
MDAwMDAwMDAwMDAwCi0tLSBhL2FyY2gvY3NreS9pbmNsdWRlL2FzbS9zcGlubG9ja190eXBlcy5o
CisrKyAvZGV2L251bGwKQEAgLTEsMjcgKzAsMCBAQAotLyogU1BEWC1MaWNlbnNlLUlkZW50aWZp
ZXI6IEdQTC0yLjAgKi8KLQotI2lmbmRlZiBfX0FTTV9DU0tZX1NQSU5MT0NLX1RZUEVTX0gKLSNk
ZWZpbmUgX19BU01fQ1NLWV9TUElOTE9DS19UWVBFU19ICi0KLSNpZm5kZWYgX19MSU5VWF9TUElO
TE9DS19UWVBFU19SQVdfSAotIyBlcnJvciAicGxlYXNlIGRvbid0IGluY2x1ZGUgdGhpcyBmaWxl
IGRpcmVjdGx5IgotI2VuZGlmCi0KLSNkZWZpbmUgVElDS0VUX05FWFQJMTYKLQotdHlwZWRlZiBz
dHJ1Y3QgewotCXVuaW9uIHsKLQkJdTMyIGxvY2s7Ci0JCXN0cnVjdCBfX3Jhd190aWNrZXRzIHsK
LQkJCS8qIGxpdHRsZSBlbmRpYW4gKi8KLQkJCXUxNiBvd25lcjsKLQkJCXUxNiBuZXh0OwotCQl9
IHRpY2tldHM7Ci0JfTsKLX0gYXJjaF9zcGlubG9ja190OwotCi0jZGVmaW5lIF9fQVJDSF9TUElO
X0xPQ0tfVU5MT0NLRUQJeyB7IDAgfSB9Ci0KLSNpbmNsdWRlIDxhc20tZ2VuZXJpYy9xcndsb2Nr
X3R5cGVzLmg+Ci0KLSNlbmRpZiAvKiBfX0FTTV9DU0tZX1NQSU5MT0NLX1RZUEVTX0ggKi8KLS0g
CjIuMzQuMQoKX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18K
T3BlblJJU0MgbWFpbGluZyBsaXN0Ck9wZW5SSVNDQGxpc3RzLmxpYnJlY29yZXMub3JnCmh0dHBz
Oi8vbGlzdHMubGlicmVjb3Jlcy5vcmcvbGlzdGluZm8vb3BlbnJpc2MK
