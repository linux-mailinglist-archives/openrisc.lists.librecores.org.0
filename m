Return-Path: <openrisc-bounces@lists.librecores.org>
X-Original-To: lists+openrisc@lfdr.de
Delivered-To: lists+openrisc@lfdr.de
Received: from mail.librecores.org (lists.librecores.org [88.198.125.70])
	by mail.lfdr.de (Postfix) with ESMTP id 813B8EAEAE
	for <lists+openrisc@lfdr.de>; Thu, 31 Oct 2019 12:21:26 +0100 (CET)
Received: from [172.31.1.100] (localhost.localdomain [127.0.0.1])
	by mail.librecores.org (Postfix) with ESMTP id 4959320765;
	Thu, 31 Oct 2019 12:21:26 +0100 (CET)
Received: from bombadil.infradead.org (bombadil.infradead.org
 [198.137.202.133])
 by mail.librecores.org (Postfix) with ESMTPS id DCB9A20732
 for <openrisc@lists.librecores.org>; Tue, 29 Oct 2019 07:49:29 +0100 (CET)
DKIM-Signature: v=1; a=rsa-sha256; q=dns/txt; c=relaxed/relaxed;
 d=infradead.org; s=bombadil.20170209; h=Content-Transfer-Encoding:
 MIME-Version:References:In-Reply-To:Message-Id:Date:Subject:Cc:To:From:Sender
 :Reply-To:Content-Type:Content-ID:Content-Description:Resent-Date:Resent-From
 :Resent-Sender:Resent-To:Resent-Cc:Resent-Message-ID:List-Id:List-Help:
 List-Unsubscribe:List-Subscribe:List-Post:List-Owner:List-Archive;
 bh=3F9DtF8s0F7FvQcx64692HZn7ZcjGFqeZajVee0KQs4=; b=PPvjFAO3QLUi9dpVleIiAU3Vv4
 /Pu3BDJxheu7StSqoIj8LzyNSKaOxNF4Ma7zI2KAFCD+WLRYxvRi56SItDw11aM3TxVNn3ezAUnOo
 C0chd4qWBYO+xlwExg+24mjnRghpEDzPF9AYBmZZhga7btg57O+DsZA0o1R84X1fIXQXDYR6D9lNl
 D90QKJNymHcdH2Xzzp+bcJ0ZxE/E9F+jli54bK8rjpgsQALvv3AI1UTpkxwPGIzrlHJw4WnsggfKl
 F0eQCDfF/NW9YMB8KxgjFC0q8PpYrNbdF7NPlwAP/0B/RtwyAiLQERzQYZzCYuUoEsPmS7CwP4RJh
 BAl3AJYg==;
Received: from [2001:4bb8:18c:c7d:c70:4a89:bc61:2] (helo=localhost)
 by bombadil.infradead.org with esmtpsa (Exim 4.92.3 #3 (Red Hat Linux))
 id 1iPLJN-0003ax-2F; Tue, 29 Oct 2019 06:49:01 +0000
From: Christoph Hellwig <hch@lst.de>
To: Arnd Bergmann <arnd@arndb.de>, Guo Ren <guoren@kernel.org>,
 Michal Simek <monstr@monstr.eu>, Greentime Hu <green.hu@gmail.com>,
 Vincent Chen <deanbo422@gmail.com>, Guan Xuetao <gxt@pku.edu.cn>,
 x86@kernel.org
Date: Tue, 29 Oct 2019 07:48:21 +0100
Message-Id: <20191029064834.23438-9-hch@lst.de>
X-Mailer: git-send-email 2.20.1
In-Reply-To: <20191029064834.23438-1-hch@lst.de>
References: <20191029064834.23438-1-hch@lst.de>
MIME-Version: 1.0
X-SRS-Rewrite: SMTP reverse-path rewritten from <hch@infradead.org> by
 bombadil.infradead.org. See http://www.infradead.org/rpr.html
X-Mailman-Approved-At: Thu, 31 Oct 2019 12:21:18 +0100
Subject: [OpenRISC] [PATCH 08/21] x86: Clean up ioremap()
X-BeenThere: openrisc@lists.librecores.org
X-Mailman-Version: 2.1.26
Precedence: list
List-Id: Discussion around the OpenRISC processor
 <openrisc.lists.librecores.org>
List-Unsubscribe: <https://lists.librecores.org/options/openrisc>,
 <mailto:openrisc-request@lists.librecores.org?subject=unsubscribe>
List-Archive: <http://lists.librecores.org/pipermail/openrisc/>
List-Post: <mailto:openrisc@lists.librecores.org>
List-Help: <mailto:openrisc-request@lists.librecores.org?subject=help>
List-Subscribe: <https://lists.librecores.org/listinfo/openrisc>,
 <mailto:openrisc-request@lists.librecores.org?subject=subscribe>
Cc: linux-arch@vger.kernel.org, linux-s390@vger.kernel.org,
 linux-ia64@vger.kernel.org, linux-parisc@vger.kernel.org,
 linux-sh@vger.kernel.org, linux-hexagon@vger.kernel.org,
 linux-xtensa@linux-xtensa.org, linux-mips@vger.kernel.org,
 linux-kernel@vger.kernel.org, linux-m68k@lists.linux-m68k.org,
 openrisc@lists.librecores.org, linux-mtd@lists.infradead.org,
 linux-alpha@vger.kernel.org, sparclinux@vger.kernel.org,
 nios2-dev@lists.rocketboards.org, linux-riscv@lists.infradead.org,
 linux-snps-arc@lists.infradead.org, linux-arm-kernel@lists.infradead.org
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: openrisc-bounces@lists.librecores.org
Sender: "OpenRISC" <openrisc-bounces@lists.librecores.org>

VXNlIGlvcmVtYXAoKSBhcyB0aGUgbWFpbiBpbXBsZW1lbnRlZCBmdW5jdGlvbiwgYW5kIGRlZmlu
ZXMKaW9yZW1hcF9ub2NhY2hlKCkgYXMgYSBkZXByZWNhdGVkIGFsaWFzIG9mIGlvcmVtYXAoKSBp
bgpwcmVwYXJhdGlvbiBvZiByZW1vdmluZyBpb3JlbWFwX25vY2FjaGUoKSBlbnRpcmVseS4KClNp
Z25lZC1vZmYtYnk6IENocmlzdG9waCBIZWxsd2lnIDxoY2hAbHN0LmRlPgotLS0KIGFyY2gveDg2
L2luY2x1ZGUvYXNtL2lvLmggfCA4ICsrLS0tLS0tCiBhcmNoL3g4Ni9tbS9pb3JlbWFwLmMgICAg
IHwgOCArKysrLS0tLQogYXJjaC94ODYvbW0vcGFnZWF0dHIuYyAgICB8IDQgKystLQogMyBmaWxl
cyBjaGFuZ2VkLCA4IGluc2VydGlvbnMoKyksIDEyIGRlbGV0aW9ucygtKQoKZGlmZiAtLWdpdCBh
L2FyY2gveDg2L2luY2x1ZGUvYXNtL2lvLmggYi9hcmNoL3g4Ni9pbmNsdWRlL2FzbS9pby5oCmlu
ZGV4IDZiZWQ5N2ZmNmRiMi4uNmI1Y2M0MTMxOWE3IDEwMDY0NAotLS0gYS9hcmNoL3g4Ni9pbmNs
dWRlL2FzbS9pby5oCisrKyBiL2FyY2gveDg2L2luY2x1ZGUvYXNtL2lvLmgKQEAgLTE4MCw4ICsx
ODAsNiBAQCBzdGF0aWMgaW5saW5lIHVuc2lnbmVkIGludCBpc2FfdmlydF90b19idXModm9sYXRp
bGUgdm9pZCAqYWRkcmVzcykKICAqIFRoZSBkZWZhdWx0IGlvcmVtYXAoKSBiZWhhdmlvciBpcyBu
b24tY2FjaGVkOyBpZiB5b3UgbmVlZCBzb21ldGhpbmcKICAqIGVsc2UsIHlvdSBwcm9iYWJseSB3
YW50IG9uZSBvZiB0aGUgZm9sbG93aW5nLgogICovCi1leHRlcm4gdm9pZCBfX2lvbWVtICppb3Jl
bWFwX25vY2FjaGUocmVzb3VyY2Vfc2l6ZV90IG9mZnNldCwgdW5zaWduZWQgbG9uZyBzaXplKTsK
LSNkZWZpbmUgaW9yZW1hcF9ub2NhY2hlIGlvcmVtYXBfbm9jYWNoZQogZXh0ZXJuIHZvaWQgX19p
b21lbSAqaW9yZW1hcF91YyhyZXNvdXJjZV9zaXplX3Qgb2Zmc2V0LCB1bnNpZ25lZCBsb25nIHNp
emUpOwogI2RlZmluZSBpb3JlbWFwX3VjIGlvcmVtYXBfdWMKIGV4dGVybiB2b2lkIF9faW9tZW0g
KmlvcmVtYXBfY2FjaGUocmVzb3VyY2Vfc2l6ZV90IG9mZnNldCwgdW5zaWduZWQgbG9uZyBzaXpl
KTsKQEAgLTIwNSwxMSArMjAzLDkgQEAgZXh0ZXJuIHZvaWQgX19pb21lbSAqaW9yZW1hcF9lbmNy
eXB0ZWQocmVzb3VyY2Vfc2l6ZV90IHBoeXNfYWRkciwgdW5zaWduZWQgbG9uZwogICogSWYgdGhl
IGFyZWEgeW91IGFyZSB0cnlpbmcgdG8gbWFwIGlzIGEgUENJIEJBUiB5b3Ugc2hvdWxkIGhhdmUg
YQogICogbG9vayBhdCBwY2lfaW9tYXAoKS4KICAqLwotc3RhdGljIGlubGluZSB2b2lkIF9faW9t
ZW0gKmlvcmVtYXAocmVzb3VyY2Vfc2l6ZV90IG9mZnNldCwgdW5zaWduZWQgbG9uZyBzaXplKQot
ewotCXJldHVybiBpb3JlbWFwX25vY2FjaGUob2Zmc2V0LCBzaXplKTsKLX0KK3ZvaWQgX19pb21l
bSAqaW9yZW1hcChyZXNvdXJjZV9zaXplX3Qgb2Zmc2V0LCB1bnNpZ25lZCBsb25nIHNpemUpOwog
I2RlZmluZSBpb3JlbWFwIGlvcmVtYXAKKyNkZWZpbmUgaW9yZW1hcF9ub2NhY2hlIGlvcmVtYXAK
IAogZXh0ZXJuIHZvaWQgaW91bm1hcCh2b2xhdGlsZSB2b2lkIF9faW9tZW0gKmFkZHIpOwogI2Rl
ZmluZSBpb3VubWFwIGlvdW5tYXAKZGlmZiAtLWdpdCBhL2FyY2gveDg2L21tL2lvcmVtYXAuYyBi
L2FyY2gveDg2L21tL2lvcmVtYXAuYwppbmRleCBhMzlkY2RiNWFlMzQuLjc5ODUyMzNkZmI4ZCAx
MDA2NDQKLS0tIGEvYXJjaC94ODYvbW0vaW9yZW1hcC5jCisrKyBiL2FyY2gveDg2L21tL2lvcmVt
YXAuYwpAQCAtMjgwLDExICsyODAsMTEgQEAgX19pb3JlbWFwX2NhbGxlcihyZXNvdXJjZV9zaXpl
X3QgcGh5c19hZGRyLCB1bnNpZ25lZCBsb25nIHNpemUsCiB9CiAKIC8qKgotICogaW9yZW1hcF9u
b2NhY2hlICAgICAtICAgbWFwIGJ1cyBtZW1vcnkgaW50byBDUFUgc3BhY2UKKyAqIGlvcmVtYXAg
ICAgIC0gICBtYXAgYnVzIG1lbW9yeSBpbnRvIENQVSBzcGFjZQogICogQHBoeXNfYWRkcjogICAg
YnVzIGFkZHJlc3Mgb2YgdGhlIG1lbW9yeQogICogQHNpemU6ICAgICAgc2l6ZSBvZiB0aGUgcmVz
b3VyY2UgdG8gbWFwCiAgKgotICogaW9yZW1hcF9ub2NhY2hlIHBlcmZvcm1zIGEgcGxhdGZvcm0g
c3BlY2lmaWMgc2VxdWVuY2Ugb2Ygb3BlcmF0aW9ucyB0bworICogaW9yZW1hcCBwZXJmb3JtcyBh
IHBsYXRmb3JtIHNwZWNpZmljIHNlcXVlbmNlIG9mIG9wZXJhdGlvbnMgdG8KICAqIG1ha2UgYnVz
IG1lbW9yeSBDUFUgYWNjZXNzaWJsZSB2aWEgdGhlIHJlYWRiL3JlYWR3L3JlYWRsL3dyaXRlYi8K
ICAqIHdyaXRldy93cml0ZWwgZnVuY3Rpb25zIGFuZCB0aGUgb3RoZXIgbW1pbyBoZWxwZXJzLiBU
aGUgcmV0dXJuZWQKICAqIGFkZHJlc3MgaXMgbm90IGd1YXJhbnRlZWQgdG8gYmUgdXNhYmxlIGRp
cmVjdGx5IGFzIGEgdmlydHVhbApAQCAtMzAwLDcgKzMwMCw3IEBAIF9faW9yZW1hcF9jYWxsZXIo
cmVzb3VyY2Vfc2l6ZV90IHBoeXNfYWRkciwgdW5zaWduZWQgbG9uZyBzaXplLAogICoKICAqIE11
c3QgYmUgZnJlZWQgd2l0aCBpb3VubWFwLgogICovCi12b2lkIF9faW9tZW0gKmlvcmVtYXBfbm9j
YWNoZShyZXNvdXJjZV9zaXplX3QgcGh5c19hZGRyLCB1bnNpZ25lZCBsb25nIHNpemUpCit2b2lk
IF9faW9tZW0gKmlvcmVtYXAocmVzb3VyY2Vfc2l6ZV90IHBoeXNfYWRkciwgdW5zaWduZWQgbG9u
ZyBzaXplKQogewogCS8qCiAJICogSWRlYWxseSwgdGhpcyBzaG91bGQgYmU6CkBAIC0zMTUsNyAr
MzE1LDcgQEAgdm9pZCBfX2lvbWVtICppb3JlbWFwX25vY2FjaGUocmVzb3VyY2Vfc2l6ZV90IHBo
eXNfYWRkciwgdW5zaWduZWQgbG9uZyBzaXplKQogCXJldHVybiBfX2lvcmVtYXBfY2FsbGVyKHBo
eXNfYWRkciwgc2l6ZSwgcGNtLAogCQkJCV9fYnVpbHRpbl9yZXR1cm5fYWRkcmVzcygwKSwgZmFs
c2UpOwogfQotRVhQT1JUX1NZTUJPTChpb3JlbWFwX25vY2FjaGUpOworRVhQT1JUX1NZTUJPTChp
b3JlbWFwKTsKIAogLyoqCiAgKiBpb3JlbWFwX3VjICAgICAtICAgbWFwIGJ1cyBtZW1vcnkgaW50
byBDUFUgc3BhY2UgYXMgc3Ryb25nbHkgdW5jYWNoYWJsZQpkaWZmIC0tZ2l0IGEvYXJjaC94ODYv
bW0vcGFnZWF0dHIuYyBiL2FyY2gveDg2L21tL3BhZ2VhdHRyLmMKaW5kZXggMGQwOWNjNWFhZDYx
Li4xYjk5YWQwNWIxMTcgMTAwNjQ0Ci0tLSBhL2FyY2gveDg2L21tL3BhZ2VhdHRyLmMKKysrIGIv
YXJjaC94ODYvbW0vcGFnZWF0dHIuYwpAQCAtMTc4NCw3ICsxNzg0LDcgQEAgc3RhdGljIGlubGlu
ZSBpbnQgY3BhX2NsZWFyX3BhZ2VzX2FycmF5KHN0cnVjdCBwYWdlICoqcGFnZXMsIGludCBudW1w
YWdlcywKIGludCBfc2V0X21lbW9yeV91Yyh1bnNpZ25lZCBsb25nIGFkZHIsIGludCBudW1wYWdl
cykKIHsKIAkvKgotCSAqIGZvciBub3cgVUMgTUlOVVMuIHNlZSBjb21tZW50cyBpbiBpb3JlbWFw
X25vY2FjaGUoKQorCSAqIGZvciBub3cgVUMgTUlOVVMuIHNlZSBjb21tZW50cyBpbiBpb3JlbWFw
KCkKIAkgKiBJZiB5b3UgcmVhbGx5IG5lZWQgc3Ryb25nIFVDIHVzZSBpb3JlbWFwX3VjKCksIGJ1
dCBub3RlCiAJICogdGhhdCB5b3UgY2Fubm90IG92ZXJyaWRlIElPIGFyZWFzIHdpdGggc2V0X21l
bW9yeV8qKCkgYXMKIAkgKiB0aGVzZSBoZWxwZXJzIGNhbm5vdCB3b3JrIHdpdGggSU8gbWVtb3J5
LgpAQCAtMTc5OSw3ICsxNzk5LDcgQEAgaW50IHNldF9tZW1vcnlfdWModW5zaWduZWQgbG9uZyBh
ZGRyLCBpbnQgbnVtcGFnZXMpCiAJaW50IHJldDsKIAogCS8qCi0JICogZm9yIG5vdyBVQyBNSU5V
Uy4gc2VlIGNvbW1lbnRzIGluIGlvcmVtYXBfbm9jYWNoZSgpCisJICogZm9yIG5vdyBVQyBNSU5V
Uy4gc2VlIGNvbW1lbnRzIGluIGlvcmVtYXAoKQogCSAqLwogCXJldCA9IHJlc2VydmVfbWVtdHlw
ZShfX3BhKGFkZHIpLCBfX3BhKGFkZHIpICsgbnVtcGFnZXMgKiBQQUdFX1NJWkUsCiAJCQkgICAg
ICBfUEFHRV9DQUNIRV9NT0RFX1VDX01JTlVTLCBOVUxMKTsKLS0gCjIuMjAuMQoKX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18KT3BlblJJU0MgbWFpbGluZyBs
aXN0Ck9wZW5SSVNDQGxpc3RzLmxpYnJlY29yZXMub3JnCmh0dHBzOi8vbGlzdHMubGlicmVjb3Jl
cy5vcmcvbGlzdGluZm8vb3BlbnJpc2MK
