Return-Path: <openrisc-bounces@lists.librecores.org>
X-Original-To: lists+openrisc@lfdr.de
Delivered-To: lists+openrisc@lfdr.de
Received: from mail.librecores.org (lists.librecores.org [88.198.125.70])
	by mail.lfdr.de (Postfix) with ESMTP id E75D2515EC4
	for <lists+openrisc@lfdr.de>; Sat, 30 Apr 2022 17:38:04 +0200 (CEST)
Received: from [172.31.1.100] (localhost.localdomain [127.0.0.1])
	by mail.librecores.org (Postfix) with ESMTP id C225D248F8;
	Sat, 30 Apr 2022 17:38:04 +0200 (CEST)
Received: from mail-pl1-f180.google.com (mail-pl1-f180.google.com
 [209.85.214.180])
 by mail.librecores.org (Postfix) with ESMTPS id 3394A248F1
 for <openrisc@lists.librecores.org>; Sat, 30 Apr 2022 17:38:01 +0200 (CEST)
Received: by mail-pl1-f180.google.com with SMTP id s14so9448488plk.8
 for <openrisc@lists.librecores.org>; Sat, 30 Apr 2022 08:38:01 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=rivosinc-com.20210112.gappssmtp.com; s=20210112;
 h=subject:date:message-id:in-reply-to:references:mime-version
 :content-transfer-encoding:cc:from:to;
 bh=PhfY9SC+wYhs3i/pCnS1F0qe7XGea8rOjY/kEhC+LrE=;
 b=sCDHVOiLVN32Y8ICH+ZkCKw/InoCrY43xa27irUukeSvGPghb/JBYOw6oTCkeIBkNa
 +H/XBYvBx7CV0nBuiGA7CSeqpBzMXbIkhHwzR01gcHQLnmqthIK6PG5GbP5QbH/LT2af
 9Em8Bhs6r45/fJ462zBxoDeJfmyc3zQOXCJQOLKUa7NZyWoNpE+p5rq+evLX48Wxqz7Z
 8QuGzNeewDVFwR94Xv+ACR39i3XWraOwk4MmDN7l7tVP+OXZvX8sxAPK4yys2j11psjV
 Aa1jdjYTmV+9Er+vvhIB/vTozu0gkGHHg2IByGGcQHC5KnFPIj4uZM2dHaqz/yWVmr+t
 6dBg==
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20210112;
 h=x-gm-message-state:subject:date:message-id:in-reply-to:references
 :mime-version:content-transfer-encoding:cc:from:to;
 bh=PhfY9SC+wYhs3i/pCnS1F0qe7XGea8rOjY/kEhC+LrE=;
 b=BI0YiIQs3HjaAjiss6aaSJjap5yUBO5Ebna7oWS8pkrijN1FECgXY5eiFlYmCe0GbE
 0xX19bg6w7WVBOOgODTy8vbpVpei2itkZQtkCbxkJC9b7k0xNshiuKJECuE5ce/VgNgC
 7nuphcH/6r+VHsALOjVQzXc13cXVotKtORz3i20HLLEDEx8QpSyVM0cpIZTVcppXkQi5
 FNVnt1rSF0xYdf3PMOYecbCqnIaHKWHggJKtRQRxKifYfE+45xdAffUvsWlyoAPlKr5b
 cgEn5f/DNYMU5WkIdknCZegibUIZfdOCBkc243JsVn3SUXA4f0PYnF/o71QzGIVIA7hx
 mr1g==
X-Gm-Message-State: AOAM532OcnvCKkWWh/4gFLGYw6vrkiUlUglP/jsx+mIZTQaYpMmaHvKt
 BfVc+ZT8o0GEBxiIVWakYv3vWQ==
X-Google-Smtp-Source: ABdhPJyQzZr23BkCwG1+xSArqcEmCk72rbg9rU3h9fy701WXzCXMfDWtm+qk2uXLdC5yg4y6n4z3Nw==
X-Received: by 2002:a17:902:b789:b0:15b:5d52:7542 with SMTP id
 e9-20020a170902b78900b0015b5d527542mr4396814pls.26.1651333079791; 
 Sat, 30 Apr 2022 08:37:59 -0700 (PDT)
Received: from localhost (76-210-143-223.lightspeed.sntcca.sbcglobal.net.
 [76.210.143.223]) by smtp.gmail.com with ESMTPSA id
 x5-20020aa793a5000000b0050dc7628201sm1677478pff.219.2022.04.30.08.37.59
 (version=TLS1_3 cipher=TLS_AES_256_GCM_SHA384 bits=256/256);
 Sat, 30 Apr 2022 08:37:59 -0700 (PDT)
Date: Sat, 30 Apr 2022 08:36:25 -0700
Message-Id: <20220430153626.30660-7-palmer@rivosinc.com>
X-Mailer: git-send-email 2.34.1
In-Reply-To: <20220430153626.30660-1-palmer@rivosinc.com>
References: <20220430153626.30660-1-palmer@rivosinc.com>
MIME-Version: 1.0
From: Palmer Dabbelt <palmer@rivosinc.com>
To: Arnd Bergmann <arnd@arndb.de>
Subject: [OpenRISC] [PATCH v4 6/7] RISC-V: Move to queued RW locks
X-BeenThere: openrisc@lists.librecores.org
X-Mailman-Version: 2.1.26
Precedence: list
List-Id: Discussion around the OpenRISC processor
 <openrisc.lists.librecores.org>
List-Unsubscribe: <https://lists.librecores.org/options/openrisc>,
 <mailto:openrisc-request@lists.librecores.org?subject=unsubscribe>
List-Archive: <http://lists.librecores.org/pipermail/openrisc/>
List-Post: <mailto:openrisc@lists.librecores.org>
List-Help: <mailto:openrisc-request@lists.librecores.org?subject=help>
List-Subscribe: <https://lists.librecores.org/listinfo/openrisc>,
 <mailto:openrisc-request@lists.librecores.org?subject=subscribe>
Cc: peterz@infradead.org, Palmer Dabbelt <palmer@rivosinc.com>,
 guoren@kernel.org, jszhang@kernel.org, linux-riscv@lists.infradead.org,
 Will Deacon <will@kernel.org>, jonas@southpole.se, linux-csky@vger.kernel.org,
 mingo@redhat.com, longman@redhat.com, linux-arch@vger.kernel.org,
 aou@eecs.berkeley.edu, Arnd Bergmann <arnd@arndb.de>, boqun.feng@gmail.com,
 openrisc@lists.librecores.org, Paul Walmsley <paul.walmsley@sifive.com>,
 Greg KH <gregkh@linuxfoundation.org>, linux-kernel@vger.kernel.org,
 Palmer Dabbelt <palmer@dabbelt.com>, sudipm.mukherjee@gmail.com,
 macro@orcam.me.uk
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: openrisc-bounces@lists.librecores.org
Sender: "OpenRISC" <openrisc-bounces@lists.librecores.org>

RnJvbTogUGFsbWVyIERhYmJlbHQgPHBhbG1lckByaXZvc2luYy5jb20+CgpOb3cgdGhhdCB3ZSBo
YXZlIGZhaXIgc3BpbmxvY2tzIHdlIGNhbiB1c2UgdGhlIGdlbmVyaWMgcXVldWVkIHJ3bG9ja3Ms
CnNvIHdlIG1pZ2h0IGFzIHdlbGwgZG8gc28uCgpTaWduZWQtb2ZmLWJ5OiBQYWxtZXIgRGFiYmVs
dCA8cGFsbWVyQHJpdm9zaW5jLmNvbT4KLS0tCiBhcmNoL3Jpc2N2L0tjb25maWcgICAgICAgICAg
ICAgICAgICAgICAgfCAgMSArCiBhcmNoL3Jpc2N2L2luY2x1ZGUvYXNtL0tidWlsZCAgICAgICAg
ICAgfCAgMiArCiBhcmNoL3Jpc2N2L2luY2x1ZGUvYXNtL3NwaW5sb2NrLmggICAgICAgfCA5OSAt
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCiBhcmNoL3Jpc2N2L2luY2x1ZGUvYXNtL3NwaW5sb2Nr
X3R5cGVzLmggfCAyNCAtLS0tLS0KIDQgZmlsZXMgY2hhbmdlZCwgMyBpbnNlcnRpb25zKCspLCAx
MjMgZGVsZXRpb25zKC0pCiBkZWxldGUgbW9kZSAxMDA2NDQgYXJjaC9yaXNjdi9pbmNsdWRlL2Fz
bS9zcGlubG9jay5oCiBkZWxldGUgbW9kZSAxMDA2NDQgYXJjaC9yaXNjdi9pbmNsdWRlL2FzbS9z
cGlubG9ja190eXBlcy5oCgpkaWZmIC0tZ2l0IGEvYXJjaC9yaXNjdi9LY29uZmlnIGIvYXJjaC9y
aXNjdi9LY29uZmlnCmluZGV4IDAwZmQ5YzU0OGYyNi4uZjhhNTVkOTQwMTZkIDEwMDY0NAotLS0g
YS9hcmNoL3Jpc2N2L0tjb25maWcKKysrIGIvYXJjaC9yaXNjdi9LY29uZmlnCkBAIC0zOSw2ICsz
OSw3IEBAIGNvbmZpZyBSSVNDVgogCXNlbGVjdCBBUkNIX1NVUFBPUlRTX0RFQlVHX1BBR0VBTExP
QyBpZiBNTVUKIAlzZWxlY3QgQVJDSF9TVVBQT1JUU19IVUdFVExCRlMgaWYgTU1VCiAJc2VsZWN0
IEFSQ0hfVVNFX01FTVRFU1QKKwlzZWxlY3QgQVJDSF9VU0VfUVVFVUVEX1JXTE9DS1MKIAlzZWxl
Y3QgQVJDSF9XQU5UX0RFRkFVTFRfVE9QRE9XTl9NTUFQX0xBWU9VVCBpZiBNTVUKIAlzZWxlY3Qg
QVJDSF9XQU5UX0ZSQU1FX1BPSU5URVJTCiAJc2VsZWN0IEFSQ0hfV0FOVF9HRU5FUkFMX0hVR0VU
TEIKZGlmZiAtLWdpdCBhL2FyY2gvcmlzY3YvaW5jbHVkZS9hc20vS2J1aWxkIGIvYXJjaC9yaXNj
di9pbmNsdWRlL2FzbS9LYnVpbGQKaW5kZXggYzNmMjI5YWU4MDMzLi41MDRmOGI3ZTcyZDQgMTAw
NjQ0Ci0tLSBhL2FyY2gvcmlzY3YvaW5jbHVkZS9hc20vS2J1aWxkCisrKyBiL2FyY2gvcmlzY3Yv
aW5jbHVkZS9hc20vS2J1aWxkCkBAIC0zLDYgKzMsOCBAQCBnZW5lcmljLXkgKz0gZWFybHlfaW9y
ZW1hcC5oCiBnZW5lcmljLXkgKz0gZmxhdC5oCiBnZW5lcmljLXkgKz0ga3ZtX3BhcmEuaAogZ2Vu
ZXJpYy15ICs9IHBhcnBvcnQuaAorZ2VuZXJpYy15ICs9IHNwaW5sb2NrLmgKK2dlbmVyaWMteSAr
PSBzcGlubG9ja190eXBlcy5oCiBnZW5lcmljLXkgKz0gcXJ3bG9jay5oCiBnZW5lcmljLXkgKz0g
cXJ3bG9ja190eXBlcy5oCiBnZW5lcmljLXkgKz0gdXNlci5oCmRpZmYgLS1naXQgYS9hcmNoL3Jp
c2N2L2luY2x1ZGUvYXNtL3NwaW5sb2NrLmggYi9hcmNoL3Jpc2N2L2luY2x1ZGUvYXNtL3NwaW5s
b2NrLmgKZGVsZXRlZCBmaWxlIG1vZGUgMTAwNjQ0CmluZGV4IDg4YTRkNWQwZDk4YS4uMDAwMDAw
MDAwMDAwCi0tLSBhL2FyY2gvcmlzY3YvaW5jbHVkZS9hc20vc3BpbmxvY2suaAorKysgL2Rldi9u
dWxsCkBAIC0xLDk5ICswLDAgQEAKLS8qIFNQRFgtTGljZW5zZS1JZGVudGlmaWVyOiBHUEwtMi4w
LW9ubHkgKi8KLS8qCi0gKiBDb3B5cmlnaHQgKEMpIDIwMTUgUmVnZW50cyBvZiB0aGUgVW5pdmVy
c2l0eSBvZiBDYWxpZm9ybmlhCi0gKiBDb3B5cmlnaHQgKEMpIDIwMTcgU2lGaXZlCi0gKi8KLQot
I2lmbmRlZiBfQVNNX1JJU0NWX1NQSU5MT0NLX0gKLSNkZWZpbmUgX0FTTV9SSVNDVl9TUElOTE9D
S19ICi0KLS8qIFRoaXMgaXMgaG9yaWJsZSwgYnV0IHRoZSB3aG9sZSBmaWxlIGlzIGdvaW5nIGF3
YXkgaW4gdGhlIG5leHQgY29tbWl0LiAqLwotI2RlZmluZSBfX0FTTV9HRU5FUklDX1FSV0xPQ0tf
SAotCi0jaW5jbHVkZSA8bGludXgva2VybmVsLmg+Ci0jaW5jbHVkZSA8YXNtL2N1cnJlbnQuaD4K
LSNpbmNsdWRlIDxhc20vZmVuY2UuaD4KLSNpbmNsdWRlIDxhc20tZ2VuZXJpYy9zcGlubG9jay5o
PgotCi1zdGF0aWMgaW5saW5lIHZvaWQgYXJjaF9yZWFkX2xvY2soYXJjaF9yd2xvY2tfdCAqbG9j
aykKLXsKLQlpbnQgdG1wOwotCi0JX19hc21fXyBfX3ZvbGF0aWxlX18oCi0JCSIxOglsci53CSUx
LCAlMFxuIgotCQkiCWJsdHoJJTEsIDFiXG4iCi0JCSIJYWRkaQklMSwgJTEsIDFcbiIKLQkJIglz
Yy53CSUxLCAlMSwgJTBcbiIKLQkJIglibmV6CSUxLCAxYlxuIgotCQlSSVNDVl9BQ1FVSVJFX0JB
UlJJRVIKLQkJOiAiK0EiIChsb2NrLT5sb2NrKSwgIj0mciIgKHRtcCkKLQkJOjogIm1lbW9yeSIp
OwotfQotCi1zdGF0aWMgaW5saW5lIHZvaWQgYXJjaF93cml0ZV9sb2NrKGFyY2hfcndsb2NrX3Qg
KmxvY2spCi17Ci0JaW50IHRtcDsKLQotCV9fYXNtX18gX192b2xhdGlsZV9fKAotCQkiMToJbHIu
dwklMSwgJTBcbiIKLQkJIglibmV6CSUxLCAxYlxuIgotCQkiCWxpCSUxLCAtMVxuIgotCQkiCXNj
LncJJTEsICUxLCAlMFxuIgotCQkiCWJuZXoJJTEsIDFiXG4iCi0JCVJJU0NWX0FDUVVJUkVfQkFS
UklFUgotCQk6ICIrQSIgKGxvY2stPmxvY2spLCAiPSZyIiAodG1wKQotCQk6OiAibWVtb3J5Iik7
Ci19Ci0KLXN0YXRpYyBpbmxpbmUgaW50IGFyY2hfcmVhZF90cnlsb2NrKGFyY2hfcndsb2NrX3Qg
KmxvY2spCi17Ci0JaW50IGJ1c3k7Ci0KLQlfX2FzbV9fIF9fdm9sYXRpbGVfXygKLQkJIjE6CWxy
LncJJTEsICUwXG4iCi0JCSIJYmx0egklMSwgMWZcbiIKLQkJIglhZGRpCSUxLCAlMSwgMVxuIgot
CQkiCXNjLncJJTEsICUxLCAlMFxuIgotCQkiCWJuZXoJJTEsIDFiXG4iCi0JCVJJU0NWX0FDUVVJ
UkVfQkFSUklFUgotCQkiMTpcbiIKLQkJOiAiK0EiIChsb2NrLT5sb2NrKSwgIj0mciIgKGJ1c3kp
Ci0JCTo6ICJtZW1vcnkiKTsKLQotCXJldHVybiAhYnVzeTsKLX0KLQotc3RhdGljIGlubGluZSBp
bnQgYXJjaF93cml0ZV90cnlsb2NrKGFyY2hfcndsb2NrX3QgKmxvY2spCi17Ci0JaW50IGJ1c3k7
Ci0KLQlfX2FzbV9fIF9fdm9sYXRpbGVfXygKLQkJIjE6CWxyLncJJTEsICUwXG4iCi0JCSIJYm5l
egklMSwgMWZcbiIKLQkJIglsaQklMSwgLTFcbiIKLQkJIglzYy53CSUxLCAlMSwgJTBcbiIKLQkJ
IglibmV6CSUxLCAxYlxuIgotCQlSSVNDVl9BQ1FVSVJFX0JBUlJJRVIKLQkJIjE6XG4iCi0JCTog
IitBIiAobG9jay0+bG9jayksICI9JnIiIChidXN5KQotCQk6OiAibWVtb3J5Iik7Ci0KLQlyZXR1
cm4gIWJ1c3k7Ci19Ci0KLXN0YXRpYyBpbmxpbmUgdm9pZCBhcmNoX3JlYWRfdW5sb2NrKGFyY2hf
cndsb2NrX3QgKmxvY2spCi17Ci0JX19hc21fXyBfX3ZvbGF0aWxlX18oCi0JCVJJU0NWX1JFTEVB
U0VfQkFSUklFUgotCQkiCWFtb2FkZC53IHgwLCAlMSwgJTBcbiIKLQkJOiAiK0EiIChsb2NrLT5s
b2NrKQotCQk6ICJyIiAoLTEpCi0JCTogIm1lbW9yeSIpOwotfQotCi1zdGF0aWMgaW5saW5lIHZv
aWQgYXJjaF93cml0ZV91bmxvY2soYXJjaF9yd2xvY2tfdCAqbG9jaykKLXsKLQlzbXBfc3RvcmVf
cmVsZWFzZSgmbG9jay0+bG9jaywgMCk7Ci19Ci0KLSNlbmRpZiAvKiBfQVNNX1JJU0NWX1NQSU5M
T0NLX0ggKi8KZGlmZiAtLWdpdCBhL2FyY2gvcmlzY3YvaW5jbHVkZS9hc20vc3BpbmxvY2tfdHlw
ZXMuaCBiL2FyY2gvcmlzY3YvaW5jbHVkZS9hc20vc3BpbmxvY2tfdHlwZXMuaApkZWxldGVkIGZp
bGUgbW9kZSAxMDA2NDQKaW5kZXggZjJmOWI1ZDcxMjBkLi4wMDAwMDAwMDAwMDAKLS0tIGEvYXJj
aC9yaXNjdi9pbmNsdWRlL2FzbS9zcGlubG9ja190eXBlcy5oCisrKyAvZGV2L251bGwKQEAgLTEs
MjQgKzAsMCBAQAotLyogU1BEWC1MaWNlbnNlLUlkZW50aWZpZXI6IEdQTC0yLjAtb25seSAqLwot
LyoKLSAqIENvcHlyaWdodCAoQykgMjAxNSBSZWdlbnRzIG9mIHRoZSBVbml2ZXJzaXR5IG9mIENh
bGlmb3JuaWEKLSAqLwotCi0jaWZuZGVmIF9BU01fUklTQ1ZfU1BJTkxPQ0tfVFlQRVNfSAotI2Rl
ZmluZSBfQVNNX1JJU0NWX1NQSU5MT0NLX1RZUEVTX0gKLQotLyogVGhpcyBpcyBob3JpYmxlLCBi
dXQgdGhlIHdob2xlIGZpbGUgaXMgZ29pbmcgYXdheSBpbiB0aGUgbmV4dCBjb21taXQuICovCi0j
ZGVmaW5lIF9fQVNNX0dFTkVSSUNfUVJXTE9DS19UWVBFU19ICi0KLSNpZm5kZWYgX19MSU5VWF9T
UElOTE9DS19UWVBFU19SQVdfSAotIyBlcnJvciAicGxlYXNlIGRvbid0IGluY2x1ZGUgdGhpcyBm
aWxlIGRpcmVjdGx5IgotI2VuZGlmCi0KLSNpbmNsdWRlIDxhc20tZ2VuZXJpYy9zcGlubG9ja190
eXBlcy5oPgotCi10eXBlZGVmIHN0cnVjdCB7Ci0Jdm9sYXRpbGUgdW5zaWduZWQgaW50IGxvY2s7
Ci19IGFyY2hfcndsb2NrX3Q7Ci0KLSNkZWZpbmUgX19BUkNIX1JXX0xPQ0tfVU5MT0NLRUQJCXsg
MCB9Ci0KLSNlbmRpZiAvKiBfQVNNX1JJU0NWX1NQSU5MT0NLX1RZUEVTX0ggKi8KLS0gCjIuMzQu
MQoKX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18KT3BlblJJ
U0MgbWFpbGluZyBsaXN0Ck9wZW5SSVNDQGxpc3RzLmxpYnJlY29yZXMub3JnCmh0dHBzOi8vbGlz
dHMubGlicmVjb3Jlcy5vcmcvbGlzdGluZm8vb3BlbnJpc2MK
