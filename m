Return-Path: <openrisc-bounces@lists.librecores.org>
X-Original-To: lists+openrisc@lfdr.de
Delivered-To: lists+openrisc@lfdr.de
Received: from mail.librecores.org (lists.librecores.org [88.198.125.70])
	by mail.lfdr.de (Postfix) with ESMTP id 10451408B4D
	for <lists+openrisc@lfdr.de>; Mon, 13 Sep 2021 14:48:29 +0200 (CEST)
Received: from [172.31.1.100] (localhost.localdomain [127.0.0.1])
	by mail.librecores.org (Postfix) with ESMTP id E6EA124147;
	Mon, 13 Sep 2021 14:48:28 +0200 (CEST)
Received: from mail-pf1-f180.google.com (mail-pf1-f180.google.com
 [209.85.210.180])
 by mail.librecores.org (Postfix) with ESMTPS id BEFDD24145
 for <openrisc@lists.librecores.org>; Mon, 13 Sep 2021 14:48:26 +0200 (CEST)
Received: by mail-pf1-f180.google.com with SMTP id y17so8691297pfl.13
 for <openrisc@lists.librecores.org>; Mon, 13 Sep 2021 05:48:26 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=gmail.com; s=20210112;
 h=from:to:cc:subject:date:message-id:in-reply-to:references
 :mime-version:content-transfer-encoding;
 bh=n8k9WOdBJvnn1PxbT9h1nn8CqwTmcLTq0LRH+QJ8lOA=;
 b=jaABwKmDUWOAAxvQ3iXcT6/fd5FaorPceGTYIjlV8hSJiIisTz1fxGJDX0xse2SSCG
 NOpfXrX60q75c4znv//WZ64YoAnSOEWvFLjE/W/9Vi4SPCstWtUD9tWT31m5auOki3ko
 qh7082Lq9LjPDYXrucPFG0DqjG4ZSHyM1kJIlB6yizfS3SSZyU7CcxLkolvvp5jfRjc8
 SWcL30+/ZO79e3V4lvD6m1BGjJDTyktju7sxg9UufwQx1RoCYAS3pyKMSh7bHegnwwdu
 Oju4H4iMcHGK+PBeioAyWwH8uh9qwt6f+UQ92zHDlptpIhSsFYYBif8H6LJFzYx2BSdW
 6Vfg==
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20210112;
 h=x-gm-message-state:from:to:cc:subject:date:message-id:in-reply-to
 :references:mime-version:content-transfer-encoding;
 bh=n8k9WOdBJvnn1PxbT9h1nn8CqwTmcLTq0LRH+QJ8lOA=;
 b=iWCEMMsDfP4TMO0n+3C/A2pSqDSBL3y5ehyvgg2nUWpVIOZxv4T6Fiusdxef8P6EcT
 IHgqBaCp8j7CA0oM+YOpGJgcR8Pp6ai5FxiO1tIE50jJNSEI59jnGpq2oR1NASHmNff/
 hxKrYmO8Fpa1hfkZdypvUvk0GVNPQS4o00lF0aJe8gGGdM9rSjbuJ2bKfiajSudxYYu5
 QKV5Aj8wq+V3JZXqscT0APDD4jjqf9fG2jUY5Jn194zRypzX/LQXUBTjHOS1bs684qJS
 zHuErnHIDTKunt/IMTgJrdTgBqGCMB0XYu2an4chGwcCHcxHlCtcZBhQPpVdloxozhN7
 MdiQ==
X-Gm-Message-State: AOAM530hbUhl8xFTmqT7P7iAsfSvyJZalRwNXifOod74Q5HVASYM7oDu
 kLi1qwxaqKFRaMz2ohcx018=
X-Google-Smtp-Source: ABdhPJx/ulWcNnxnOWF4il6OUCdqZZhheVjL+DQh/DHGZHH5/vZwi9dF0/Ft3aahEaUjBJNz745qAA==
X-Received: by 2002:a62:cf06:0:b0:438:ac39:5303 with SMTP id
 b6-20020a62cf06000000b00438ac395303mr11135134pfg.26.1631537305179; 
 Mon, 13 Sep 2021 05:48:25 -0700 (PDT)
Received: from localhost (g245.61-45-50.ppp.wakwak.ne.jp. [61.45.50.245])
 by smtp.gmail.com with ESMTPSA id n41sm7402744pfv.108.2021.09.13.05.48.23
 (version=TLS1_3 cipher=TLS_AES_256_GCM_SHA384 bits=256/256);
 Mon, 13 Sep 2021 05:48:24 -0700 (PDT)
From: Stafford Horne <shorne@gmail.com>
To: GDB patches <gdb-patches@sourceware.org>
Date: Mon, 13 Sep 2021 21:47:56 +0900
Message-Id: <20210913124800.471680-2-shorne@gmail.com>
X-Mailer: git-send-email 2.31.1
In-Reply-To: <20210913124800.471680-1-shorne@gmail.com>
References: <20210913124800.471680-1-shorne@gmail.com>
MIME-Version: 1.0
Subject: [OpenRISC] [PATCH 1/5] gdb: or1k: implement gdb server
X-BeenThere: openrisc@lists.librecores.org
X-Mailman-Version: 2.1.26
Precedence: list
List-Id: Discussion around the OpenRISC processor
 <openrisc.lists.librecores.org>
List-Unsubscribe: <https://lists.librecores.org/options/openrisc>,
 <mailto:openrisc-request@lists.librecores.org?subject=unsubscribe>
List-Archive: <http://lists.librecores.org/pipermail/openrisc/>
List-Post: <mailto:openrisc@lists.librecores.org>
List-Help: <mailto:openrisc-request@lists.librecores.org?subject=help>
List-Subscribe: <https://lists.librecores.org/listinfo/openrisc>,
 <mailto:openrisc-request@lists.librecores.org?subject=subscribe>
Cc: Openrisc <openrisc@lists.librecores.org>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: openrisc-bounces@lists.librecores.org
Sender: "OpenRISC" <openrisc-bounces@lists.librecores.org>

VGhpcyBwYXRjaCBhZGRzIGdkYnNlcnZlciBzdXBwb3J0IGZvciBPcGVuUklTQy4gIFRoaXMgaGFz
IGJlZW4gdXNlZCBmb3IKZGVidWdnaW5nIHRoZSBnbGliYyBwb3J0IHRoYXQgaW4gYmVpbmcgd29y
a2VkIG9uIGhlcmU6CgogIGh0dHBzOi8vZ2l0aHViLmNvbS9vcGVucmlzYy9vcjFrLWdsaWJjL3Ry
ZWUvb3Ixay1wb3J0LTIKCkhlbmNlIHRoZSBjb21tZW50IGFib3V0IHJlZ2lzdGVycyBkZWZpbml0
aW9ucyBiZWluZyBpbmxpbmUgd2l0aCBnbGliYy4KLS0tCiBnZGIvZmVhdHVyZXMvTWFrZWZpbGUg
ICAgICAgICB8ICAgMSArCiBnZGIvZmVhdHVyZXMvb3Ixay1saW51eC54bWwgICB8ICAxMyArKwog
Z2RiL3JlZ2Zvcm1hdHMvb3Ixay1saW51eC5kYXQgfCAgNDAgKysrKysKIGdkYnNlcnZlci9NYWtl
ZmlsZS5pbiAgICAgICAgIHwgICAxICsKIGdkYnNlcnZlci9jb25maWd1cmUuc3J2ICAgICAgIHwg
ICA4ICsKIGdkYnNlcnZlci9saW51eC1vcjFrLWxvdy5jYyAgIHwgMjY2ICsrKysrKysrKysrKysr
KysrKysrKysrKysrKysrKysrKysKIDYgZmlsZXMgY2hhbmdlZCwgMzI5IGluc2VydGlvbnMoKykK
IGNyZWF0ZSBtb2RlIDEwMDY0NCBnZGIvZmVhdHVyZXMvb3Ixay1saW51eC54bWwKIGNyZWF0ZSBt
b2RlIDEwMDY0NCBnZGIvcmVnZm9ybWF0cy9vcjFrLWxpbnV4LmRhdAogY3JlYXRlIG1vZGUgMTAw
NjQ0IGdkYnNlcnZlci9saW51eC1vcjFrLWxvdy5jYwoKZGlmZiAtLWdpdCBhL2dkYi9mZWF0dXJl
cy9NYWtlZmlsZSBiL2dkYi9mZWF0dXJlcy9NYWtlZmlsZQppbmRleCBhYTM4ZDE3NjUzOS4uZDQ2
N2ZlNzE0NWYgMTAwNjQ0Ci0tLSBhL2dkYi9mZWF0dXJlcy9NYWtlZmlsZQorKysgYi9nZGIvZmVh
dHVyZXMvTWFrZWZpbGUKQEAgLTQ3LDYgKzQ3LDcgQEAKIFdISUNIID0gbWlwcy1saW51eCBtaXBz
LWRzcC1saW51eCBcCiAJbWlwczY0LWxpbnV4IG1pcHM2NC1kc3AtbGludXggXAogCW5pb3MyLWxp
bnV4IFwKKwlvcjFrLWxpbnV4IFwKIAlyczYwMDAvcG93ZXJwYy0zMiBcCiAJcnM2MDAwL3Bvd2Vy
cGMtMzJsIHJzNjAwMC9wb3dlcnBjLWFsdGl2ZWMzMmwgcnM2MDAwL3Bvd2VycGMtZTUwMGwgXAog
CXJzNjAwMC9wb3dlcnBjLTY0bCByczYwMDAvcG93ZXJwYy1hbHRpdmVjNjRsIHJzNjAwMC9wb3dl
cnBjLXZzeDMybCBcCmRpZmYgLS1naXQgYS9nZGIvZmVhdHVyZXMvb3Ixay1saW51eC54bWwgYi9n
ZGIvZmVhdHVyZXMvb3Ixay1saW51eC54bWwKbmV3IGZpbGUgbW9kZSAxMDA2NDQKaW5kZXggMDAw
MDAwMDAwMDAuLjU5ODUzOGQxMjRmCi0tLSAvZGV2L251bGwKKysrIGIvZ2RiL2ZlYXR1cmVzL29y
MWstbGludXgueG1sCkBAIC0wLDAgKzEsMTMgQEAKKzw/eG1sIHZlcnNpb249IjEuMCI/PgorPCEt
LSBDb3B5cmlnaHQgKEMpIDIwMjEgRnJlZSBTb2Z0d2FyZSBGb3VuZGF0aW9uLCBJbmMuCisKKyAg
ICAgQ29weWluZyBhbmQgZGlzdHJpYnV0aW9uIG9mIHRoaXMgZmlsZSwgd2l0aCBvciB3aXRob3V0
IG1vZGlmaWNhdGlvbiwKKyAgICAgYXJlIHBlcm1pdHRlZCBpbiBhbnkgbWVkaXVtIHdpdGhvdXQg
cm95YWx0eSBwcm92aWRlZCB0aGUgY29weXJpZ2h0CisgICAgIG5vdGljZSBhbmQgdGhpcyBub3Rp
Y2UgYXJlIHByZXNlcnZlZC4gIC0tPgorCis8IURPQ1RZUEUgdGFyZ2V0IFNZU1RFTSAiZ2RiLXRh
cmdldC5kdGQiPgorPHRhcmdldD4KKyAgPGFyY2hpdGVjdHVyZT5vcjFrPC9hcmNoaXRlY3R1cmU+
CisgIDxvc2FiaT5HTlUvTGludXg8L29zYWJpPgorICA8eGk6aW5jbHVkZSBocmVmPSJvcjFrLWNv
cmUueG1sIi8+Cis8L3RhcmdldD4KZGlmZiAtLWdpdCBhL2dkYi9yZWdmb3JtYXRzL29yMWstbGlu
dXguZGF0IGIvZ2RiL3JlZ2Zvcm1hdHMvb3Ixay1saW51eC5kYXQKbmV3IGZpbGUgbW9kZSAxMDA2
NDQKaW5kZXggMDAwMDAwMDAwMDAuLjdiNjQ2NDZmYzY1Ci0tLSAvZGV2L251bGwKKysrIGIvZ2Ri
L3JlZ2Zvcm1hdHMvb3Ixay1saW51eC5kYXQKQEAgLTAsMCArMSw0MCBAQAorIyBUSElTIEZJTEUg
SVMgR0VORVJBVEVELiAgLSotIGJ1ZmZlci1yZWFkLW9ubHk6IHQgLSotIHZpIDpzZXQgcm86Cisj
IEdlbmVyYXRlZCBmcm9tOiBvcjFrLWxpbnV4LnhtbAorbmFtZTpvcjFrX2xpbnV4Cit4bWx0YXJn
ZXQ6b3Ixay1saW51eC54bWwKK2V4cGVkaXRlOnIxLG5wYworMzI6cjAKKzMyOnIxCiszMjpyMgor
MzI6cjMKKzMyOnI0CiszMjpyNQorMzI6cjYKKzMyOnI3CiszMjpyOAorMzI6cjkKKzMyOnIxMAor
MzI6cjExCiszMjpyMTIKKzMyOnIxMworMzI6cjE0CiszMjpyMTUKKzMyOnIxNgorMzI6cjE3Cisz
MjpyMTgKKzMyOnIxOQorMzI6cjIwCiszMjpyMjEKKzMyOnIyMgorMzI6cjIzCiszMjpyMjQKKzMy
OnIyNQorMzI6cjI2CiszMjpyMjcKKzMyOnIyOAorMzI6cjI5CiszMjpyMzAKKzMyOnIzMQorMzI6
cHBjCiszMjpucGMKKzMyOnNyCmRpZmYgLS1naXQgYS9nZGJzZXJ2ZXIvTWFrZWZpbGUuaW4gYi9n
ZGJzZXJ2ZXIvTWFrZWZpbGUuaW4KaW5kZXggMTJlOWIyNzc3YWUuLmQ1MjRhN2U4Nzc1IDEwMDY0
NAotLS0gYS9nZGJzZXJ2ZXIvTWFrZWZpbGUuaW4KKysrIGIvZ2Ric2VydmVyL01ha2VmaWxlLmlu
CkBAIC0xOTYsNiArMTk2LDcgQEAgU0ZJTEVTID0gXAogCSQoc3JjZGlyKS9saW51eC1tNjhrLWxv
dy5jYyBcCiAJJChzcmNkaXIpL2xpbnV4LW1pcHMtbG93LmNjIFwKIAkkKHNyY2RpcikvbGludXgt
bmlvczItbG93LmNjIFwKKwkkKHNyY2RpcikvbGludXgtb3Ixay1sb3cuY2MgXAogCSQoc3JjZGly
KS9saW51eC1wcGMtbG93LmNjIFwKIAkkKHNyY2RpcikvbGludXgtcmlzY3YtbG93LmNjIFwKIAkk
KHNyY2RpcikvbGludXgtczM5MC1sb3cuY2MgXApkaWZmIC0tZ2l0IGEvZ2Ric2VydmVyL2NvbmZp
Z3VyZS5zcnYgYi9nZGJzZXJ2ZXIvY29uZmlndXJlLnNydgppbmRleCA5NzFmNTM3YmZmYS4uNmUw
OWIwZWViNzkgMTAwNjQ0Ci0tLSBhL2dkYnNlcnZlci9jb25maWd1cmUuc3J2CisrKyBiL2dkYnNl
cnZlci9jb25maWd1cmUuc3J2CkBAIC0xNzUsNiArMTc1LDE0IEBAIGNhc2UgIiR7Z2Ric2VydmVy
X2hvc3R9IiBpbgogCQkJc3J2X2xpbnV4X3VzcnJlZ3M9eWVzCiAJCQlzcnZfbGludXhfdGhyZWFk
X2RiPXllcwogCQkJOzsKKyAgb3IxayotKi1saW51eCopCXNydl9yZWdvYmo9Im9yMWstbGludXgu
byIKKwkJCXNydl90Z3RvYmo9IiRzcnZfbGludXhfb2JqIGxpbnV4LW9yMWstbG93Lm8iCisJCQlz
cnZfeG1sZmlsZXM9Im9yMWstbGludXgueG1sIgorCQkJc3J2X3htbGZpbGVzPSIke3Nydl94bWxm
aWxlc30gb3Ixay1jb3JlLnhtbCIKKwkJCXNydl9saW51eF9yZWdzZXRzPXllcworCQkJc3J2X2xp
bnV4X3VzcnJlZ3M9eWVzCisJCQlzcnZfbGludXhfdGhyZWFkX2RiPXllcworCQkJOzsKICAgcG93
ZXJwYyotKi1saW51eCopCXNydl9yZWdvYmo9InBvd2VycGMtMzJsLm8iCiAJCQlzcnZfcmVnb2Jq
PSIke3Nydl9yZWdvYmp9IHBvd2VycGMtYWx0aXZlYzMybC5vIgogCQkJc3J2X3JlZ29iaj0iJHtz
cnZfcmVnb2JqfSBwb3dlcnBjLXZzeDMybC5vIgpkaWZmIC0tZ2l0IGEvZ2Ric2VydmVyL2xpbnV4
LW9yMWstbG93LmNjIGIvZ2Ric2VydmVyL2xpbnV4LW9yMWstbG93LmNjCm5ldyBmaWxlIG1vZGUg
MTAwNjQ0CmluZGV4IDAwMDAwMDAwMDAwLi5kM2NhMTM5MWM3OQotLS0gL2Rldi9udWxsCisrKyBi
L2dkYnNlcnZlci9saW51eC1vcjFrLWxvdy5jYwpAQCAtMCwwICsxLDI2NiBAQAorLyogR05VL0xp
bnV4L09SMUsgc3BlY2lmaWMgbG93IGxldmVsIGludGVyZmFjZSBmb3IgdGhlIEdEQiBzZXJ2ZXIu
CisgICBDb3B5cmlnaHQgKEMpIDIwMjEgRnJlZSBTb2Z0d2FyZSBGb3VuZGF0aW9uLCBJbmMuCisK
KyAgIFRoaXMgZmlsZSBpcyBwYXJ0IG9mIEdEQi4KKworICAgVGhpcyBwcm9ncmFtIGlzIGZyZWUg
c29mdHdhcmU7IHlvdSBjYW4gcmVkaXN0cmlidXRlIGl0IGFuZC9vciBtb2RpZnkKKyAgIGl0IHVu
ZGVyIHRoZSB0ZXJtcyBvZiB0aGUgR05VIEdlbmVyYWwgUHVibGljIExpY2Vuc2UgYXMgcHVibGlz
aGVkIGJ5CisgICB0aGUgRnJlZSBTb2Z0d2FyZSBGb3VuZGF0aW9uOyBlaXRoZXIgdmVyc2lvbiAz
IG9mIHRoZSBMaWNlbnNlLCBvcgorICAgKGF0IHlvdXIgb3B0aW9uKSBhbnkgbGF0ZXIgdmVyc2lv
bi4KKworICAgVGhpcyBwcm9ncmFtIGlzIGRpc3RyaWJ1dGVkIGluIHRoZSBob3BlIHRoYXQgaXQg
d2lsbCBiZSB1c2VmdWwsCisgICBidXQgV0lUSE9VVCBBTlkgV0FSUkFOVFk7IHdpdGhvdXQgZXZl
biB0aGUgaW1wbGllZCB3YXJyYW50eSBvZgorICAgTUVSQ0hBTlRBQklMSVRZIG9yIEZJVE5FU1Mg
Rk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFLiAgU2VlIHRoZQorICAgR05VIEdlbmVyYWwgUHVibGlj
IExpY2Vuc2UgZm9yIG1vcmUgZGV0YWlscy4KKworICAgWW91IHNob3VsZCBoYXZlIHJlY2VpdmVk
IGEgY29weSBvZiB0aGUgR05VIEdlbmVyYWwgUHVibGljIExpY2Vuc2UKKyAgIGFsb25nIHdpdGgg
dGhpcyBwcm9ncmFtLiAgSWYgbm90LCBzZWUgPGh0dHA6Ly93d3cuZ251Lm9yZy9saWNlbnNlcy8+
LiAgKi8KKworI2luY2x1ZGUgInNlcnZlci5oIgorI2luY2x1ZGUgImxpbnV4LWxvdy5oIgorI2lu
Y2x1ZGUgImVsZi9jb21tb24uaCIKKyNpbmNsdWRlICJuYXQvZ2RiX3B0cmFjZS5oIgorI2luY2x1
ZGUgPGVuZGlhbi5oPgorI2luY2x1ZGUgImdkYl9wcm9jX3NlcnZpY2UuaCIKKyNpbmNsdWRlIDxh
c20vcHRyYWNlLmg+CisKKyNpZm5kZWYgUFRSQUNFX0dFVF9USFJFQURfQVJFQQorI2RlZmluZSBQ
VFJBQ0VfR0VUX1RIUkVBRF9BUkVBIDI1CisjZW5kaWYKKworLyogTGludXggdGFyZ2V0IG9wIGRl
ZmluaXRpb25zIGZvciB0aGUgT3BlblJJU0MgYXJjaGl0ZWN0dXJlLiAgKi8KKworY2xhc3Mgb3Ix
a190YXJnZXQgOiBwdWJsaWMgbGludXhfcHJvY2Vzc190YXJnZXQKK3sKK3B1YmxpYzoKKworICBj
b25zdCByZWdzX2luZm8gKmdldF9yZWdzX2luZm8gKCkgb3ZlcnJpZGU7CisKKyAgY29uc3QgZ2Ri
X2J5dGUgKnN3X2JyZWFrcG9pbnRfZnJvbV9raW5kIChpbnQga2luZCwgaW50ICpzaXplKSBvdmVy
cmlkZTsKKworcHJvdGVjdGVkOgorCisgIHZvaWQgbG93X2FyY2hfc2V0dXAgKCkgb3ZlcnJpZGU7
CisKKyAgYm9vbCBsb3dfY2Fubm90X2ZldGNoX3JlZ2lzdGVyIChpbnQgcmVnbm8pIG92ZXJyaWRl
OworCisgIGJvb2wgbG93X2Nhbm5vdF9zdG9yZV9yZWdpc3RlciAoaW50IHJlZ25vKSBvdmVycmlk
ZTsKKworICBib29sIGxvd19zdXBwb3J0c19icmVha3BvaW50cyAoKSBvdmVycmlkZTsKKworICBD
T1JFX0FERFIgbG93X2dldF9wYyAocmVnY2FjaGUgKnJlZ2NhY2hlKSBvdmVycmlkZTsKKworICB2
b2lkIGxvd19zZXRfcGMgKHJlZ2NhY2hlICpyZWdjYWNoZSwgQ09SRV9BRERSIG5ld3BjKSBvdmVy
cmlkZTsKKworICBib29sIGxvd19icmVha3BvaW50X2F0IChDT1JFX0FERFIgcGMpIG92ZXJyaWRl
OworfTsKKworLyogVGhlIHNpbmdsZXRvbiB0YXJnZXQgb3BzIG9iamVjdC4gICovCisKK3N0YXRp
YyBvcjFrX3RhcmdldCB0aGVfb3Ixa190YXJnZXQ7CisKK2Jvb2wKK29yMWtfdGFyZ2V0Ojpsb3df
c3VwcG9ydHNfYnJlYWtwb2ludHMgKCkKK3sKKyAgcmV0dXJuIHRydWU7Cit9CisKK0NPUkVfQURE
Ugorb3Ixa190YXJnZXQ6Omxvd19nZXRfcGMgKHJlZ2NhY2hlICpyZWdjYWNoZSkKK3sKKyAgcmV0
dXJuIGxpbnV4X2dldF9wY18zMmJpdCAocmVnY2FjaGUpOworfQorCit2b2lkCitvcjFrX3Rhcmdl
dDo6bG93X3NldF9wYyAocmVnY2FjaGUgKnJlZ2NhY2hlLCBDT1JFX0FERFIgcGMpCit7CisgIGxp
bnV4X3NldF9wY18zMmJpdCAocmVnY2FjaGUsIHBjKTsKK30KKworLyogVGhlIGZvbGxvd2luZyBk
ZWZpbml0aW9uIG11c3QgYWdyZWUgd2l0aCB0aGUgbnVtYmVyIG9mIHJlZ2lzdGVycworICAgZGVm
aW5lZCBpbiAic3RydWN0IHVzZXJfcmVncyIgaW4gR0xJQkMKKyAgIChzeXNkZXBzL3VuaXgvc3lz
di9saW51eC9vcjFrL3N5cy91Y29udGV4dC5oKSwgYW5kIGFsc28gd2l0aAorICAgT1IxS19OVU1f
UkVHUyBpbiBHREIgcHJvcGVyLiAgKi8KKworI2RlZmluZSBvcjFrX251bV9yZWdzIDM1CisKKy8q
IERlZmluZWQgaW4gYXV0by1nZW5lcmF0ZWQgZmlsZSBvcjFrLWxpbnV4LmMuICAqLworCit2b2lk
IGluaXRfcmVnaXN0ZXJzX29yMWtfbGludXggKHZvaWQpOworZXh0ZXJuIGNvbnN0IHN0cnVjdCB0
YXJnZXRfZGVzYyAqdGRlc2Nfb3Ixa19saW51eDsKKworLyogVGhpcyB1bmlvbiBpcyB1c2VkIHRv
IGNvbnZlcnQgYmV0d2VlbiBpbnQgYW5kIGJ5dGUgYnVmZmVyCisgICByZXByZXNlbnRhdGlvbnMg
b2YgcmVnaXN0ZXIgY29udGVudHMuICAqLworCit1bmlvbiBvcjFrX3JlZ2lzdGVyCit7CisgIHVu
c2lnbmVkIGNoYXIgYnVmWzRdOworICBpbnQgcmVnMzI7Cit9OworCisvKiBSZXR1cm4gdGhlIHB0
cmFjZSBgYGFkZHJlc3MnJyBvZiByZWdpc3RlciBSRUdOTy4gKi8KKworc3RhdGljIGludCBvcjFr
X3JlZ21hcFtdID0geworICAtMSwgIDEsICAyLCAgMywgIDQsICA1LCAgNiwgIDcsCisgIDgsICA5
LCAgMTAsIDExLCAxMiwgMTMsIDE0LCAxNSwKKyAgMTYsIDE3LCAxOCwgMTksIDIwLCAyMSwgMjIs
IDIzLAorICAyNCwgMjUsIDI2LCAyNywgMjgsIDI5LCAzMCwgMzEsCisgIC0xLCAvKiBQQyAqLwor
ICAtMSwgLyogT1JJR0lOQUwgUjExICovCisgIC0xICAvKiBTWVNDQUxMIE5PICovCit9OworCisv
KiBJbXBsZW1lbnQgdGhlIGxvd19hcmNoX3NldHVwIGxpbnV4IHRhcmdldCBvcHMgbWV0aG9kLiAg
Ki8KKwordm9pZAorb3Ixa190YXJnZXQ6Omxvd19hcmNoX3NldHVwICgpCit7CisgIGN1cnJlbnRf
cHJvY2VzcyAoKS0+dGRlc2MgPSB0ZGVzY19vcjFrX2xpbnV4OworfQorCisvKiBJbXBsZW1lbnQg
dGhlIGxvd19jYW5ub3RfZmV0Y2hfcmVnaXN0ZXIgbGludXggdGFyZ2V0IG9wcyBtZXRob2QuICAq
LworCitib29sCitvcjFrX3RhcmdldDo6bG93X2Nhbm5vdF9mZXRjaF9yZWdpc3RlciAoaW50IHJl
Z25vKQoreworICByZXR1cm4gKG9yMWtfcmVnbWFwW3JlZ25vXSA9PSAtMSk7Cit9CisKKy8qIElt
cGxlbWVudCB0aGUgbG93X2Nhbm5vdF9zdG9yZV9yZWdpc3RlciBsaW51eCB0YXJnZXQgb3BzIG1l
dGhvZC4gICovCisKK2Jvb2wKK29yMWtfdGFyZ2V0Ojpsb3dfY2Fubm90X3N0b3JlX3JlZ2lzdGVy
IChpbnQgcmVnbm8pCit7CisgIHJldHVybiAob3Ixa19yZWdtYXBbcmVnbm9dID09IC0xKTsKK30K
KworLyogQnJlYWtwb2ludCBzdXBwb3J0LiAgKi8KKworc3RhdGljIGNvbnN0IHVuc2lnbmVkIGlu
dCBvcjFrX2JyZWFrcG9pbnQgPSAweDIxMDAwMDAxOworI2RlZmluZSBvcjFrX2JyZWFrcG9pbnRf
bGVuIDQKKworLyogSW1wbGVtZW50YXRpb24gb2YgdGFyZ2V0IG9wcyBtZXRob2QgInN3X2JyZWFr
cG9pbnRfZnJvbV9raW5kIi4gICovCisKK2NvbnN0IGdkYl9ieXRlICoKK29yMWtfdGFyZ2V0Ojpz
d19icmVha3BvaW50X2Zyb21fa2luZCAoaW50IGtpbmQsIGludCAqc2l6ZSkKK3sKKyAgKnNpemUg
PSBvcjFrX2JyZWFrcG9pbnRfbGVuOworICByZXR1cm4gKGNvbnN0IGdkYl9ieXRlICopICZvcjFr
X2JyZWFrcG9pbnQ7Cit9CisKKy8qIEltcGxlbWVudCB0aGUgbG93X2JyZWFrcG9pbnRfYXQgbGlu
dXggdGFyZ2V0IG9wcyBtZXRob2QuICAqLworCitib29sCitvcjFrX3RhcmdldDo6bG93X2JyZWFr
cG9pbnRfYXQgKENPUkVfQUREUiB3aGVyZSkKK3sKKyAgdW5zaWduZWQgaW50IGluc247CisKKyAg
cmVhZF9tZW1vcnkgKHdoZXJlLCAodW5zaWduZWQgY2hhciAqKSAmaW5zbiwgNCk7CisgIGlmIChp
bnNuID09IG9yMWtfYnJlYWtwb2ludCkKKyAgICByZXR1cm4gdHJ1ZTsKKyAgcmV0dXJuIGZhbHNl
OworfQorCisvKiBGZXRjaCB0aGUgdGhyZWFkLWxvY2FsIHN0b3JhZ2UgcG9pbnRlciBmb3IgbGli
dGhyZWFkX2RiLiAgKi8KKworcHNfZXJyX2UKK3BzX2dldF90aHJlYWRfYXJlYSAoc3RydWN0IHBz
X3Byb2NoYW5kbGUgKnBoLAorCQkgICAgbHdwaWRfdCBsd3BpZCwgaW50IGlkeCwgdm9pZCAqKmJh
c2UpCit7CisgIGlmIChwdHJhY2UgKFBUUkFDRV9HRVRfVEhSRUFEX0FSRUEsIGx3cGlkLCBOVUxM
LCBiYXNlKSAhPSAwKQorICAgIHJldHVybiBQU19FUlI7CisKKyAgLyogSURYIGlzIHRoZSBiaWFz
IGZyb20gdGhlIHRocmVhZCBwb2ludGVyIHRvIHRoZSBiZWdpbm5pbmcgb2YgdGhlCisgICAgIHRo
cmVhZCBkZXNjcmlwdG9yLiAgSXQgaGFzIHRvIGJlIHN1YnRyYWN0ZWQgZHVlIHRvIGltcGxlbWVu
dGF0aW9uCisgICAgIHF1aXJrcyBpbiBsaWJ0aHJlYWRfZGIuICAqLworICAqYmFzZSA9ICh2b2lk
ICopICgoY2hhciAqKSAqYmFzZSAtIGlkeCk7CisKKyAgcmV0dXJuIFBTX09LOworfQorCisvKiBI
ZWxwZXIgZnVuY3Rpb25zIHRvIGNvbGxlY3Qvc3VwcGx5IGEgc2luZ2xlIHJlZ2lzdGVyIFJFR05P
LiAgKi8KKworc3RhdGljIHZvaWQKK29yMWtfY29sbGVjdF9yZWdpc3RlciAoc3RydWN0IHJlZ2Nh
Y2hlICpyZWdjYWNoZSwgaW50IHJlZ25vLAorCQkJdW5pb24gb3Ixa19yZWdpc3RlciAqcmVnKQor
eworICB1bmlvbiBvcjFrX3JlZ2lzdGVyIHRtcF9yZWc7CisKKyAgY29sbGVjdF9yZWdpc3RlciAo
cmVnY2FjaGUsIHJlZ25vLCAmdG1wX3JlZy5yZWczMik7CisgIHJlZy0+cmVnMzIgPSB0bXBfcmVn
LnJlZzMyOworfQorCitzdGF0aWMgdm9pZAorb3Ixa19zdXBwbHlfcmVnaXN0ZXIgKHN0cnVjdCBy
ZWdjYWNoZSAqcmVnY2FjaGUsIGludCByZWdubywKKwkJICAgICAgIGNvbnN0IHVuaW9uIG9yMWtf
cmVnaXN0ZXIgKnJlZykKK3sKKyAgc3VwcGx5X3JlZ2lzdGVyIChyZWdjYWNoZSwgcmVnbm8sIHJl
Zy0+YnVmKTsKK30KKworLyogV2UgaGF2ZSBvbmx5IGEgc2luZ2xlIHJlZ2lzdGVyIHNldCBvbiBP
cGVuUklTQy4gICovCisKK3N0YXRpYyB2b2lkCitvcjFrX2ZpbGxfZ3JlZ3NldCAoc3RydWN0IHJl
Z2NhY2hlICpyZWdjYWNoZSwgdm9pZCAqYnVmKQoreworICB1bmlvbiBvcjFrX3JlZ2lzdGVyICpy
ZWdzZXQgPSAodW5pb24gb3Ixa19yZWdpc3RlciAqKSBidWY7CisgIGludCBpOworCisgIGZvciAo
aSA9IDE7IGkgPCBvcjFrX251bV9yZWdzOyBpKyspCisgICAgb3Ixa19jb2xsZWN0X3JlZ2lzdGVy
IChyZWdjYWNoZSwgaSwgcmVnc2V0ICsgaSk7Cit9CisKK3N0YXRpYyB2b2lkCitvcjFrX3N0b3Jl
X2dyZWdzZXQgKHN0cnVjdCByZWdjYWNoZSAqcmVnY2FjaGUsIGNvbnN0IHZvaWQgKmJ1ZikKK3sK
KyAgY29uc3QgdW5pb24gb3Ixa19yZWdpc3RlciAqcmVnc2V0ID0gKHVuaW9uIG9yMWtfcmVnaXN0
ZXIgKikgYnVmOworICBpbnQgaTsKKworICBmb3IgKGkgPSAwOyBpIDwgb3Ixa19udW1fcmVnczsg
aSsrKQorICAgIG9yMWtfc3VwcGx5X3JlZ2lzdGVyIChyZWdjYWNoZSwgaSwgcmVnc2V0ICsgaSk7
Cit9CisKK3N0YXRpYyBzdHJ1Y3QgcmVnc2V0X2luZm8gb3Ixa19yZWdzZXRzW10gPQoreworICB7
IFBUUkFDRV9HRVRSRUdTRVQsIFBUUkFDRV9TRVRSRUdTRVQsIE5UX1BSU1RBVFVTLAorICAgIG9y
MWtfbnVtX3JlZ3MgKiA0LCBHRU5FUkFMX1JFR1MsCisgICAgb3Ixa19maWxsX2dyZWdzZXQsIG9y
MWtfc3RvcmVfZ3JlZ3NldCB9LAorICBOVUxMX1JFR1NFVAorfTsKKworc3RhdGljIHN0cnVjdCBy
ZWdzZXRzX2luZm8gb3Ixa19yZWdzZXRzX2luZm8gPQorICB7CisgICAgb3Ixa19yZWdzZXRzLCAv
KiByZWdzZXRzICovCisgICAgMCwgLyogbnVtX3JlZ3NldHMgKi8KKyAgICBOVUxMLCAvKiBkaXNh
YmxlZF9yZWdzZXRzICovCisgIH07CisKK3N0YXRpYyBzdHJ1Y3QgdXNycmVnc19pbmZvIG9yMWtf
dXNycmVnc19pbmZvID0KKyAgeworICAgIG9yMWtfbnVtX3JlZ3MsCisgICAgb3Ixa19yZWdtYXAs
CisgIH07CisKK3N0YXRpYyBzdHJ1Y3QgcmVnc19pbmZvIG9yMWtfcmVncyA9CisgIHsKKyAgICBO
VUxMLCAvKiByZWdzZXRfYml0bWFwICovCisgICAgJm9yMWtfdXNycmVnc19pbmZvLAorICAgICZv
cjFrX3JlZ3NldHNfaW5mbworICB9OworCitjb25zdCByZWdzX2luZm8gKgorb3Ixa190YXJnZXQ6
OmdldF9yZWdzX2luZm8gKCkKK3sKKyAgcmV0dXJuICZvcjFrX3JlZ3M7Cit9CisKKy8qIFRoZSBs
aW51eCB0YXJnZXQgb3BzIG9iamVjdC4gICovCisKK2xpbnV4X3Byb2Nlc3NfdGFyZ2V0ICp0aGVf
bGludXhfdGFyZ2V0ID0gJnRoZV9vcjFrX3RhcmdldDsKKwordm9pZAoraW5pdGlhbGl6ZV9sb3df
YXJjaCAodm9pZCkKK3sKKyAgaW5pdF9yZWdpc3RlcnNfb3Ixa19saW51eCAoKTsKKworICBpbml0
aWFsaXplX3JlZ3NldHNfaW5mbyAoJm9yMWtfcmVnc2V0c19pbmZvKTsKK30KLS0gCjIuMzEuMQoK
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18KT3BlblJJU0Mg
bWFpbGluZyBsaXN0Ck9wZW5SSVNDQGxpc3RzLmxpYnJlY29yZXMub3JnCmh0dHBzOi8vbGlzdHMu
bGlicmVjb3Jlcy5vcmcvbGlzdGluZm8vb3BlbnJpc2MK
